<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Asciidoctor 2.0.12">
    <meta name="author" content="Hardy Ferentschik, Gunnar Morling, Guillaume Smet, YuYang(中文译)">
    <title>Hibernate Validator 7.0.1 - Jakarta Bean Validation 参考实现: 参考指南</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
    <style>
        /* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
        /* Uncomment @import statement to use as custom stylesheet */
        /*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
        
        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        hgroup,
        main,
        nav,
        section {
            display: block
        }
        
        audio,
        video {
            display: inline-block
        }
        
        audio:not([controls]) {
            display: none;
            height: 0
        }
        
        html {
            font-family: sans-serif;
            -ms-text-size-adjust: 100%;
            -webkit-text-size-adjust: 100%
        }
        
        a {
            background: none
        }
        
        a:focus {
            outline: thin dotted
        }
        
        a:active,
        a:hover {
            outline: 0
        }
        
        h1 {
            font-size: 2em;
            margin: .67em 0
        }
        
        abbr[title] {
            border-bottom: 1px dotted
        }
        
        b,
        strong {
            font-weight: bold
        }
        
        dfn {
            font-style: italic
        }
        
        hr {
            -moz-box-sizing: content-box;
            box-sizing: content-box;
            height: 0
        }
        
        mark {
            background: #ff0;
            color: #000
        }
        
        code,
        kbd,
        pre,
        samp {
            font-family: monospace;
            font-size: 1em
        }
        
        pre {
            white-space: pre-wrap
        }
        
        q {
            quotes: "\201C" "\201D" "\2018" "\2019"
        }
        
        small {
            font-size: 80%
        }
        
        sub,
        sup {
            font-size: 75%;
            line-height: 0;
            position: relative;
            vertical-align: baseline
        }
        
        sup {
            top: -.5em
        }
        
        sub {
            bottom: -.25em
        }
        
        img {
            border: 0
        }
        
        svg:not(:root) {
            overflow: hidden
        }
        
        figure {
            margin: 0
        }
        
        fieldset {
            border: 1px solid silver;
            margin: 0 2px;
            padding: .35em .625em .75em
        }
        
        legend {
            border: 0;
            padding: 0
        }
        
        button,
        input,
        select,
        textarea {
            font-family: inherit;
            font-size: 100%;
            margin: 0
        }
        
        button,
        input {
            line-height: normal
        }
        
        button,
        select {
            text-transform: none
        }
        
        button,
        html input[type="button"],
        input[type="reset"],
        input[type="submit"] {
            -webkit-appearance: button;
            cursor: pointer
        }
        
        button[disabled],
        html input[disabled] {
            cursor: default
        }
        
        input[type="checkbox"],
        input[type="radio"] {
            box-sizing: border-box;
            padding: 0
        }
        
        button::-moz-focus-inner,
        input::-moz-focus-inner {
            border: 0;
            padding: 0
        }
        
        textarea {
            overflow: auto;
            vertical-align: top
        }
        
        table {
            border-collapse: collapse;
            border-spacing: 0
        }
        
        *,
        *::before,
        *::after {
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box
        }
        
        html,
        body {
            font-size: 100%
        }
        
        body {
            background: #fff;
            color: rgba(0, 0, 0, .8);
            padding: 0;
            margin: 0;
            font-family: "Noto Serif", "DejaVu Serif", serif;
            font-weight: 400;
            font-style: normal;
            line-height: 1;
            position: relative;
            cursor: auto;
            tab-size: 4;
            word-wrap: anywhere;
            -moz-osx-font-smoothing: grayscale;
            -webkit-font-smoothing: antialiased
        }
        
        a:hover {
            cursor: pointer
        }
        
        img,
        object,
        embed {
            max-width: 100%;
            height: auto
        }
        
        object,
        embed {
            height: 100%
        }
        
        img {
            -ms-interpolation-mode: bicubic
        }
        
        .left {
            float: left!important
        }
        
        .right {
            float: right!important
        }
        
        .text-left {
            text-align: left!important
        }
        
        .text-right {
            text-align: right!important
        }
        
        .text-center {
            text-align: center!important
        }
        
        .text-justify {
            text-align: justify!important
        }
        
        .hide {
            display: none
        }
        
        img,
        object,
        svg {
            display: inline-block;
            vertical-align: middle
        }
        
        textarea {
            height: auto;
            min-height: 50px
        }
        
        select {
            width: 100%
        }
        
        .subheader,
        .admonitionblock td.content>.title,
        .audioblock>.title,
        .exampleblock>.title,
        .imageblock>.title,
        .listingblock>.title,
        .literalblock>.title,
        .stemblock>.title,
        .openblock>.title,
        .paragraph>.title,
        .quoteblock>.title,
        table.tableblock>.title,
        .verseblock>.title,
        .videoblock>.title,
        .dlist>.title,
        .olist>.title,
        .ulist>.title,
        .qlist>.title,
        .hdlist>.title {
            line-height: 1.45;
            color: #7a2518;
            font-weight: 400;
            margin-top: 0;
            margin-bottom: .25em
        }
        
        div,
        dl,
        dt,
        dd,
        ul,
        ol,
        li,
        h1,
        h2,
        h3,
        #toctitle,
        .sidebarblock>.content>.title,
        h4,
        h5,
        h6,
        pre,
        form,
        p,
        blockquote,
        th,
        td {
            margin: 0;
            padding: 0
        }
        
        a {
            color: #2156a5;
            text-decoration: underline;
            line-height: inherit
        }
        
        a:hover,
        a:focus {
            color: #1d4b8f
        }
        
        a img {
            border: 0
        }
        
        p {
            font-family: inherit;
            font-weight: 400;
            font-size: 1em;
            line-height: 1.6;
            margin-bottom: 1.25em;
            text-rendering: optimizeLegibility
        }
        
        p aside {
            font-size: .875em;
            line-height: 1.35;
            font-style: italic
        }
        
        h1,
        h2,
        h3,
        #toctitle,
        .sidebarblock>.content>.title,
        h4,
        h5,
        h6 {
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            font-weight: 300;
            font-style: normal;
            color: #ba3925;
            text-rendering: optimizeLegibility;
            margin-top: 1em;
            margin-bottom: .5em;
            line-height: 1.0125em
        }
        
        h1 small,
        h2 small,
        h3 small,
        #toctitle small,
        .sidebarblock>.content>.title small,
        h4 small,
        h5 small,
        h6 small {
            font-size: 60%;
            color: #e99b8f;
            line-height: 0
        }
        
        h1 {
            font-size: 2.125em
        }
        
        h2 {
            font-size: 1.6875em
        }
        
        h3,
        #toctitle,
        .sidebarblock>.content>.title {
            font-size: 1.375em
        }
        
        h4,
        h5 {
            font-size: 1.125em
        }
        
        h6 {
            font-size: 1em
        }
        
        hr {
            border: solid #dddddf;
            border-width: 1px 0 0;
            clear: both;
            margin: 1.25em 0 1.1875em;
            height: 0
        }
        
        em,
        i {
            font-style: italic;
            line-height: inherit
        }
        
        strong,
        b {
            font-weight: bold;
            line-height: inherit
        }
        
        small {
            font-size: 60%;
            line-height: inherit
        }
        
        code {
            font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
            font-weight: 400;
            color: rgba(0, 0, 0, .9)
        }
        
        ul,
        ol,
        dl {
            font-size: 1em;
            line-height: 1.6;
            margin-bottom: 1.25em;
            list-style-position: outside;
            font-family: inherit
        }
        
        ul,
        ol {
            margin-left: 1.5em
        }
        
        ul li ul,
        ul li ol {
            margin-left: 1.25em;
            margin-bottom: 0;
            font-size: 1em
        }
        
        ul.square li ul,
        ul.circle li ul,
        ul.disc li ul {
            list-style: inherit
        }
        
        ul.square {
            list-style-type: square
        }
        
        ul.circle {
            list-style-type: circle
        }
        
        ul.disc {
            list-style-type: disc
        }
        
        ol li ul,
        ol li ol {
            margin-left: 1.25em;
            margin-bottom: 0
        }
        
        dl dt {
            margin-bottom: .3125em;
            font-weight: bold
        }
        
        dl dd {
            margin-bottom: 1.25em
        }
        
        abbr,
        acronym {
            text-transform: uppercase;
            font-size: 90%;
            color: rgba(0, 0, 0, .8);
            border-bottom: 1px dotted #ddd;
            cursor: help
        }
        
        abbr {
            text-transform: none
        }
        
        blockquote {
            margin: 0 0 1.25em;
            padding: .5625em 1.25em 0 1.1875em;
            border-left: 1px solid #ddd
        }
        
        blockquote cite {
            display: block;
            font-size: .9375em;
            color: rgba(0, 0, 0, .6)
        }
        
        blockquote cite::before {
            content: "\2014 \0020"
        }
        
        blockquote cite a,
        blockquote cite a:visited {
            color: rgba(0, 0, 0, .6)
        }
        
        blockquote,
        blockquote p {
            line-height: 1.6;
            color: rgba(0, 0, 0, .85)
        }
        
        @media screen and (min-width:768px) {
            h1,
            h2,
            h3,
            #toctitle,
            .sidebarblock>.content>.title,
            h4,
            h5,
            h6 {
                line-height: 1.2
            }
            h1 {
                font-size: 2.75em
            }
            h2 {
                font-size: 2.3125em
            }
            h3,
            #toctitle,
            .sidebarblock>.content>.title {
                font-size: 1.6875em
            }
            h4 {
                font-size: 1.4375em
            }
        }
        
        table {
            background: #fff;
            margin-bottom: 1.25em;
            border: solid 1px #dedede;
            word-wrap: normal
        }
        
        table thead,
        table tfoot {
            background: #f7f8f7
        }
        
        table thead tr th,
        table thead tr td,
        table tfoot tr th,
        table tfoot tr td {
            padding: .5em .625em .625em;
            font-size: inherit;
            color: rgba(0, 0, 0, .8);
            text-align: left
        }
        
        table tr th,
        table tr td {
            padding: .5625em .625em;
            font-size: inherit;
            color: rgba(0, 0, 0, .8)
        }
        
        table tr.even,
        table tr.alt {
            background: #f8f8f7
        }
        
        table thead tr th,
        table tfoot tr th,
        table tbody tr td,
        table tr td,
        table tfoot tr td {
            line-height: 1.6
        }
        
        h1,
        h2,
        h3,
        #toctitle,
        .sidebarblock>.content>.title,
        h4,
        h5,
        h6 {
            line-height: 1.2;
            word-spacing: -.05em
        }
        
        h1 strong,
        h2 strong,
        h3 strong,
        #toctitle strong,
        .sidebarblock>.content>.title strong,
        h4 strong,
        h5 strong,
        h6 strong {
            font-weight: 400
        }
        
        .center {
            margin-left: auto;
            margin-right: auto
        }
        
        .stretch {
            width: 100%
        }
        
        .clearfix::before,
        .clearfix::after,
        .float-group::before,
        .float-group::after {
            content: " ";
            display: table
        }
        
        .clearfix::after,
        .float-group::after {
            clear: both
        }
        
        :not(pre).nobreak {
            word-wrap: normal
        }
        
        :not(pre).nowrap {
            white-space: nowrap
        }
        
        :not(pre).pre-wrap {
            white-space: pre-wrap
        }
        
        :not(pre):not([class^=L])>code {
            font-size: .9375em;
            font-style: normal!important;
            letter-spacing: 0;
            padding: .1em .5ex;
            word-spacing: -.15em;
            background: #f7f7f8;
            -webkit-border-radius: 4px;
            border-radius: 4px;
            line-height: 1.45;
            text-rendering: optimizeSpeed
        }
        
        pre {
            color: rgba(0, 0, 0, .9);
            font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
            line-height: 1.45;
            text-rendering: optimizeSpeed
        }
        
        pre code,
        pre pre {
            color: inherit;
            font-size: inherit;
            line-height: inherit
        }
        
        pre>code {
            display: block
        }
        
        pre.nowrap,
        pre.nowrap pre {
            white-space: pre;
            word-wrap: normal
        }
        
        em em {
            font-style: normal
        }
        
        strong strong {
            font-weight: 400
        }
        
        .keyseq {
            color: rgba(51, 51, 51, .8)
        }
        
        kbd {
            font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
            display: inline-block;
            color: rgba(0, 0, 0, .8);
            font-size: .65em;
            line-height: 1.45;
            background: #f7f7f7;
            border: 1px solid #ccc;
            -webkit-border-radius: 3px;
            border-radius: 3px;
            -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, .2), 0 0 0 .1em white inset;
            box-shadow: 0 1px 0 rgba(0, 0, 0, .2), 0 0 0 .1em #fff inset;
            margin: 0 .15em;
            padding: .2em .5em;
            vertical-align: middle;
            position: relative;
            top: -.1em;
            white-space: nowrap
        }
        
        .keyseq kbd:first-child {
            margin-left: 0
        }
        
        .keyseq kbd:last-child {
            margin-right: 0
        }
        
        .menuseq,
        .menuref {
            color: #000
        }
        
        .menuseq b:not(.caret),
        .menuref {
            font-weight: inherit
        }
        
        .menuseq {
            word-spacing: -.02em
        }
        
        .menuseq b.caret {
            font-size: 1.25em;
            line-height: .8
        }
        
        .menuseq i.caret {
            font-weight: bold;
            text-align: center;
            width: .45em
        }
        
        b.button::before,
        b.button::after {
            position: relative;
            top: -1px;
            font-weight: 400
        }
        
        b.button::before {
            content: "[";
            padding: 0 3px 0 2px
        }
        
        b.button::after {
            content: "]";
            padding: 0 2px 0 3px
        }
        
        p a>code:hover {
            color: rgba(0, 0, 0, .9)
        }
        
        #header,
        #content,
        #footnotes,
        #footer {
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            margin-top: 0;
            margin-bottom: 0;
            max-width: 62.5em;
            *zoom: 1;
            position: relative;
            padding-left: .9375em;
            padding-right: .9375em
        }
        
        #header::before,
        #header::after,
        #content::before,
        #content::after,
        #footnotes::before,
        #footnotes::after,
        #footer::before,
        #footer::after {
            content: " ";
            display: table
        }
        
        #header::after,
        #content::after,
        #footnotes::after,
        #footer::after {
            clear: both
        }
        
        #content {
            margin-top: 1.25em
        }
        
        #content::before {
            content: none
        }
        
        #header>h1:first-child {
            color: rgba(0, 0, 0, .85);
            margin-top: 2.25rem;
            margin-bottom: 0
        }
        
        #header>h1:first-child+#toc {
            margin-top: 8px;
            border-top: 1px solid #dddddf
        }
        
        #header>h1:only-child,
        body.toc2 #header>h1:nth-last-child(2) {
            border-bottom: 1px solid #dddddf;
            padding-bottom: 8px
        }
        
        #header .details {
            border-bottom: 1px solid #dddddf;
            line-height: 1.45;
            padding-top: .25em;
            padding-bottom: .25em;
            padding-left: .25em;
            color: rgba(0, 0, 0, .6);
            display: -ms-flexbox;
            display: -webkit-flex;
            display: flex;
            -ms-flex-flow: row wrap;
            -webkit-flex-flow: row wrap;
            flex-flow: row wrap
        }
        
        #header .details span:first-child {
            margin-left: -.125em
        }
        
        #header .details span.email a {
            color: rgba(0, 0, 0, .85)
        }
        
        #header .details br {
            display: none
        }
        
        #header .details br+span::before {
            content: "\00a0\2013\00a0"
        }
        
        #header .details br+span.author::before {
            content: "\00a0\22c5\00a0";
            color: rgba(0, 0, 0, .85)
        }
        
        #header .details br+span#revremark::before {
            content: "\00a0|\00a0"
        }
        
        #header #revnumber {
            text-transform: capitalize
        }
        
        #header #revnumber::after {
            content: "\00a0"
        }
        
        #content>h1:first-child:not([class]) {
            color: rgba(0, 0, 0, .85);
            border-bottom: 1px solid #dddddf;
            padding-bottom: 8px;
            margin-top: 0;
            padding-top: 1rem;
            margin-bottom: 1.25rem
        }
        
        #toc {
            border-bottom: 1px solid #e7e7e9;
            padding-bottom: .5em
        }
        
        #toc>ul {
            margin-left: .125em
        }
        
        #toc ul.sectlevel0>li>a {
            font-style: italic
        }
        
        #toc ul.sectlevel0 ul.sectlevel1 {
            margin: .5em 0
        }
        
        #toc ul {
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            list-style-type: none
        }
        
        #toc li {
            line-height: 1.3334;
            margin-top: .3334em
        }
        
        #toc a {
            text-decoration: none
        }
        
        #toc a:active {
            text-decoration: underline
        }
        
        #toctitle {
            color: #7a2518;
            font-size: 1.2em
        }
        
        @media screen and (min-width:768px) {
            #toctitle {
                font-size: 1.375em
            }
            body.toc2 {
                padding-left: 15em;
                padding-right: 0
            }
            #toc.toc2 {
                margin-top: 0!important;
                background: #f8f8f7;
                position: fixed;
                width: 15em;
                left: 0;
                top: 0;
                border-right: 1px solid #e7e7e9;
                border-top-width: 0!important;
                border-bottom-width: 0!important;
                z-index: 1000;
                padding: 1.25em 1em;
                height: 100%;
                overflow: auto
            }
            #toc.toc2 #toctitle {
                margin-top: 0;
                margin-bottom: .8rem;
                font-size: 1.2em
            }
            #toc.toc2>ul {
                font-size: .9em;
                margin-bottom: 0
            }
            #toc.toc2 ul ul {
                margin-left: 0;
                padding-left: 1em
            }
            #toc.toc2 ul.sectlevel0 ul.sectlevel1 {
                padding-left: 0;
                margin-top: .5em;
                margin-bottom: .5em
            }
            body.toc2.toc-right {
                padding-left: 0;
                padding-right: 15em
            }
            body.toc2.toc-right #toc.toc2 {
                border-right-width: 0;
                border-left: 1px solid #e7e7e9;
                left: auto;
                right: 0
            }
        }
        
        @media screen and (min-width:1280px) {
            body.toc2 {
                padding-left: 20em;
                padding-right: 0
            }
            #toc.toc2 {
                width: 20em
            }
            #toc.toc2 #toctitle {
                font-size: 1.375em
            }
            #toc.toc2>ul {
                font-size: .95em
            }
            #toc.toc2 ul ul {
                padding-left: 1.25em
            }
            body.toc2.toc-right {
                padding-left: 0;
                padding-right: 20em
            }
        }
        
        #content #toc {
            border-style: solid;
            border-width: 1px;
            border-color: #e0e0dc;
            margin-bottom: 1.25em;
            padding: 1.25em;
            background: #f8f8f7;
            -webkit-border-radius: 4px;
            border-radius: 4px
        }
        
        #content #toc>:first-child {
            margin-top: 0
        }
        
        #content #toc>:last-child {
            margin-bottom: 0
        }
        
        #footer {
            max-width: none;
            background: rgba(0, 0, 0, .8);
            padding: 1.25em
        }
        
        #footer-text {
            color: rgba(255, 255, 255, .8);
            line-height: 1.44
        }
        
        #content {
            margin-bottom: .625em
        }
        
        .sect1 {
            padding-bottom: .625em
        }
        
        @media screen and (min-width:768px) {
            #content {
                margin-bottom: 1.25em
            }
            .sect1 {
                padding-bottom: 1.25em
            }
        }
        
        .sect1:last-child {
            padding-bottom: 0
        }
        
        .sect1+.sect1 {
            border-top: 1px solid #e7e7e9
        }
        
        #content h1>a.anchor,
        h2>a.anchor,
        h3>a.anchor,
        #toctitle>a.anchor,
        .sidebarblock>.content>.title>a.anchor,
        h4>a.anchor,
        h5>a.anchor,
        h6>a.anchor {
            position: absolute;
            z-index: 1001;
            width: 1.5ex;
            margin-left: -1.5ex;
            display: block;
            text-decoration: none!important;
            visibility: hidden;
            text-align: center;
            font-weight: 400
        }
        
        #content h1>a.anchor::before,
        h2>a.anchor::before,
        h3>a.anchor::before,
        #toctitle>a.anchor::before,
        .sidebarblock>.content>.title>a.anchor::before,
        h4>a.anchor::before,
        h5>a.anchor::before,
        h6>a.anchor::before {
            content: "\00A7";
            font-size: .85em;
            display: block;
            padding-top: .1em
        }
        
        #content h1:hover>a.anchor,
        #content h1>a.anchor:hover,
        h2:hover>a.anchor,
        h2>a.anchor:hover,
        h3:hover>a.anchor,
        #toctitle:hover>a.anchor,
        .sidebarblock>.content>.title:hover>a.anchor,
        h3>a.anchor:hover,
        #toctitle>a.anchor:hover,
        .sidebarblock>.content>.title>a.anchor:hover,
        h4:hover>a.anchor,
        h4>a.anchor:hover,
        h5:hover>a.anchor,
        h5>a.anchor:hover,
        h6:hover>a.anchor,
        h6>a.anchor:hover {
            visibility: visible
        }
        
        #content h1>a.link,
        h2>a.link,
        h3>a.link,
        #toctitle>a.link,
        .sidebarblock>.content>.title>a.link,
        h4>a.link,
        h5>a.link,
        h6>a.link {
            color: #ba3925;
            text-decoration: none
        }
        
        #content h1>a.link:hover,
        h2>a.link:hover,
        h3>a.link:hover,
        #toctitle>a.link:hover,
        .sidebarblock>.content>.title>a.link:hover,
        h4>a.link:hover,
        h5>a.link:hover,
        h6>a.link:hover {
            color: #a53221
        }
        
        details,
        .audioblock,
        .imageblock,
        .literalblock,
        .listingblock,
        .stemblock,
        .videoblock {
            margin-bottom: 1.25em
        }
        
        details>summary:first-of-type {
            cursor: pointer;
            display: list-item;
            outline: none;
            margin-bottom: .75em
        }
        
        .admonitionblock td.content>.title,
        .audioblock>.title,
        .exampleblock>.title,
        .imageblock>.title,
        .listingblock>.title,
        .literalblock>.title,
        .stemblock>.title,
        .openblock>.title,
        .paragraph>.title,
        .quoteblock>.title,
        table.tableblock>.title,
        .verseblock>.title,
        .videoblock>.title,
        .dlist>.title,
        .olist>.title,
        .ulist>.title,
        .qlist>.title,
        .hdlist>.title {
            text-rendering: optimizeLegibility;
            text-align: left;
            font-family: "Noto Serif", "DejaVu Serif", serif;
            font-size: 1rem;
            font-style: italic
        }
        
        table.tableblock.fit-content>caption.title {
            white-space: nowrap;
            width: 0
        }
        
        .paragraph.lead>p,
        #preamble>.sectionbody>[class="paragraph"]:first-of-type p {
            font-size: 1.21875em;
            line-height: 1.6;
            color: rgba(0, 0, 0, .85)
        }
        
        table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p {
            font-size: inherit
        }
        
        .admonitionblock>table {
            border-collapse: separate;
            border: 0;
            background: none;
            width: 100%
        }
        
        .admonitionblock>table td.icon {
            text-align: center;
            width: 80px
        }
        
        .admonitionblock>table td.icon img {
            max-width: none
        }
        
        .admonitionblock>table td.icon .title {
            font-weight: bold;
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            text-transform: uppercase
        }
        
        .admonitionblock>table td.content {
            padding-left: 1.125em;
            padding-right: 1.25em;
            border-left: 1px solid #dddddf;
            color: rgba(0, 0, 0, .6);
            word-wrap: anywhere
        }
        
        .admonitionblock>table td.content>:last-child>:last-child {
            margin-bottom: 0
        }
        
        .exampleblock>.content {
            border-style: solid;
            border-width: 1px;
            border-color: #e6e6e6;
            margin-bottom: 1.25em;
            padding: 1.25em;
            background: #fff;
            -webkit-border-radius: 4px;
            border-radius: 4px
        }
        
        .exampleblock>.content>:first-child {
            margin-top: 0
        }
        
        .exampleblock>.content>:last-child {
            margin-bottom: 0
        }
        
        .sidebarblock {
            border-style: solid;
            border-width: 1px;
            border-color: #dbdbd6;
            margin-bottom: 1.25em;
            padding: 1.25em;
            background: #f3f3f2;
            -webkit-border-radius: 4px;
            border-radius: 4px
        }
        
        .sidebarblock>:first-child {
            margin-top: 0
        }
        
        .sidebarblock>:last-child {
            margin-bottom: 0
        }
        
        .sidebarblock>.content>.title {
            color: #7a2518;
            margin-top: 0;
            text-align: center
        }
        
        .exampleblock>.content>:last-child>:last-child,
        .exampleblock>.content .olist>ol>li:last-child>:last-child,
        .exampleblock>.content .ulist>ul>li:last-child>:last-child,
        .exampleblock>.content .qlist>ol>li:last-child>:last-child,
        .sidebarblock>.content>:last-child>:last-child,
        .sidebarblock>.content .olist>ol>li:last-child>:last-child,
        .sidebarblock>.content .ulist>ul>li:last-child>:last-child,
        .sidebarblock>.content .qlist>ol>li:last-child>:last-child {
            margin-bottom: 0
        }
        
        .literalblock pre,
        .listingblock>.content>pre {
            -webkit-border-radius: 4px;
            border-radius: 4px;
            overflow-x: auto;
            padding: 1em;
            font-size: .8125em
        }
        
        @media screen and (min-width:768px) {
            .literalblock pre,
            .listingblock>.content>pre {
                font-size: .90625em
            }
        }
        
        @media screen and (min-width:1280px) {
            .literalblock pre,
            .listingblock>.content>pre {
                font-size: 1em
            }
        }
        
        .literalblock pre,
        .listingblock>.content>pre:not(.highlight),
        .listingblock>.content>pre[class="highlight"],
        .listingblock>.content>pre[class^="highlight "] {
            background: #f7f7f8
        }
        
        .literalblock.output pre {
            color: #f7f7f8;
            background: rgba(0, 0, 0, .9)
        }
        
        .listingblock>.content {
            position: relative
        }
        
        .listingblock code[data-lang]::before {
            display: none;
            content: attr(data-lang);
            position: absolute;
            font-size: .75em;
            top: .425rem;
            right: .5rem;
            line-height: 1;
            text-transform: uppercase;
            color: inherit;
            opacity: .5
        }
        
        .listingblock:hover code[data-lang]::before {
            display: block
        }
        
        .listingblock.terminal pre .command::before {
            content: attr(data-prompt);
            padding-right: .5em;
            color: inherit;
            opacity: .5
        }
        
        .listingblock.terminal pre .command:not([data-prompt])::before {
            content: "$"
        }
        
        .listingblock pre.highlightjs {
            padding: 0
        }
        
        .listingblock pre.highlightjs>code {
            padding: 1em;
            -webkit-border-radius: 4px;
            border-radius: 4px
        }
        
        .listingblock pre.prettyprint {
            border-width: 0
        }
        
        .prettyprint {
            background: #f7f7f8
        }
        
        pre.prettyprint .linenums {
            line-height: 1.45;
            margin-left: 2em
        }
        
        pre.prettyprint li {
            background: none;
            list-style-type: inherit;
            padding-left: 0
        }
        
        pre.prettyprint li code[data-lang]::before {
            opacity: 1
        }
        
        pre.prettyprint li:not(:first-child) code[data-lang]::before {
            display: none
        }
        
        table.linenotable {
            border-collapse: separate;
            border: 0;
            margin-bottom: 0;
            background: none
        }
        
        table.linenotable td[class] {
            color: inherit;
            vertical-align: top;
            padding: 0;
            line-height: inherit;
            white-space: normal
        }
        
        table.linenotable td.code {
            padding-left: .75em
        }
        
        table.linenotable td.linenos {
            border-right: 1px solid currentColor;
            opacity: .35;
            padding-right: .5em
        }
        
        pre.pygments .lineno {
            border-right: 1px solid currentColor;
            opacity: .35;
            display: inline-block;
            margin-right: .75em
        }
        
        pre.pygments .lineno::before {
            content: "";
            margin-right: -.125em
        }
        
        .quoteblock {
            margin: 0 1em 1.25em 1.5em;
            display: table
        }
        
        .quoteblock:not(.excerpt)>.title {
            margin-left: -1.5em;
            margin-bottom: .75em
        }
        
        .quoteblock blockquote,
        .quoteblock p {
            color: rgba(0, 0, 0, .85);
            font-size: 1.15rem;
            line-height: 1.75;
            word-spacing: .1em;
            letter-spacing: 0;
            font-style: italic;
            text-align: justify
        }
        
        .quoteblock blockquote {
            margin: 0;
            padding: 0;
            border: 0
        }
        
        .quoteblock blockquote::before {
            content: "\201c";
            float: left;
            font-size: 2.75em;
            font-weight: bold;
            line-height: .6em;
            margin-left: -.6em;
            color: #7a2518;
            text-shadow: 0 1px 2px rgba(0, 0, 0, .1)
        }
        
        .quoteblock blockquote>.paragraph:last-child p {
            margin-bottom: 0
        }
        
        .quoteblock .attribution {
            margin-top: .75em;
            margin-right: .5ex;
            text-align: right
        }
        
        .verseblock {
            margin: 0 1em 1.25em
        }
        
        .verseblock pre {
            font-family: "Open Sans", "DejaVu Sans", sans;
            font-size: 1.15rem;
            color: rgba(0, 0, 0, .85);
            font-weight: 300;
            text-rendering: optimizeLegibility
        }
        
        .verseblock pre strong {
            font-weight: 400
        }
        
        .verseblock .attribution {
            margin-top: 1.25rem;
            margin-left: .5ex
        }
        
        .quoteblock .attribution,
        .verseblock .attribution {
            font-size: .9375em;
            line-height: 1.45;
            font-style: italic
        }
        
        .quoteblock .attribution br,
        .verseblock .attribution br {
            display: none
        }
        
        .quoteblock .attribution cite,
        .verseblock .attribution cite {
            display: block;
            letter-spacing: -.025em;
            color: rgba(0, 0, 0, .6)
        }
        
        .quoteblock.abstract blockquote::before,
        .quoteblock.excerpt blockquote::before,
        .quoteblock .quoteblock blockquote::before {
            display: none
        }
        
        .quoteblock.abstract blockquote,
        .quoteblock.abstract p,
        .quoteblock.excerpt blockquote,
        .quoteblock.excerpt p,
        .quoteblock .quoteblock blockquote,
        .quoteblock .quoteblock p {
            line-height: 1.6;
            word-spacing: 0
        }
        
        .quoteblock.abstract {
            margin: 0 1em 1.25em;
            display: block
        }
        
        .quoteblock.abstract>.title {
            margin: 0 0 .375em;
            font-size: 1.15em;
            text-align: center
        }
        
        .quoteblock.excerpt>blockquote,
        .quoteblock .quoteblock {
            padding: 0 0 .25em 1em;
            border-left: .25em solid #dddddf
        }
        
        .quoteblock.excerpt,
        .quoteblock .quoteblock {
            margin-left: 0
        }
        
        .quoteblock.excerpt blockquote,
        .quoteblock.excerpt p,
        .quoteblock .quoteblock blockquote,
        .quoteblock .quoteblock p {
            color: inherit;
            font-size: 1.0625rem
        }
        
        .quoteblock.excerpt .attribution,
        .quoteblock .quoteblock .attribution {
            color: inherit;
            text-align: left;
            margin-right: 0
        }
        
        p.tableblock:last-child {
            margin-bottom: 0
        }
        
        td.tableblock>.content {
            margin-bottom: 1.25em;
            word-wrap: anywhere
        }
        
        td.tableblock>.content>:last-child {
            margin-bottom: -1.25em
        }
        
        table.tableblock,
        th.tableblock,
        td.tableblock {
            border: 0 solid #dedede
        }
        
        table.grid-all>*>tr>* {
            border-width: 1px
        }
        
        table.grid-cols>*>tr>* {
            border-width: 0 1px
        }
        
        table.grid-rows>*>tr>* {
            border-width: 1px 0
        }
        
        table.frame-all {
            border-width: 1px
        }
        
        table.frame-ends {
            border-width: 1px 0
        }
        
        table.frame-sides {
            border-width: 0 1px
        }
        
        table.frame-none>colgroup+*>:first-child>*,
        table.frame-sides>colgroup+*>:first-child>* {
            border-top-width: 0
        }
        
        table.frame-none>:last-child>:last-child>*,
        table.frame-sides>:last-child>:last-child>* {
            border-bottom-width: 0
        }
        
        table.frame-none>*>tr>:first-child,
        table.frame-ends>*>tr>:first-child {
            border-left-width: 0
        }
        
        table.frame-none>*>tr>:last-child,
        table.frame-ends>*>tr>:last-child {
            border-right-width: 0
        }
        
        table.stripes-all tr,
        table.stripes-odd tr:nth-of-type(odd),
        table.stripes-even tr:nth-of-type(even),
        table.stripes-hover tr:hover {
            background: #f8f8f7
        }
        
        th.halign-left,
        td.halign-left {
            text-align: left
        }
        
        th.halign-right,
        td.halign-right {
            text-align: right
        }
        
        th.halign-center,
        td.halign-center {
            text-align: center
        }
        
        th.valign-top,
        td.valign-top {
            vertical-align: top
        }
        
        th.valign-bottom,
        td.valign-bottom {
            vertical-align: bottom
        }
        
        th.valign-middle,
        td.valign-middle {
            vertical-align: middle
        }
        
        table thead th,
        table tfoot th {
            font-weight: bold
        }
        
        tbody tr th {
            background: #f7f8f7
        }
        
        tbody tr th,
        tbody tr th p,
        tfoot tr th,
        tfoot tr th p {
            color: rgba(0, 0, 0, .8);
            font-weight: bold
        }
        
        p.tableblock>code:only-child {
            background: none;
            padding: 0
        }
        
        p.tableblock {
            font-size: 1em
        }
        
        ol {
            margin-left: 1.75em
        }
        
        ul li ol {
            margin-left: 1.5em
        }
        
        dl dd {
            margin-left: 1.125em
        }
        
        dl dd:last-child,
        dl dd:last-child>:last-child {
            margin-bottom: 0
        }
        
        ol>li p,
        ul>li p,
        ul dd,
        ol dd,
        .olist .olist,
        .ulist .ulist,
        .ulist .olist,
        .olist .ulist {
            margin-bottom: .625em
        }
        
        ul.checklist,
        ul.none,
        ol.none,
        ul.no-bullet,
        ol.no-bullet,
        ol.unnumbered,
        ul.unstyled,
        ol.unstyled {
            list-style-type: none
        }
        
        ul.no-bullet,
        ol.no-bullet,
        ol.unnumbered {
            margin-left: .625em
        }
        
        ul.unstyled,
        ol.unstyled {
            margin-left: 0
        }
        
        ul.checklist {
            margin-left: .625em
        }
        
        ul.checklist li>p:first-child>.fa-square-o:first-child,
        ul.checklist li>p:first-child>.fa-check-square-o:first-child {
            width: 1.25em;
            font-size: .8em;
            position: relative;
            bottom: .125em
        }
        
        ul.checklist li>p:first-child>input[type="checkbox"]:first-child {
            margin-right: .25em
        }
        
        ul.inline {
            display: -ms-flexbox;
            display: -webkit-box;
            display: flex;
            -ms-flex-flow: row wrap;
            -webkit-flex-flow: row wrap;
            flex-flow: row wrap;
            list-style: none;
            margin: 0 0 .625em -1.25em
        }
        
        ul.inline>li {
            margin-left: 1.25em
        }
        
        .unstyled dl dt {
            font-weight: 400;
            font-style: normal
        }
        
        ol.arabic {
            list-style-type: decimal
        }
        
        ol.decimal {
            list-style-type: decimal-leading-zero
        }
        
        ol.loweralpha {
            list-style-type: lower-alpha
        }
        
        ol.upperalpha {
            list-style-type: upper-alpha
        }
        
        ol.lowerroman {
            list-style-type: lower-roman
        }
        
        ol.upperroman {
            list-style-type: upper-roman
        }
        
        ol.lowergreek {
            list-style-type: lower-greek
        }
        
        .hdlist>table,
        .colist>table {
            border: 0;
            background: none
        }
        
        .hdlist>table>tbody>tr,
        .colist>table>tbody>tr {
            background: none
        }
        
        td.hdlist1,
        td.hdlist2 {
            vertical-align: top;
            padding: 0 .625em
        }
        
        td.hdlist1 {
            font-weight: bold;
            padding-bottom: 1.25em
        }
        
        td.hdlist2 {
            word-wrap: anywhere
        }
        
        .literalblock+.colist,
        .listingblock+.colist {
            margin-top: -.5em
        }
        
        .colist td:not([class]):first-child {
            padding: .4em .75em 0;
            line-height: 1;
            vertical-align: top
        }
        
        .colist td:not([class]):first-child img {
            max-width: none
        }
        
        .colist td:not([class]):last-child {
            padding: .25em 0
        }
        
        .thumb,
        .th {
            line-height: 0;
            display: inline-block;
            border: solid 4px #fff;
            -webkit-box-shadow: 0 0 0 1px #ddd;
            box-shadow: 0 0 0 1px #ddd
        }
        
        .imageblock.left {
            margin: .25em .625em 1.25em 0
        }
        
        .imageblock.right {
            margin: .25em 0 1.25em .625em
        }
        
        .imageblock>.title {
            margin-bottom: 0
        }
        
        .imageblock.thumb,
        .imageblock.th {
            border-width: 6px
        }
        
        .imageblock.thumb>.title,
        .imageblock.th>.title {
            padding: 0 .125em
        }
        
        .image.left,
        .image.right {
            margin-top: .25em;
            margin-bottom: .25em;
            display: inline-block;
            line-height: 0
        }
        
        .image.left {
            margin-right: .625em
        }
        
        .image.right {
            margin-left: .625em
        }
        
        a.image {
            text-decoration: none;
            display: inline-block
        }
        
        a.image object {
            pointer-events: none
        }
        
        sup.footnote,
        sup.footnoteref {
            font-size: .875em;
            position: static;
            vertical-align: super
        }
        
        sup.footnote a,
        sup.footnoteref a {
            text-decoration: none
        }
        
        sup.footnote a:active,
        sup.footnoteref a:active {
            text-decoration: underline
        }
        
        #footnotes {
            padding-top: .75em;
            padding-bottom: .75em;
            margin-bottom: .625em
        }
        
        #footnotes hr {
            width: 20%;
            min-width: 6.25em;
            margin: -.25em 0 .75em;
            border-width: 1px 0 0
        }
        
        #footnotes .footnote {
            padding: 0 .375em 0 .225em;
            line-height: 1.3334;
            font-size: .875em;
            margin-left: 1.2em;
            margin-bottom: .2em
        }
        
        #footnotes .footnote a:first-of-type {
            font-weight: bold;
            text-decoration: none;
            margin-left: -1.05em
        }
        
        #footnotes .footnote:last-of-type {
            margin-bottom: 0
        }
        
        #content #footnotes {
            margin-top: -.625em;
            margin-bottom: 0;
            padding: .75em 0
        }
        
        .gist .file-data>table {
            border: 0;
            background: #fff;
            width: 100%;
            margin-bottom: 0
        }
        
        .gist .file-data>table td.line-data {
            width: 99%
        }
        
        div.unbreakable {
            page-break-inside: avoid
        }
        
        .big {
            font-size: larger
        }
        
        .small {
            font-size: smaller
        }
        
        .underline {
            text-decoration: underline
        }
        
        .overline {
            text-decoration: overline
        }
        
        .line-through {
            text-decoration: line-through
        }
        
        .aqua {
            color: #00bfbf
        }
        
        .aqua-background {
            background: #00fafa
        }
        
        .black {
            color: #000
        }
        
        .black-background {
            background: #000
        }
        
        .blue {
            color: #0000bf
        }
        
        .blue-background {
            background: #0000fa
        }
        
        .fuchsia {
            color: #bf00bf
        }
        
        .fuchsia-background {
            background: #fa00fa
        }
        
        .gray {
            color: #606060
        }
        
        .gray-background {
            background: #7d7d7d
        }
        
        .green {
            color: #006000
        }
        
        .green-background {
            background: #007d00
        }
        
        .lime {
            color: #00bf00
        }
        
        .lime-background {
            background: #00fa00
        }
        
        .maroon {
            color: #600000
        }
        
        .maroon-background {
            background: #7d0000
        }
        
        .navy {
            color: #000060
        }
        
        .navy-background {
            background: #00007d
        }
        
        .olive {
            color: #606000
        }
        
        .olive-background {
            background: #7d7d00
        }
        
        .purple {
            color: #600060
        }
        
        .purple-background {
            background: #7d007d
        }
        
        .red {
            color: #bf0000
        }
        
        .red-background {
            background: #fa0000
        }
        
        .silver {
            color: #909090
        }
        
        .silver-background {
            background: #bcbcbc
        }
        
        .teal {
            color: #006060
        }
        
        .teal-background {
            background: #007d7d
        }
        
        .white {
            color: #bfbfbf
        }
        
        .white-background {
            background: #fafafa
        }
        
        .yellow {
            color: #bfbf00
        }
        
        .yellow-background {
            background: #fafa00
        }
        
        span.icon>.fa {
            cursor: default
        }
        
        a span.icon>.fa {
            cursor: inherit
        }
        
        .admonitionblock td.icon [class^="fa icon-"] {
            font-size: 2.5em;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, .5);
            cursor: default
        }
        
        .admonitionblock td.icon .icon-note::before {
            content: "\f05a";
            color: #19407c
        }
        
        .admonitionblock td.icon .icon-tip::before {
            content: "\f0eb";
            text-shadow: 1px 1px 2px rgba(155, 155, 0, .8);
            color: #111
        }
        
        .admonitionblock td.icon .icon-warning::before {
            content: "\f071";
            color: #bf6900
        }
        
        .admonitionblock td.icon .icon-caution::before {
            content: "\f06d";
            color: #bf3400
        }
        
        .admonitionblock td.icon .icon-important::before {
            content: "\f06a";
            color: #bf0000
        }
        
        .conum[data-value] {
            display: inline-block;
            color: #fff!important;
            background: rgba(0, 0, 0, .8);
            -webkit-border-radius: 50%;
            border-radius: 50%;
            text-align: center;
            font-size: .75em;
            width: 1.67em;
            height: 1.67em;
            line-height: 1.67em;
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            font-style: normal;
            font-weight: bold
        }
        
        .conum[data-value] * {
            color: #fff!important
        }
        
        .conum[data-value]+b {
            display: none
        }
        
        .conum[data-value]::after {
            content: attr(data-value)
        }
        
        pre .conum[data-value] {
            position: relative;
            top: -.125em
        }
        
        b.conum * {
            color: inherit!important
        }
        
        .conum:not([data-value]):empty {
            display: none
        }
        
        dt,
        th.tableblock,
        td.content,
        div.footnote {
            text-rendering: optimizeLegibility
        }
        
        h1,
        h2,
        p,
        td.content,
        span.alt {
            letter-spacing: -.01em
        }
        
        p strong,
        td.content strong,
        div.footnote strong {
            letter-spacing: -.005em
        }
        
        p,
        blockquote,
        dt,
        td.content,
        span.alt {
            font-size: 1.0625rem
        }
        
        p {
            margin-bottom: 1.25rem
        }
        
        .sidebarblock p,
        .sidebarblock dt,
        .sidebarblock td.content,
        p.tableblock {
            font-size: 1em
        }
        
        .exampleblock>.content {
            background: #fffef7;
            border-color: #e0e0dc;
            -webkit-box-shadow: 0 1px 4px #e0e0dc;
            box-shadow: 0 1px 4px #e0e0dc
        }
        
        .print-only {
            display: none!important
        }
        
        @page {
            margin: 1.25cm .75cm
        }
        
        @media print {
            * {
                -webkit-box-shadow: none!important;
                box-shadow: none!important;
                text-shadow: none!important
            }
            html {
                font-size: 80%
            }
            a {
                color: inherit!important;
                text-decoration: underline!important
            }
            a.bare,
            a[href^="#"],
            a[href^="mailto:"] {
                text-decoration: none!important
            }
            a[href^="http:"]:not(.bare)::after,
            a[href^="https:"]:not(.bare)::after {
                content: "(" attr(href) ")";
                display: inline-block;
                font-size: .875em;
                padding-left: .25em
            }
            abbr[title]::after {
                content: " (" attr(title) ")"
            }
            pre,
            blockquote,
            tr,
            img,
            object,
            svg {
                page-break-inside: avoid
            }
            thead {
                display: table-header-group
            }
            svg {
                max-width: 100%
            }
            p,
            blockquote,
            dt,
            td.content {
                font-size: 1em;
                orphans: 3;
                widows: 3
            }
            h2,
            h3,
            #toctitle,
            .sidebarblock>.content>.title {
                page-break-after: avoid
            }
            #header,
            #content,
            #footnotes,
            #footer {
                max-width: none
            }
            #toc,
            .sidebarblock,
            .exampleblock>.content {
                background: none!important
            }
            #toc {
                border-bottom: 1px solid #dddddf!important;
                padding-bottom: 0!important
            }
            body.book #header {
                text-align: center
            }
            body.book #header>h1:first-child {
                border: 0!important;
                margin: 2.5em 0 1em
            }
            body.book #header .details {
                border: 0!important;
                display: block;
                padding: 0!important
            }
            body.book #header .details span:first-child {
                margin-left: 0!important
            }
            body.book #header .details br {
                display: block
            }
            body.book #header .details br+span::before {
                content: none!important
            }
            body.book #toc {
                border: 0!important;
                text-align: left!important;
                padding: 0!important;
                margin: 0!important
            }
            body.book #toc,
            body.book #preamble,
            body.book h1.sect0,
            body.book .sect1>h2 {
                page-break-before: always
            }
            .listingblock code[data-lang]::before {
                display: block
            }
            #footer {
                padding: 0 .9375em
            }
            .hide-on-print {
                display: none!important
            }
            .print-only {
                display: block!important
            }
            .hide-for-print {
                display: none!important
            }
            .show-for-print {
                display: inherit!important
            }
        }
        
        @media print,
        amzn-kf8 {
            #header>h1:first-child {
                margin-top: 1.25rem
            }
            .sect1 {
                padding: 0!important
            }
            .sect1+.sect1 {
                border: 0
            }
            #footer {
                background: none
            }
            #footer-text {
                color: rgba(0, 0, 0, .6);
                font-size: .9em
            }
        }
        
        @media amzn-kf8 {
            #header,
            #content,
            #footnotes,
            #footer {
                padding: 0
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/github.min.css">
</head>

<body class="book toc2 toc-left">
    <div id="header">
        <h1>Hibernate Validator 7.0.1 - Jakarta Bean Validation 参考实现: 参考指南</h1>
        <div class="details">
            <span id="author" class="author">Hardy Ferentschik</span><br>
            <span id="author2" class="author">Gunnar Morling</span><br>
            <span id="author3" class="author">Guillaume Smet</span><br>
            <span id="author4" class="author">YuYang(中文译)</span><br>
            <span id="revdate">2021-03-21</span>
        </div>
        <div id="toc" class="toc2">
            <div id="toctitle">Table of Contents</div>
            <ul class="sectlevel1">
                <li><a href="#preface">前言</a></li>
                <li><a href="#validator-gettingstarted">1. 快速开始</a>
                    <ul class="sectlevel2">
                        <li><a href="#validator-gettingstarted-createproject">1.1. 创建项目</a>
                            <ul class="sectlevel3">
                                <li><a href="#validator-gettingstarted-uel">1.1.1. 统一的EL表达式</a></li>
                                <li><a href="#section-getting-started-cdi">1.1.2. CDI</a></li>
                                <li><a href="#section-getting-started-security-manager">1.1.3. 与安全管理器一起运行</a></li>
                                <li><a href="#_在_wildfly_中更新_hibernate_验证器">1.1.4. 在 WildFly 中更新 Hibernate 验证器</a></li>
                                <li><a href="#validator-gettingstarted-java9">1.1.5. 在 Java 9上运行</a></li>
                            </ul>
                        </li>
                        <li><a href="#validator-gettingstarted-createmodel">1.2. 使用约束</a></li>
                        <li><a href="#_校验约束">1.3. 校验约束</a></li>
                        <li><a href="#validator-gettingstarted-whatsnext">1.4. 接下来的是？</a></li>
                    </ul>
                </li>
                <li><a href="#chapter-bean-constraints">2. 声明和校验 bean 约束</a>
                    <ul class="sectlevel2">
                        <li><a href="#section-declaring-bean-constraints">2.1. 声明 bean 约束</a>
                            <ul class="sectlevel3">
                                <li><a href="#_字段级约束">2.1.1. 字段级约束</a></li>
                                <li><a href="#_属性级约束">2.1.2. 属性级约束</a></li>
                                <li><a href="#container-element-constraints">2.1.3. 容器元素约束</a></li>
                                <li><a href="#validator-usingvalidator-classlevel">2.1.4. 类层面的约束</a></li>
                                <li><a href="#section-constraint-inheritance">2.1.5. 约束继承</a></li>
                                <li><a href="#section-object-graph-validation">2.1.6. 对象图</a></li>
                            </ul>
                        </li>
                        <li><a href="#section-validating-bean-constraints">2.2. 验证 bean 约束</a>
                            <ul class="sectlevel3">
                                <li><a href="#section-obtaining-validator">2.2.1. 获取 <code>Validator</code> 实例</a></li>
                                <li><a href="#_validator_方法">2.2.2. Validator 方法</a></li>
                                <li><a href="#section-constraint-violation-methods">2.2.3. <code>ConstraintViolation</code></a></li>
                            </ul>
                        </li>
                        <li><a href="#section-builtin-constraints">2.3. 内置约束</a>
                            <ul class="sectlevel3">
                                <li><a href="#validator-defineconstraints-spec">2.3.1. Jakarta Bean Validation 约束</a></li>
                                <li><a href="#validator-defineconstraints-hv-constraints">2.3.2. 附加约束</a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li><a href="#chapter-method-constraints">3. 声明和校验 method 约束</a>
                    <ul class="sectlevel2">
                        <li><a href="#section-declaring-method-constraints">3.1. 声明方法约束</a>
                            <ul class="sectlevel3">
                                <li><a href="#_参数约束">3.1.1. 参数约束</a></li>
                                <li><a href="#_返回值约束">3.1.2. 返回值约束</a></li>
                                <li><a href="#_级联校验">3.1.3. 级联校验</a></li>
                                <li><a href="#section-method-constraints-inheritance-hierarchies">3.1.4. 继承层次中的方法约束</a></li>
                            </ul>
                        </li>
                        <li><a href="#section-validating-executable-constraints">3.2. 校验方法约束</a>
                            <ul class="sectlevel3">
                                <li><a href="#section-obtaining-executable-validator">3.2.1. 获取 <code>ExecutableValidator</code> 实例</a></li>
                                <li><a href="#section-executable-validator-methods">3.2.2. <code>ExecutableValidator</code> 的方法</a></li>
                                <li><a href="#_校验方法的结果_constraintviolation">3.2.3. 校验方法的结果 <code>ConstraintViolation</code></a></li>
                            </ul>
                        </li>
                        <li><a href="#section-builtin-method-constraints">3.3. 内置方法约束</a></li>
                    </ul>
                </li>
                <li><a href="#chapter-message-interpolation">4. 添加约束错误消息</a>
                    <ul class="sectlevel2">
                        <li><a href="#section-message-interpolation">4.1. 默认消息插值</a>
                            <ul class="sectlevel3">
                                <li><a href="#section-special-characters">4.1.1. 特殊字符</a></li>
                                <li><a href="#section-interpolation-with-message-expressions">4.1.2. 带有消息表达式的插值</a></li>
                                <li><a href="#_示例">4.1.3. 示例</a></li>
                            </ul>
                        </li>
                        <li><a href="#section-custom-message-interpolation">4.2. 自定义消息插值</a>
                            <ul class="sectlevel3">
                                <li><a href="#section-resource-bundle-locator">4.2.1. <code>ResourceBundleLocator</code></a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li><a href="#chapter-groups">5. 分组约束</a>
                    <ul class="sectlevel2">
                        <li><a href="#_请求分组">5.1. 请求分组</a></li>
                        <li><a href="#section-group-inheritance">5.2. 分组继承</a></li>
                        <li><a href="#section-defining-group-sequences">5.3. 定义分组序列</a></li>
                        <li><a href="#section-default-group-class">5.4. 重新定义默认组序列</a>
                            <ul class="sectlevel3">
                                <li><a href="#_groupsequence">5.4.1. <code>@GroupSequence</code></a></li>
                                <li><a href="#_groupsequenceprovider">5.4.2. <code>@GroupSequenceProvider</code></a></li>
                            </ul>
                        </li>
                        <li><a href="#section-group-conversion">5.5. 分组转化</a></li>
                    </ul>
                </li>
                <li><a href="#validator-customconstraints">6. 自定义约束</a>
                    <ul class="sectlevel2">
                        <li><a href="#validator-customconstraints-simple">6.1. 创建一个简单的约束</a>
                            <ul class="sectlevel3">
                                <li><a href="#validator-customconstraints-constraintannotation">6.1.1. 约束注解</a></li>
                                <li><a href="#section-constraint-validator">6.1.2. 约束校验器</a></li>
                                <li><a href="#validator-customconstraints-errormessage">6.1.3. The error message</a></li>
                                <li><a href="#validator-customconstraints-using">6.1.4. Using the constraint</a></li>
                            </ul>
                        </li>
                        <li><a href="#section-class-level-constraints">6.2. Class-level constraints</a>
                            <ul class="sectlevel3">
                                <li><a href="#section-custom-property-paths">6.2.1. Custom property paths</a></li>
                            </ul>
                        </li>
                        <li><a href="#section-cross-parameter-constraints">6.3. Cross-parameter constraints</a></li>
                        <li><a href="#section-constraint-composition">6.4. Constraint composition</a></li>
                    </ul>
                </li>
                <li><a href="#chapter-valueextraction">7. Value extraction</a>
                    <ul class="sectlevel2">
                        <li><a href="#section-valueextraction-builtinvalueextractors">7.1. Built-in value extractors</a></li>
                        <li><a href="#_implementing_a_valueextractor">7.2. Implementing a <code>ValueExtractor</code></a></li>
                        <li><a href="#_non_generic_containers">7.3. Non generic containers</a></li>
                        <li><a href="#section-valueextraction-javafx">7.4. JavaFX value extractors</a></li>
                        <li><a href="#section-valueextraction-registeringvalueextractor">7.5. Registering a <code>ValueExtractor</code></a></li>
                        <li><a href="#_resolution_algorithms">7.6. Resolution algorithms</a></li>
                    </ul>
                </li>
                <li><a href="#chapter-xml-configuration">8. Configuring via XML</a>
                    <ul class="sectlevel2">
                        <li><a href="#section-configuration-validation-xml">8.1. Configuring the validator factory in <em>validation.xml</em></a></li>
                        <li><a href="#section-mapping-xml-constraints">8.2. Mapping constraints via <code>constraint-mappings</code></a></li>
                    </ul>
                </li>
                <li><a href="#chapter-bootstrapping">9. Bootstrapping</a>
                    <ul class="sectlevel2">
                        <li><a href="#section-retrieving-validator-factory-validator">9.1. Retrieving <code>ValidatorFactory</code> and <code>Validator</code></a>
                            <ul class="sectlevel3">
                                <li><a href="#section-validation-provider-resolver">9.1.1. <code>ValidationProviderResolver</code></a></li>
                            </ul>
                        </li>
                        <li><a href="#section-configuring-validator-factory">9.2. Configuring a <code>ValidatorFactory</code></a>
                            <ul class="sectlevel3">
                                <li><a href="#section-validator-factory-message-interpolator">9.2.1. <code>MessageInterpolator</code></a></li>
                                <li><a href="#section-validator-factory-traversable-resolver">9.2.2. <code>TraversableResolver</code></a></li>
                                <li><a href="#_constraintvalidatorfactory">9.2.3. <code>ConstraintValidatorFactory</code></a></li>
                                <li><a href="#section-parameter-name-provider">9.2.4. <code>ParameterNameProvider</code></a></li>
                                <li><a href="#section-clock-provider">9.2.5. <code>ClockProvider</code> and temporal validation tolerance</a></li>
                                <li><a href="#section-bootstrapping-valueextractors">9.2.6. Registering <code>ValueExtractor</code>s</a></li>
                                <li><a href="#_adding_mapping_streams">9.2.7. Adding mapping streams</a></li>
                                <li><a href="#section-provider-specific-settings">9.2.8. Provider-specific settings</a></li>
                                <li><a href="#section-script-evaluator-factory">9.2.9. Configuring the <code>ScriptEvaluatorFactory</code></a></li>
                            </ul>
                        </li>
                        <li><a href="#section-configuring-validator">9.3. Configuring a Validator</a></li>
                    </ul>
                </li>
                <li><a href="#validator-metadata-api">10. Using constraint metadata</a>
                    <ul class="sectlevel2">
                        <li><a href="#_beandescriptor">10.1. <code>BeanDescriptor</code></a></li>
                        <li><a href="#section-property-descriptor">10.2. <code>PropertyDescriptor</code></a></li>
                        <li><a href="#_methoddescriptor_and_constructordescriptor">10.3. <code>MethodDescriptor</code> and <code>ConstructorDescriptor</code></a></li>
                        <li><a href="#validator-metadata-api-elementdescriptor">10.4. <code>ElementDescriptor</code></a></li>
                        <li><a href="#_containerdescriptor_and_containerelementtypedescriptor">10.5. <code>ContainerDescriptor</code> and <code>ContainerElementTypeDescriptor</code></a></li>
                        <li><a href="#section-group-conversion-descriptor">10.6. <code>GroupConversionDescriptor</code></a></li>
                        <li><a href="#section-constraint-descriptor">10.7. <code>ConstraintDescriptor</code></a></li>
                    </ul>
                </li>
                <li><a href="#validator-integration">11. Integrating with other frameworks</a>
                    <ul class="sectlevel2">
                        <li><a href="#validator-checkconstraints-orm">11.1. ORM integration</a>
                            <ul class="sectlevel3">
                                <li><a href="#validator-checkconstraints-db">11.1.1. Database schema-level validation</a></li>
                                <li><a href="#validator-checkconstraints-orm-hibernateevent">11.1.2. Hibernate ORM event-based validation</a></li>
                                <li><a href="#_jpa">11.1.3. JPA</a></li>
                            </ul>
                        </li>
                        <li><a href="#section-presentation-layer">11.2. JSF &amp; Seam</a></li>
                        <li><a href="#section-integration-with-cdi">11.3. CDI</a>
                            <ul class="sectlevel3">
                                <li><a href="#_dependency_injection">11.3.1. Dependency injection</a></li>
                                <li><a href="#_method_validation">11.3.2. Method validation</a></li>
                            </ul>
                        </li>
                        <li><a href="#_java_ee">11.4. Java EE</a></li>
                        <li><a href="#_javafx">11.5. JavaFX</a></li>
                    </ul>
                </li>
                <li><a href="#validator-specifics">12. Hibernate Validator Specifics</a>
                    <ul class="sectlevel2">
                        <li><a href="#_public_api">12.1. Public API</a></li>
                        <li><a href="#section-fail-fast">12.2. Fail fast mode</a></li>
                        <li><a href="#section-method-validation-prerequisite-relaxation">12.3. Relaxation of requirements for method validation in class hierarchies</a></li>
                        <li><a href="#section-programmatic-api">12.4. Programmatic constraint definition and declaration</a></li>
                        <li><a href="#section-programmatic-api-contributor">12.5. Applying programmatic constraint declarations to the default validator factory</a></li>
                        <li><a href="#section-advanced-constraint-composition">12.6. Advanced constraint composition features</a>
                            <ul class="sectlevel3">
                                <li><a href="#_validation_target_specification_for_purely_composed_constraints">12.6.1. Validation target specification for purely composed constraints</a></li>
                                <li><a href="#section-boolean-constraint-composition">12.6.2. Boolean composition of constraints</a></li>
                            </ul>
                        </li>
                        <li><a href="#section-extensions-path-api">12.7. Extensions of the Path API</a></li>
                        <li><a href="#section-dynamic-payload">12.8. Dynamic payload as part of <code>ConstraintViolation</code></a></li>
                        <li><a href="#el-features">12.9. Enabling Expression Language features</a></li>
                        <li><a href="#non-el-message-interpolator">12.10. <code>ParameterMessageInterpolator</code></a></li>
                        <li><a href="#_resourcebundlelocator">12.11. <code>ResourceBundleLocator</code></a></li>
                        <li><a href="#section-locale-resolver">12.12. Customizing the locale resolution</a></li>
                        <li><a href="#_custom_contexts">12.13. Custom contexts</a>
                            <ul class="sectlevel3">
                                <li><a href="#section-hibernateconstraintvalidatorcontext">12.13.1. <code>HibernateConstraintValidatorContext</code></a></li>
                                <li><a href="#_hibernatemessageinterpolatorcontext">12.13.2. <code>HibernateMessageInterpolatorContext</code></a></li>
                            </ul>
                        </li>
                        <li><a href="#section-paranamer-parameternameprovider">12.14. Paranamer based <code>ParameterNameProvider</code></a></li>
                        <li><a href="#section-constraint-definition-contribution">12.15. Providing constraint definitions</a>
                            <ul class="sectlevel3">
                                <li><a href="#_constraint_definitions_via_serviceloader">12.15.1. Constraint definitions via <code>ServiceLoader</code></a></li>
                                <li><a href="#section-programmatic-constraint-definition">12.15.2. Adding constraint definitions programmatically</a></li>
                            </ul>
                        </li>
                        <li><a href="#section-constraint-customizing-class-loading">12.16. Customizing class-loading</a></li>
                        <li><a href="#section-getter-property-selection-strategy">12.17. Customizing the getter property selection strategy</a></li>
                        <li><a href="#section-property-node-name-provider">12.18. Customizing the property name resolution for constraint violations</a></li>
                    </ul>
                </li>
                <li><a href="#validator-annotation-processor">13. Annotation Processor</a>
                    <ul class="sectlevel2">
                        <li><a href="#validator-annotationprocessor-prerequisites">13.1. Prerequisites</a></li>
                        <li><a href="#validator-annotationprocessor-features">13.2. Features</a></li>
                        <li><a href="#validator-annotationprocessor-options">13.3. Options</a></li>
                        <li><a href="#validator-annotationprocessor-usage">13.4. Using the Annotation Processor</a>
                            <ul class="sectlevel3">
                                <li><a href="#validator-annotationprocessor-commandline">13.4.1. Command line builds</a></li>
                                <li><a href="#validator-annotationprocessor-ide">13.4.2. IDE builds</a></li>
                            </ul>
                        </li>
                        <li><a href="#validator-annotationprocessor-known-issues">13.5. Known issues</a></li>
                    </ul>
                </li>
                <li><a href="#validator-further-reading">14. Further reading</a></li>
            </ul>
        </div>
    </div>
    <div id="content">
        <div class="sect1">
            <h2 id="preface">
                <a class="anchor" href="#preface"></a>前言</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>数据校验是一项常见任务，从表示层到持久层的所有应用都会用到。通常，在每个层中都各自实现其验证逻辑，这既耗时又容易出错。为了避免重复进行校验操作，开发人员通常将校验逻辑直接捆绑到域模型中，从而使域类与校验相关代码杂乱无章，而校验相关代码实际上是有关类本身的元数据。</p>
                </div>
                <div class="imageblock">
                    <div class="content">
                        <img src="application-layers.png" alt="application layers">
                    </div>
                </div>
                <div class="paragraph">
                    <p>Jakarta Bean Validation 2.0-定义了用于实体和方法校验的元数据模型和API。默认的元数据源是注释，也能够通过使用XML覆盖和扩展元数据。该API不受特定应用程序层或编程模型的束缚。它不与Web层或持久性层绑定，并且可用于服务器端应用程序编程以及客户端Swing应用程序开发人员。</p>
                </div>
                <div class="imageblock">
                    <div class="content">
                        <img src="application-layers2.png" alt="application layers2">
                    </div>
                </div>
                <div class="paragraph">
                    <p>Hibernate Validator是Jakarta Bean Validation的参考实现。该实现本身以及Jakarta Bean验证API和TCK均在 <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache Software License 2.0</a> 下提供和分发 .</p>
                </div>
                <div class="paragraph">
                    <p>Hibernate Validator 6和Jakarta Bean Validation 2.0需要Java 8版本。</p>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="validator-gettingstarted">
                <a class="anchor" href="#validator-gettingstarted"></a>1. 快速开始</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>本章将向您展示如何开始使用Hibernate Validator，它是Jakarta Bean Validation的参考实现(reference implementation RI)。您需要准备：</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p>JDK 8</p>
                        </li>
                        <li>
                            <p><a href="http://maven.apache.org/">Apache Maven</a></p>
                        </li>
                        <li>
                            <p>互联网 (Maven需要下载相关依赖库)</p>
                        </li>
                    </ul>
                </div>
                <div class="sect2">
                    <h3 id="validator-gettingstarted-createproject">
                        <a class="anchor" href="#validator-gettingstarted-createproject"></a>1.1. 创建项目</h3>
                    <div class="paragraph">
                        <p>为了在Maven项目中使用Hibernate Validator，只需将以下依赖项添加到 <em>pom.xml</em> 中:</p>
                    </div>
                    <div class="exampleblock">
                        <div class="title">Example 1. Hibernate Validator Maven 依赖项</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;dependency&gt;
    &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;
    &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;
    &lt;version&gt;7.0.1.Final&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>这样也会引入依赖 Jakarta Bean Validation API (<code>jakarta.validation:jakarta.validation-api:3.0.0</code>).</p>
                    </div>
                    <div class="sect3">
                        <h4 id="validator-gettingstarted-uel">
                            <a class="anchor" href="#validator-gettingstarted-uel"></a>1.1.1. 统一的EL表达式</h4>
                        <div class="paragraph">
                            <p>Hibernate Validator 需要一个 <a href="https://projects.eclipse.org/projects/ee4j.el">Jakarta Expression Language</a> 的实现来能够动态使用表达式计算校验结果 ( <a href="#section-message-interpolation">Section 4.1, &#8220;默认消息插值&#8221;</a>). 当您的应用程序在
                                Java EE 容器(如 JOSS AS)中运行时，相关容器已经提供了EL实现。 但是，在Java SE环境中，您必须将一个实现作为依赖项添加到您的POM文件。例如，您可以添加以下依赖项来使用 Jakarta EL <a href="https://github.com/eclipse-ee4j/el-ri">reference
implementation</a>引用:</p>
                        </div>
                        <div class="exampleblock">
                            <div class="title">Example 2. Maven 统一 EL 引用实现的 Maven 依赖项</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;dependency&gt;
    &lt;groupId&gt;org.glassfish&lt;/groupId&gt;
    &lt;artifactId&gt;jakarta.el&lt;/artifactId&gt;
    &lt;version&gt;4.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="admonitionblock tip">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Tip</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>对于那些不能提供 EL 实现的环境，Hibernate Validator 提供了一个<a href="#non-el-message-interpolator">Section 12.10, &#8220;<code>ParameterMessageInterpolator</code>&#8221;</a>。但是，使用这个插值器不符合 Jakarta Bean 验证规范。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-getting-started-cdi">
                            <a class="anchor" href="#section-getting-started-cdi"></a>1.1.2. CDI</h4>
                        <div class="paragraph">
                            <p>Jakarta Bean Validation 定义了与 CDI (
                                <a href="https://projects.eclipse.org/projects/ee4j.cdi">Contexts and Dependency Injection for Jakarta EE</a>)的集成点. 如果你的应用运行在一个没有提供这种集成的环境中，你可以使用 Hibernate Validator CDI 可移植扩展，方法是在你的 POM 中添加下面的 Maven 依赖项:</p>
                        </div>
                        <div class="exampleblock">
                            <div class="title">Example 3. Hibernate Validator CDI 可移植扩展 Maven 依赖项</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;dependency&gt;
    &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;
    &lt;artifactId&gt;hibernate-validator-cdi&lt;/artifactId&gt;
    &lt;version&gt;7.0.1.Final&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>注意，在 Java EE 应用程序服务器上运行的应用程序通常不需要添加此依赖项。您可以在<a href="#section-integration-with-cdi">Section 11.3, &#8220;CDI&#8221;</a>中了解关于 Jakarta Bean Validation和 CDI 集成的更多信息。</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-getting-started-security-manager">
                            <a class="anchor" href="#section-getting-started-security-manager"></a>1.1.3. 与安全管理器一起运行</h4>
                        <div class="paragraph">
                            <p>Hibernate Validator 支持在启用安全管理器(security manager)的情况下运行。。为此，您必须为 Hibernate Validator、 Jakarta Bean Validation API、 Classmate 和 JBoss Logging 的代码库以及调用 Jakarta Bean Validation 的代码库分配多个权限。下面展示了如何通过由 Java 默认策略实现处理的策略文件来实现这一点:</p>
                        </div>
                        <div class="exampleblock">
                            <div class="title">Example 4. 使用 Hibernate Validator 和安全管理器的策略文件</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">grant codeBase "file:path/to/hibernate-validator-{hvVersion}.jar" {
    permission java.lang.reflect.ReflectPermission "suppressAccessChecks";
    permission java.lang.RuntimePermission "accessDeclaredMembers";
    permission java.lang.RuntimePermission "setContextClassLoader";

    permission org.hibernate.validator.HibernateValidatorPermission "accessPrivateMembers";

    // Only needed when working with XML descriptors (validation.xml or XML constraint mappings)
    permission java.util.PropertyPermission "mapAnyUriToUri", "read";
};

grant codeBase "file:path/to/jakarta.validation-api-{bvVersion}.jar" {
    permission java.io.FilePermission "path/to/hibernate-validator-{hvVersion}.jar", "read";
};

grant codeBase "file:path/to/jboss-logging-{jbossLoggingVersion}.jar" {
    permission java.util.PropertyPermission "org.jboss.logging.provider", "read";
    permission java.util.PropertyPermission "org.jboss.logging.locale", "read";
};

grant codeBase "file:path/to/classmate-{classmateVersion}.jar" {
    permission java.lang.RuntimePermission "accessDeclaredMembers";
};

grant codeBase "file:path/to/validation-caller-x.y.z.jar" {
    permission org.hibernate.validator.HibernateValidatorPermission "accessPrivateMembers";
};</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_在_wildfly_中更新_hibernate_验证器">
                            <a class="anchor" href="#_在_wildfly_中更新_hibernate_验证器"></a>1.1.4. 在 WildFly 中更新 Hibernate 验证器</h4>
                        <div class="paragraph">
                            <p><a href="http://wildfly.org/">WildFly 应用程序服务器</a>包含开箱即用的 Hibernate 验证器。为了将 Jakarta Bean Validation API 和 Hibernate Validator 的服务器模块更新为最新和最大的模块，可以使用 WildFly 的补丁机制。</p>
                        </div>
                        <div class="paragraph">
                            <p>你可以使用以下依赖项从 <a href="http://sourceforge.net/projects/hibernate/files/hibernate-validator">SourceForge</a> 或者 Maven Central 下载修补程序文件:</p>
                        </div>
                        <div class="exampleblock">
                            <div class="title">Example 5. WildFly 22.0.0. Final patch file 的 Maven 依赖项</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;dependency&gt;
    &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;
    &lt;artifactId&gt;hibernate-validator-modules&lt;/artifactId&gt;
    &lt;version&gt;7.0.1.Final&lt;/version&gt;
    &lt;classifier&gt;wildfly-22.0.0.Final-patch&lt;/classifier&gt;
    &lt;type&gt;zip&lt;/type&gt;
&lt;/dependency&gt;</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>我们还为 WildFly 提供了一个补丁:</p>
                        </div>
                        <div class="exampleblock">
                            <div class="title">Example 6. Maven 对 WildFly 补丁文件的依赖关系</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;dependency&gt;
    &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;
    &lt;artifactId&gt;hibernate-validator-modules&lt;/artifactId&gt;
    &lt;version&gt;7.0.1.Final&lt;/version&gt;
    &lt;classifier&gt;wildfly-patch&lt;/classifier&gt;
    &lt;type&gt;zip&lt;/type&gt;
&lt;/dependency&gt;</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>下载了补丁文件后，你可以通过运行以下命令将它应用到 WildFly:</p>
                        </div>
                        <div class="exampleblock">
                            <div class="title">Example 7. 应用 WildFly 补丁</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-none hljs">$JBOSS_HOME/bin/jboss-cli.sh patch apply hibernate-validator-modules-7.0.1.Final-wildfly-22.0.0.Final-patch.zip</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>如果你想撤销补丁并返回到服务器最初提供的 Hibernate Validator 版本，请运行以下命令:</p>
                        </div>
                        <div class="exampleblock">
                            <div class="title">Example 8. 回滚 WildFly 补丁</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-none hljs">$JBOSS_HOME/bin/jboss-cli.sh patch rollback --reset-configuration=true</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>您可以在 <a href="https://developer.jboss.org/wiki/SingleInstallationPatching/">这里</a> 和 <a href="http://www.mastertheboss.com/jboss-server/jboss-configuration/managing-wildfly-and-eap-patches">这里</a>了解有关 WildFly 补丁基础设施的更多信息。</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="validator-gettingstarted-java9">
                            <a class="anchor" href="#validator-gettingstarted-java9"></a>1.1.5. 在 Java 9上运行</h4>
                        <div class="paragraph">
                            <p>从 Hibernate Validator 7.0.1开始。最后，对 Java 9和 Java 平台模块系统(JPMS)的支持是实验性的。目前还没有提供 JPMS 模块描述符，但 Hibernate 验证器可以用作自动模块。</p>
                        </div>
                        <div class="paragraph">
                            <p>这些是使用 <code>Automatic-Module-Name</code> 头声明的模块名称:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p>Jakarta Bean Validation API: <code>java.validation</code></p>
                                </li>
                                <li>
                                    <p>Hibernate Validator core: <code>org.hibernate.validator</code></p>
                                </li>
                                <li>
                                    <p>Hibernate Validator CDI extension: <code>org.hibernate.validator.cdi</code></p>
                                </li>
                                <li>
                                    <p>Hibernate Validator test utilities: <code>org.hibernate.validator.testutils</code></p>
                                </li>
                                <li>
                                    <p>Hibernate Validator annotation processor: <code>org.hibernate.validator.annotationprocessor</code></p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>这些模块名称是初步的，在将来的版本中提供真正的模块描述符时可能会改变。</p>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="validator-gettingstarted-createmodel">
                        <a class="anchor" href="#validator-gettingstarted-createmodel"></a>1.2. 使用约束</h3>
                    <div class="paragraph">
                        <p>让我们直接深入到一个示例中，看看如何应用检验条件。</p>
                    </div>
                    <div id="example-class-car" class="exampleblock">
                        <div class="title">Example 9. 使用注解的 Class Car</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter01;

import jakarta.validation.constraints.Min;
import jakarta.validation.constraints.NotNull;
import jakarta.validation.constraints.Size;

public class Car {

	@NotNull
	private String manufacturer;

	@NotNull
	@Size(min = 2, max = 14)
	private String licensePlate;

	@Min(2)
	private int seatCount;

	public Car(String manufacturer, String licencePlate, int seatCount) {
		this.manufacturer = manufacturer;
		this.licensePlate = licencePlate;
		this.seatCount = seatCount;
	}

	//getters and setters ...
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p><code>@NotNull</code>, <code>@Size</code> 和 <code>@Min</code> 注解用于声明应该应用于 Car 实例字段的校验:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p><code>manufacturer</code> 必须永远不能为 <code>null</code></p>
                            </li>
                            <li>
                                <p><code>licensePlate</code> 不能为 <code>null</code> ，并且必须在2到14个字符之间</p>
                            </li>
                            <li>
                                <p><code>seatCount</code> 必须至少是2</p>
                            </li>
                        </ul>
                    </div>
                    <div class="admonitionblock tip">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Tip</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>您可以在 GitHub 上的 Hibernate Validator
                                            <a href="https://github.com/hibernate/hibernate-validator/tree/master/documentation/src/test">源代码库</a> 中找到本参考指南中所有示例的完整源代码。
                                        </p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_校验约束">
                        <a class="anchor" href="#_校验约束"></a>1.3. 校验约束</h3>
                    <div class="paragraph">
                        <p>若要对这些约束执行验证，请使用 <code>Validator</code> 实例。让我们看一下 <code>Car</code> 的单元测试:</p>
                    </div>
                    <div class="exampleblock">
                        <div class="title">Example 10. 类 CarTest 显示验证示例</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter01;

import java.util.Set;
import jakarta.validation.ConstraintViolation;
import jakarta.validation.Validation;
import jakarta.validation.Validator;
import jakarta.validation.ValidatorFactory;

import org.junit.BeforeClass;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class CarTest {

	private static Validator validator;

	@BeforeClass
	public static void setUpValidator() {
		ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
		validator = factory.getValidator();
	}

	@Test
	public void manufacturerIsNull() {
		Car car = new Car( null, "DD-AB-123", 4 );

		Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =
				validator.validate( car );

		assertEquals( 1, constraintViolations.size() );
		assertEquals( "must not be null", constraintViolations.iterator().next().getMessage() );
	}

	@Test
	public void licensePlateTooShort() {
		Car car = new Car( "Morris", "D", 4 );

		Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =
				validator.validate( car );

		assertEquals( 1, constraintViolations.size() );
		assertEquals(
				"size must be between 2 and 14",
				constraintViolations.iterator().next().getMessage()
		);
	}

	@Test
	public void seatCountTooLow() {
		Car car = new Car( "Morris", "DD-AB-123", 1 );

		Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =
				validator.validate( car );

		assertEquals( 1, constraintViolations.size() );
		assertEquals(
				"must be greater than or equal to 2",
				constraintViolations.iterator().next().getMessage()
		);
	}

	@Test
	public void carIsValid() {
		Car car = new Car( "Morris", "DD-AB-123", 2 );

		Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =
				validator.validate( car );

		assertEquals( 0, constraintViolations.size() );
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>在 <code>setUp()</code> 方法中，使用`ValidatorFactory` 获取一个 <code>Validator</code> 对象。 <code>Validator</code> 实例是线程安全的，可以多次重用。因此，它可以安全地存储在一个静态领域，并用于测试方法，以验证不同的 <code>Car</code> 实例.</p>
                    </div>
                    <div class="paragraph">
                        <p><code>validate()</code> 方法返回一组 <code>ConstraintViolation</code> 实例, 您可以对其进行迭代操作，以查看发生了哪些验证错误。前三个测试方法显示了一些预期的违反约束的情况:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>在 <code>manufacturerIsNull()</code> 方法中，违反了 <code>manufacturer</code> 字段的 <code>@NotNull</code> 约束</p>
                            </li>
                            <li>
                                <p>在 <code>licensePlateTooShort()</code> 方法中，违反了 <code>licensePlate</code> 字段的 <code>@Size</code> 约束</p>
                            </li>
                            <li>
                                <p>在 <code>seatCountTooLow()</code> 方法中，违反了 <code>seatCount</code> 字段的 <code>@Min</code> 约束</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>如果对象成功验证，<code>validate()</code> 方法将返回一个空集，正如您在 <code>carIsValid()</code> 方法中看到的那样。</p>
                    </div>
                    <div class="paragraph">
                        <p>注意，只使用 Bean Validation API中 <code>jakarta.validation</code> 里面的类。没有直接引用来自 Hibernate Validator 的类，从而导致可移植代码。</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="validator-gettingstarted-whatsnext">
                        <a class="anchor" href="#validator-gettingstarted-whatsnext"></a>1.4. 接下来的是？</h3>
                    <div class="paragraph">
                        <p>以上是对 Hibernate Validator 和 Jakarta Bean Validation 的5分钟浏览。继续探索代码示例或者进一步阅读第14章中引用的示例。</p>
                    </div>
                    <div class="paragraph">
                        <p>要了解关于 bean 和属性验证的更多信息，请继续阅读第2章，声明和验证 bean 约束。如果您对使用 Jakarta Bean 验证来验证方法前置和后置条件感兴趣，请参阅第3章，方法约束的声明和验证。如果您的应用程序有特定的验证要求，请参阅第6章“创建自定义约束”。</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="chapter-bean-constraints">
                <a class="anchor" href="#chapter-bean-constraints"></a>2. 声明和校验 bean 约束</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>在本章中，您将学习如何声明 (see <a href="#section-declaring-bean-constraints">Section 2.1, &#8220;声明 bean 约束&#8221;</a>) 以及 校验 (see <a href="#section-validating-bean-constraints">Section 2.2, &#8220;验证 bean 约束&#8221;</a>) bean 约束。
                        <a href="#section-builtin-constraints">Section 2.3, &#8220;内置约束&#8221;</a> 概述了 Hibernate Validator提供的所有内置约束。</p>
                </div>
                <div class="paragraph">
                    <p>如果您对方法参数和返回值应用约束感兴趣，请参阅 <a href="#chapter-method-constraints">Chapter 3, <em>声明和校验 method 约束</em></a>.</p>
                </div>
                <div class="sect2">
                    <h3 id="section-declaring-bean-constraints">
                        <a class="anchor" href="#section-declaring-bean-constraints"></a>2.1. 声明 bean 约束</h3>
                    <div class="paragraph">
                        <p>Jakarta Bean 验证中的约束通过 Java 注解表示。在本节中，您将了解如何使用这些注解增强对象模型。有四种类型的 bean 约束:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>字段约束</p>
                            </li>
                            <li>
                                <p>属性约束</p>
                            </li>
                            <li>
                                <p>容器元素约束</p>
                            </li>
                            <li>
                                <p>类约束</p>
                            </li>
                        </ul>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>并非所有的约束都可以放在所有这些级别上。事实上，Jakarta Bean Validation 定义的约束都不能放在类级别上。相关约束注解的 <code>java.lang.annotation.Target</code> 确定可以在哪些类型上使用。 请参见 <a href="#validator-customconstraints">Chapter 6, <em>自定义约束</em></a> 获取更多信息。</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="sect3">
                        <h4 id="_字段级约束">
                            <a class="anchor" href="#_字段级约束"></a>2.1.1. 字段级约束</h4>
                        <div class="paragraph">
                            <p>约束可以通过给类的字段来添加字段。 <a href="#example-field-level">Example 11, &#8220;字段级约束&#8221;</a> 显示了一个字段级别的配置例子:</p>
                        </div>
                        <div id="example-field-level" class="exampleblock">
                            <div class="title">Example 11. 字段级约束</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.fieldlevel;

public class Car {

	@NotNull
	private String manufacturer;

	@AssertTrue
	private boolean isRegistered;

	public Car(String manufacturer, boolean isRegistered) {
		this.manufacturer = manufacturer;
		this.isRegistered = isRegistered;
	}

	//getters and setters...
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>当使用字段级约束时，字段访问策略用于访问要验证的值。这意味着验证引擎直接访问实例变量访问器，即使存在属性访问器(Getter方法)，也不会调用属性访问器方法。</p>
                        </div>
                        <div class="paragraph">
                            <p>约束可以应用于任何访问类型(公共、私有等)的字段。不过，不支持对静态字段的约束。</p>
                        </div>
                        <div class="admonitionblock tip">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Tip</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>当验证字节码增强对象时，应该使用属性级约束，因为字节码增强库不能通过反射确定字段访问。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_属性级约束">
                            <a class="anchor" href="#_属性级约束"></a>2.1.2. 属性级约束</h4>
                        <div class="paragraph">
                            <p>如果您的类遵循
                                <a href="http://www.oracle.com/technetwork/articles/javaee/spec-136004.html">JavaBeans</a> 标准, 那么也可以对 bean 类的属性而不是字段进行注解。
                                <a href="#example-property-level">Example 12, &#8220;属性级约束&#8221;</a> 使用与 <a href="#example-field-level">Example 11, &#8220;字段级约束&#8221;</a> 相同的实体，但是，使用了属性级别的约束。</p>
                        </div>
                        <div id="example-property-level" class="exampleblock">
                            <div class="title">Example 12. 属性级约束</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.propertylevel;

public class Car {

	private String manufacturer;

	private boolean isRegistered;

	public Car(String manufacturer, boolean isRegistered) {
		this.manufacturer = manufacturer;
		this.isRegistered = isRegistered;
	}

	@NotNull
	public String getManufacturer() {
		return manufacturer;
	}

	public void setManufacturer(String manufacturer) {
		this.manufacturer = manufacturer;
	}

	@AssertTrue
	public boolean isRegistered() {
		return isRegistered;
	}

	public void setRegistered(boolean isRegistered) {
		this.isRegistered = isRegistered;
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>属性的 getter 方法必须被使用注解，setter方法则不用。这样也可以约束没有 setter 方法的只读属性。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="paragraph">
                            <p>当使用属性级约束时，属性访问策略用于访问要验证的值，即验证引擎通过属性访问器方法访问状态。</p>
                        </div>
                        <div class="admonitionblock tip">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Tip</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>建议在一个类中坚持使用字段 <em>或</em> 属性注解。不建议对字段 <em>和</em> 附带的 getter 方法同时进行注解，因为这会导致对字段进行两次验证。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="container-element-constraints">
                            <a class="anchor" href="#container-element-constraints"></a>2.1.3. 容器元素约束</h4>
                        <div class="paragraph">
                            <p>可以直接在参数化类型的类型参数上指定约束: 这些约束称为容器元素约束。</p>
                        </div>
                        <div class="paragraph">
                            <p>这要求在约束定义中通过 <code>@Target</code> 指定 <code>ElementType.TYPE_USE</code> 。在 Jakarta Bean Validation 2.0 中，内置的 Jakarta Bean Validation和 Hibernate Validator 特定的约束指定 <code>ElementType.TYPE_USE</code> ，可以直接在这个上下文中使用。</p>
                        </div>
                        <div class="paragraph">
                            <p>Hibernate Validator 验证下列标准 Java 容器上指定的容器元素约束:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>java.util.Iterable</code> 的实现 (e.g. <code>List</code>s, <code>Set</code>s),</p>
                                </li>
                                <li>
                                    <p><code>java.util.Map</code> 的实现, 支持keys和values方法,</p>
                                </li>
                                <li>
                                    <p><code>java.util.Optional</code>, <code>java.util.OptionalInt</code>, <code>java.util.OptionalDouble</code>, <code>java.util.OptionalLong</code>,</p>
                                </li>
                                <li>
                                    <p>JavaFX 中的 <code>javafx.beans.observable.ObservableValue</code> 各类实现</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>它还支持自定义容器类型上的容器元素约束(参见 <a href="#chapter-valueextraction">Chapter 7, <em>Value extraction</em></a> )。</p>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>在6之前的版本中，支持容器元素约束的子集。在容器级别需要@valid 注解来启用它们。从 Hibernate Validator 6开始就不再需要这个了。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="paragraph">
                            <p>我们将在下面提供两个示例，说明各种 Java 类型上的容器元素约束。</p>
                        </div>
                        <div class="paragraph">
                            <p>在这些示例中, <code>@ValidPart</code> 是一个允许在 <code>TYPE_USE</code> 上下文中使用的自定义约束。</p>
                        </div>
                        <div class="sect4">
                            <h5 id="_iterable">
                                <a class="anchor" href="#_iterable"></a>2.1.3.1. <code>Iterable</code></h5>
                            <div class="paragraph">
                                <p>在对 <code>Iterable</code> 类型参数应用约束时，Hibernate Validator 将校验其中的每个元素。 <a href="#example-container-element-constraints-iterable">Example 13, &#8220;容器元素约束 <code>Set</code>&#8221;</a> 展示了一个带有 Container 元素约束的 Set 示例。</p>
                            </div>
                            <div id="example-container-element-constraints-iterable" class="exampleblock">
                                <div class="title">Example 13. 容器元素约束 <code>Set</code></div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.containerelement.set;

import java.util.HashSet;
import java.util.Set;

public class Car {

	private Set&lt;@ValidPart String&gt; parts = new HashSet&lt;&gt;();

	public void addPart(String part) {
		parts.add( part );
	}

	//...

}</code></pre>
                                        </div>
                                    </div>
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car car = new Car();
car.addPart( "Wheel" );
car.addPart( null );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );

ConstraintViolation&lt;Car&gt; constraintViolation =
		constraintViolations.iterator().next();
assertEquals(
		"'null' is not a valid car part.",
		constraintViolation.getMessage()
);
assertEquals( "parts[].&lt;iterable element&gt;",
		constraintViolation.getPropertyPath().toString() );</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>请注意，属性路径如何清楚地表明违规来自迭代器的元素。</p>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_list">
                                <a class="anchor" href="#_list"></a>2.1.3.2. <code>List</code></h5>
                            <div class="paragraph">
                                <p>当对 <code>List</code> 类型参数应用约束时, Hibernate Validator 将校验每个元素。 <a href="#example-container-element-constraints-list">Example 14, &#8220;容器元素约束 <code>List</code>&#8221;</a> 展示了一个带有容器元素约束的 List 示例。</p>
                            </div>
                            <div id="example-container-element-constraints-list" class="exampleblock">
                                <div class="title">Example 14. 容器元素约束 <code>List</code></div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.containerelement.list;

public class Car {

	private List&lt;@ValidPart String&gt; parts = new ArrayList&lt;&gt;();

	public void addPart(String part) {
		parts.add( part );
	}

	//...

}</code></pre>
                                        </div>
                                    </div>
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car car = new Car();
car.addPart( "Wheel" );
car.addPart( null );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );

ConstraintViolation&lt;Car&gt; constraintViolation =
		constraintViolations.iterator().next();
assertEquals(
		"'null' is not a valid car part.",
		constraintViolation.getMessage()
);
assertEquals( "parts[1].&lt;list element&gt;",
		constraintViolation.getPropertyPath().toString() );</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>在这里，属性路径还包含无效元素的索引。</p>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_map">
                                <a class="anchor" href="#_map"></a>2.1.3.3. <code>Map</code></h5>
                            <div class="paragraph">
                                <p>容器元素约束也在映射键和值上进行验证。
                                    <a href="#example-container-element-constraints-map">Example 15, &#8220;映射键和值上的容器元素约束&#8221;</a> 展示了一个 <code>Map</code> 的例子，对 key 和 value都进行校验。</p>
                            </div>
                            <div id="example-container-element-constraints-map" class="exampleblock">
                                <div class="title">Example 15. 映射键和值上的容器元素约束</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.containerelement.map;

import java.util.HashMap;
import java.util.Map;

import jakarta.validation.constraints.NotNull;

public class Car {

	public enum FuelConsumption {
		CITY,
		HIGHWAY
	}

	private Map&lt;@NotNull FuelConsumption, @MaxAllowedFuelConsumption Integer&gt; fuelConsumption = new HashMap&lt;&gt;();

	public void setFuelConsumption(FuelConsumption consumption, int value) {
		fuelConsumption.put( consumption, value );
	}

	//...

}</code></pre>
                                        </div>
                                    </div>
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car car = new Car();
car.setFuelConsumption( Car.FuelConsumption.HIGHWAY, 20 );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );

ConstraintViolation&lt;Car&gt; constraintViolation =
		constraintViolations.iterator().next();
assertEquals(
		"20 is outside the max fuel consumption.",
		constraintViolation.getMessage()
);
assertEquals(
		"fuelConsumption[HIGHWAY].&lt;map value&gt;",
		constraintViolation.getPropertyPath().toString()
);</code></pre>
                                        </div>
                                    </div>
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car car = new Car();
car.setFuelConsumption( null, 5 );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );

ConstraintViolation&lt;Car&gt; constraintViolation =
		constraintViolations.iterator().next();
assertEquals(
		"must not be null",
		constraintViolation.getMessage()
);
assertEquals(
		"fuelConsumption&lt;K&gt;[].&lt;map key&gt;",
		constraintViolation.getPropertyPath().toString()
);</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>校验产生的错误信息：</p>
                            </div>
                            <div class="ulist">
                                <ul>
                                    <li>
                                        <p>无效的元素 (在第二个元素中, key为 <code>null</code>).</p>
                                    </li>
                                    <li>
                                        <p>在第一个示例中， <code>&lt;map value&gt;</code> 不符合约束, 在第二个示例中，<code>&lt;map key&gt;</code> 不符合约束。</p>
                                    </li>
                                    <li>
                                        <p>在第二个示例中，您可能已经注意到类型参数 <code>&lt;k&gt;</code> 的出现，稍后将详细讨论。</p>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_java_util_optional">
                                <a class="anchor" href="#_java_util_optional"></a>2.1.3.4. <code>java.util.Optional</code></h5>
                            <div class="paragraph">
                                <p>当对 <code>Optional</code> 参数应用约束时, Hibernate Validator 将自动打开类型并验证内部值。<a href="#example-container-element-constraints-optional">Example 16, &#8220;容器元素约束 Optional&#8221;</a> 展示了一个对 <code>Optional</code> 进行约束的例子。</p>
                            </div>
                            <div id="example-container-element-constraints-optional" class="exampleblock">
                                <div class="title">Example 16. 容器元素约束 Optional</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.containerelement.optional;

public class Car {

	private Optional&lt;@MinTowingCapacity(1000) Integer&gt; towingCapacity = Optional.empty();

	public void setTowingCapacity(Integer alias) {
		towingCapacity = Optional.of( alias );
	}

	//...

}</code></pre>
                                        </div>
                                    </div>
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car car = new Car();
car.setTowingCapacity( 100 );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );

ConstraintViolation&lt;Car&gt; constraintViolation = constraintViolations.iterator().next();
assertEquals(
		"Not enough towing capacity.",
		constraintViolation.getMessage()
);
assertEquals(
		"towingCapacity",
		constraintViolation.getPropertyPath().toString()
);</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>在这里，属性路径只包含属性的名称，因为我们认为 <code>Optional</code> 是一个“透明”容器。</p>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_使用自定义容器类型">
                                <a class="anchor" href="#_使用自定义容器类型"></a>2.1.3.5. 使用自定义容器类型</h5>
                            <div class="paragraph">
                                <p>容器元素约束也可以用于自定义容器。</p>
                            </div>
                            <div class="paragraph">
                                <p>必须为自定义类型注册 <code>ValueExtractor</code> ,以允许检索要验证的值 (see <a href="#chapter-valueextraction">Chapter 7, <em>Value extraction</em></a> 以获得关于如何实现自己的 <code>ValueExtractor</code> 以及如何注册它的更多信息)。</p>
                            </div>
                            <div class="paragraph">
                                <p><a href="#example-container-element-constraints-custom-container-type">Example 17, &#8220;自定义容器类型上的容器元素约束&#8221;</a> 展示了一个具有类型参数约束的自定义参数化类型的示例。</p>
                            </div>
                            <div id="example-container-element-constraints-custom-container-type" class="exampleblock">
                                <div class="title">Example 17. 自定义容器类型上的容器元素约束</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.containerelement.custom;

public class Car {

	private GearBox&lt;@MinTorque(100) Gear&gt; gearBox;

	public void setGearBox(GearBox&lt;Gear&gt; gearBox) {
		this.gearBox = gearBox;
	}

	//...

}</code></pre>
                                        </div>
                                    </div>
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.containerelement.custom;

public class GearBox&lt;T extends Gear&gt; {

	private final T gear;

	public GearBox(T gear) {
		this.gear = gear;
	}

	public Gear getGear() {
		return this.gear;
	}
}</code></pre>
                                        </div>
                                    </div>
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.containerelement.custom;

public class Gear {
	private final Integer torque;

	public Gear(Integer torque) {
		this.torque = torque;
	}

	public Integer getTorque() {
		return torque;
	}

	public static class AcmeGear extends Gear {
		public AcmeGear() {
			super( 60 );
		}
	}
}</code></pre>
                                        </div>
                                    </div>
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.containerelement.custom;

public class GearBoxValueExtractor implements ValueExtractor&lt;GearBox&lt;@ExtractedValue ?&gt;&gt; {

	@Override
	public void extractValues(GearBox&lt;@ExtractedValue ?&gt; originalValue, ValueExtractor.ValueReceiver receiver) {
		receiver.value( null, originalValue.getGear() );
	}
}</code></pre>
                                        </div>
                                    </div>
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car car = new Car();
car.setGearBox( new GearBox&lt;&gt;( new Gear.AcmeGear() ) );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );
assertEquals( 1, constraintViolations.size() );

ConstraintViolation&lt;Car&gt; constraintViolation =
		constraintViolations.iterator().next();
assertEquals(
		"Gear is not providing enough torque.",
		constraintViolation.getMessage()
);
assertEquals(
		"gearBox",
		constraintViolation.getPropertyPath().toString()
);</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_嵌套容器元素">
                                <a class="anchor" href="#_嵌套容器元素"></a>2.1.3.6. 嵌套容器元素</h5>
                            <div class="paragraph">
                                <p>嵌套容器元素也支持约束。</p>
                            </div>
                            <div class="paragraph">
                                <p>当校验 <a href="#example-container-element-nested">Example 18, &#8220;嵌套容器元素的约束&#8221;</a> 中的 <code>Car</code> 类, 容器中的 <code>Part</code> 和 <code>Manufacturer</code> 都会执行 <code>@NotNull</code> 的校验。</p>
                            </div>
                            <div id="example-container-element-nested" class="exampleblock">
                                <div class="title">Example 18. 嵌套容器元素的约束</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.containerelement.nested;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import jakarta.validation.constraints.NotNull;

public class Car {

	private Map&lt;@NotNull Part, List&lt;@NotNull Manufacturer&gt;&gt; partManufacturers =
			new HashMap&lt;&gt;();

	//...
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="validator-usingvalidator-classlevel">
                            <a class="anchor" href="#validator-usingvalidator-classlevel"></a>2.1.4. 类层面的约束</h4>
                        <div class="paragraph">
                            <p>最后但并非最不重要的一点是，还可以在类级别上放置约束。在这种情况下，验证的对象不是单个属性，而是完整的对象。如果验证依赖于对象的几个属性之间的相关性，则类级别约束非常有用。</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="#example-class-level">Example 19, &#8220;类级别约束&#8221;</a> 中的 <code>Car</code> 具有两个属性 <code>seatCount</code> 和 <code>passengers</code> 的约束，应确保乘客名单中的登记项不超过可用座位。为此，在类级别上添加 <code>@ValidPassengerCount</code> 约束。该约束的验证器可以访问完整的
                                <code>Car</code> 对象，允许比较座位和乘客的数量。</p>
                        </div>
                        <div class="paragraph">
                            <p>请参阅 <a href="#section-class-level-constraints">Section 6.2, &#8220;Class-level constraints&#8221;</a> ，详细了解如何实现这个自定义约束。</p>
                        </div>
                        <div id="example-class-level" class="exampleblock">
                            <div class="title">Example 19. 类级别约束</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.classlevel;

@ValidPassengerCount
public class Car {

	private int seatCount;

	private List&lt;Person&gt; passengers;

	//...
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-constraint-inheritance">
                            <a class="anchor" href="#section-constraint-inheritance"></a>2.1.5. 约束继承</h4>
                        <div class="paragraph">
                            <p>当一个类实现一个接口或扩展另一个类时，在父类型上声明的所有约束注解以与在类本身上指定的约束相同的方式应用。为了让事情更清楚，让我们看看下面的例子:</p>
                        </div>
                        <div class="exampleblock">
                            <div class="title">Example 20. 约束继承</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.inheritance;

public class Car {

	private String manufacturer;

	@NotNull
	public String getManufacturer() {
		return manufacturer;
	}

	//...
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.inheritance;

public class RentalCar extends Car {

	private String rentalStation;

	@NotNull
	public String getRentalStation() {
		return rentalStation;
	}

	//...
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>这里 <code>RentalCar</code> 是 <code>Car</code> 的一个子类，并添加了属性 <code>rentalStation</code>。如果对
                                <code>RentalCar</code> 的实例进行了校验， 不仅会校验 <code>rentalStation</code> 上的 <code>@NotNull</code> 注解, 还会计算来自父类的 <code>manufacturer</code> 约束。</p>
                        </div>
                        <div class="paragraph">
                            <p>如果 <code>Car</code> 不是一个超类，而是由 `RentalCar`实现的接口，情况也是如此。</p>
                        </div>
                        <div class="paragraph">
                            <p>如果方法被重写，则约束注解将被聚合。因此，如果 <code>RentalCar</code> 覆盖了 <code>Car</code> 中的
                                <code>getManufacturer()</code> 方法, 那么除了超类中的 <code>@NotNull</code> 约束之外，还将校验覆盖方法中注解的任何约束。</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-object-graph-validation">
                            <a class="anchor" href="#section-object-graph-validation"></a>2.1.6. 对象图</h4>
                        <div class="paragraph">
                            <p>The Jakarta Bean Validation API 不仅允许验证单个类实例，还允许验证完整的对象图(级联验证)。 要做到这一点，只需使用 <code>@Valid</code> 对表示对另一个对象的引用的字段或属性进行校验，如<a href="#example-cascaded-validation">Example 21, &#8220;级联验证&#8221;</a>。</p>
                        </div>
                        <div id="example-cascaded-validation" class="exampleblock">
                            <div class="title">Example 21. 级联验证</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.objectgraph;

public class Car {

	@NotNull
	@Valid
	private Person driver;

	//...
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.objectgraph;

public class Person {

	@NotNull
	private String name;

	//...
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>如果校验了 <code>Car</code> , 那么引用的 <code>Person</code> 对象也会被校验, 因为
                                <code>driver</code> 字段使用了 <code>@Valid`注解，。因此，如果引用的 `Person</code> 实例的 <code>name</code> 字段为 <code>null</code>，则 Car 的校验将失败。</p>
                        </div>
                        <div class="paragraph">
                            <p>对象图的验证是递归的，也就是说，如果一个标记为级联验证的引用指向一个对象，该对象本身具有带`@valid` 注解的属性，验证引擎也会跟踪这些引用。验证引擎将确保在级联验证期间不会发生无限循环，例如，如果两个对象彼此保持引用。</p>
                        </div>
                        <div class="paragraph">
                            <p>注意，在级联验证过程中忽略 <code>null</code> 。</p>
                        </div>
                        <div class="paragraph">
                            <p>作为约束，对象图验证也适用于容器元素。这意味着容器的任何类型参数都可以用 <code>@valid</code> 注解，这将导致在验证父对象时验证每个包含的元素。</p>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>嵌套容器元素也支持级联验证。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div id="example-cascaded-validation-list" class="exampleblock">
                            <div class="title">Example 22. 容器级联验证</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.objectgraph.containerelement;

public class Car {

	private List&lt;@NotNull @Valid Person&gt; passengers = new ArrayList&lt;Person&gt;();

	private Map&lt;@Valid Part, List&lt;@Valid Manufacturer&gt;&gt; partManufacturers = new HashMap&lt;&gt;();

	//...
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.objectgraph.containerelement;

public class Part {

	@NotNull
	private String name;

	//...
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter02.objectgraph.containerelement;

public class Manufacturer {

	@NotNull
	private String name;

	//...
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>当校验 <a href="#example-cascaded-validation-list">Example 22, &#8220;容器级联验证&#8221;</a> 中的 <code>Car</code> 类的实例时 , 以下情况 <code>ConstraintViolation</code> 将被创建：</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p>如果 passengers列表 中的任何 <code>Person</code> 对象的name字段为 <code>null</code> ;</p>
                                </li>
                                <li>
                                    <p>如果 map keys 中的 <code>Part</code> 对象具有 <code>null</code> 的 name字段;</p>
                                </li>
                                <li>
                                    <p>如果 map values 中的 <code>Manufacturer</code> 对象具有 <code>null</code> 的 name字段;</p>
                                </li>
                            </ul>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>在6之前的版本中，Hibernate Validator 支持对容器元素子集进行级联验证，并且在容器级别实现(例如，您可以使用 <code>@Valid private List&lt;Person&gt;</code> 对 <code>Person</code> 对象启用级联验证).</p>
                                        </div>
                                        <div class="paragraph">
                                            <p>这仍然受到支持，但不建议这样做。请使用容器元素级别 <code>@Valid</code> 注解，因为它更具表达性。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-validating-bean-constraints">
                        <a class="anchor" href="#section-validating-bean-constraints"></a>2.2. 验证 bean 约束</h3>
                    <div class="paragraph">
                        <p><code>Validator</code> 接口是 Jakarta Bean Validation中最重要的对象。下一节将展示如何获取 <code>Validator</code> 实例。之后，您将学习如何使用 <code>Validator</code> 接口定义的不同方法。</p>
                    </div>
                    <div class="sect3">
                        <h4 id="section-obtaining-validator">
                            <a class="anchor" href="#section-obtaining-validator"></a>2.2.1. 获取 <code>Validator</code> 实例</h4>
                        <div class="paragraph">
                            <p>校验实例的第一步是获得 <code>Validator</code> 实例。为获取这个实例的需要通过 <code>Validation</code> 类和 <code>ValidatorFactory</code> 。最简单的方法是使用静态方法 <code>Validation # builddefaultvalidatorfactory()</code> :</p>
                        </div>
                        <div class="exampleblock">
                            <div class="title">Example 23. <code>Validation#buildDefaultValidatorFactory()</code></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
validator = factory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>这将在默认配置中引导验证程序。请参阅 <a href="#chapter-bootstrapping">Chapter 9, <em>Bootstrapping</em></a> 以了解更多关于不同的 Bootstrapping 方法以及如何获得特定配置的 <code>Validator</code> 实例。</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_validator_方法">
                            <a class="anchor" href="#_validator_方法"></a>2.2.2. Validator 方法</h4>
                        <div class="paragraph">
                            <p><code>Validator</code> 接口包含三个方法，可用于验证整个实体或仅验证实体的单个属性。</p>
                        </div>
                        <div class="paragraph">
                            <p>这三个方法都返回一个 <code>Set&lt;ConstraintViolation&gt;</code>。如果验证成功，集合是空的。否则，将为每个违反的约束添加一个 <code>ConstraintViolation</code> 实例。</p>
                        </div>
                        <div class="paragraph">
                            <p>所有的验证方法都有一个 var-args 参数，可以用来指定在执行验证时应该考虑哪些验证组。如果未指定参数，则默认验证组( <code>jakarta.validation.groups.Default</code>) . 将在 <a href="#chapter-groups">Chapter 5, <em>分组约束</em></a> 中详细讨论 .</p>
                        </div>
                        <div class="sect4">
                            <h5 id="_validatorvalidate">
                                <a class="anchor" href="#_validatorvalidate"></a>2.2.2.1. <code>Validator#validate()</code></h5>
                            <div class="paragraph">
                                <p>使用 <code>validate()</code> 方法对给定 bean 的所有约束执行校验。
                                    <a href="#example-validator-validate">Example 24, &#8220;使用 <code>Validator#validate()</code>&#8221;</a> 中的 <code>Car</code> 类来自
                                    <a href="#example-property-level">Example 12, &#8220;属性级约束&#8221;</a> 该实例未能满足 <code>manufacturer</code> 字段上的 <code>@NotNull</code> 约束。因此，validation 调用返回一个 <code>ConstraintViolation</code> 对象。</p>
                            </div>
                            <div id="example-validator-validate" class="exampleblock">
                                <div class="title">Example 24. 使用 <code>Validator#validate()</code></div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car car = new Car( null, true );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );
assertEquals( "must not be null", constraintViolations.iterator().next().getMessage() );</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_validatorvalidateproperty">
                                <a class="anchor" href="#_validatorvalidateproperty"></a>2.2.2.2. <code>Validator#validateProperty()</code></h5>
                            <div class="paragraph">
                                <p>借助 <code>validateProperty()</code> 您可以校验给定对象的单个命名属性。</p>
                            </div>
                            <div class="exampleblock">
                                <div class="title">Example 25. 使用 <code>Validator#validateProperty()</code></div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car car = new Car( null, true );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validateProperty(
		car,
		"manufacturer"
);

assertEquals( 1, constraintViolations.size() );
assertEquals( "must not be null", constraintViolations.iterator().next().getMessage() );</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_validatorvalidatevalue">
                                <a class="anchor" href="#_validatorvalidatevalue"></a>2.2.2.3. <code>Validator#validateValue()</code></h5>
                            <div class="paragraph">
                                <p>通过使用 <code>validateValue()</code> 方法，您可以检查给定类的单个属性是否可以成功验证，如果该属性具有指定的值:</p>
                            </div>
                            <div class="exampleblock">
                                <div class="title">Example 26. 使用 <code>Validator#validateValue()</code></div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validateValue(
		Car.class,
		"manufacturer",
		null
);

assertEquals( 1, constraintViolations.size() );
assertEquals( "must not be null", constraintViolations.iterator().next().getMessage() );</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="admonitionblock note">
                                <table>
                                    <tr>
                                        <td class="icon">
                                            <div class="title">Note</div>
                                        </td>
                                        <td class="content">
                                            <div class="paragraph">
                                                <p><code>@Valid</code> 不在 <code>validateProperty()</code> 或 <code>validateValue()</code> 方法里生效。</p>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="paragraph">
                                <p>例如，<code>Validator#validateProperty()</code> 用于将 Jakarta Bean Validation 集成到 JSF 2中(see <a href="#section-presentation-layer">Section 11.2, &#8220;JSF &amp; Seam&#8221;</a>) ，以便对输入到表单中的值执行验证，然后将它们传播到模型中。</p>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-constraint-violation-methods">
                            <a class="anchor" href="#section-constraint-violation-methods"></a>2.2.3. <code>ConstraintViolation</code></h4>
                        <div class="sect4">
                            <h5 id="_constraintviolation_的方法">
                                <a class="anchor" href="#_constraintviolation_的方法"></a>2.2.3.1. <code>ConstraintViolation</code> 的方法</h5>
                            <div class="paragraph">
                                <p>现在是时候仔细研究一下什么是 <code>ConstraintViolation</code> 了。使用 <code>ConstraintViolation</code> 中不同的方法可以确定校验失败原因的许多有用信息。以下是这些方法的概述。 列下的值引用了 <a href="#example-validator-validate">Example 24, &#8220;使用 <code>Validator#validate()</code>&#8221;</a>.</p>
                            </div>
                            <div class="dlist">
                                <dl>
                                    <dt class="hdlist1"><code>getMessage()</code></dt>
                                    <dd>
                                        <p>The interpolated error message</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Example</dt>
                                                <dd>
                                                    <p>"must not be null"</p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>getMessageTemplate()</code></dt>
                                    <dd>
                                        <p>The non-interpolated error message</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Example</dt>
                                                <dd>
                                                    <p>"{&#8230;&#8203; NotNull.message}"</p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>getRootBean()</code></dt>
                                    <dd>
                                        <p>The root bean being validated</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Example</dt>
                                                <dd>
                                                    <p>car</p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>getRootBeanClass()</code></dt>
                                    <dd>
                                        <p>The class of the root bean being validated</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Example</dt>
                                                <dd>
                                                    <p><code>Car.class</code></p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>getLeafBean()</code></dt>
                                    <dd>
                                        <p>If a bean constraint, the bean instance the constraint is applied on; if a property constraint, the bean instance hosting the property the constraint is applied on</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Example</dt>
                                                <dd>
                                                    <p><code>car</code></p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>getPropertyPath()</code></dt>
                                    <dd>
                                        <p>The property path to the validated value from root bean</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Example</dt>
                                                <dd>
                                                    <p>contains one node with kind <code>PROPERTY</code> and name "manufacturer"</p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>getInvalidValue()</code></dt>
                                    <dd>
                                        <p>The value failing to pass the constraint</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Example</dt>
                                                <dd>
                                                    <p><code>null</code></p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>getConstraintDescriptor()</code></dt>
                                    <dd>
                                        <p>Constraint metadata reported to fail</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Example</dt>
                                                <dd>
                                                    <p>descriptor for <code>@NotNull</code></p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                </dl>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_利用_property_path">
                                <a class="anchor" href="#_利用_property_path"></a>2.2.3.2. 利用 property path</h5>
                            <div class="paragraph">
                                <p>要确定触发冲突的原因，需要利用 <code>getPropertyPath()</code> 方法的结果。</p>
                            </div>
                            <div class="paragraph">
                                <p>返回的 <code>Path</code> 由描述元素路径的 <code>Node</code>s 组成</p>
                            </div>
                            <div class="paragraph">
                                <p>关于 <code>Path</code> 的结构和各种类型的 <code>Node</code>s 的更多信息可以在 Jakarta Bean Validation specification 中的 <code>ConstraintViolation</code> 章节找到.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-builtin-constraints">
                        <a class="anchor" href="#section-builtin-constraints"></a>2.3. 内置约束</h3>
                    <div class="paragraph">
                        <p>Hibernate Validator 包含一组常用的约束。这些都是 Jakarta Bean Validation 规范定义 (see <a href="#validator-defineconstraints-spec">Section 2.3.1, &#8220;Jakarta Bean Validation 约束&#8221;</a>)。 此外，Hibernate Validator 还提供了有用的自定义约束 (see
                            <a href="#validator-defineconstraints-hv-constraints">Section 2.3.2, &#8220;附加约束&#8221;</a>)。</p>
                    </div>
                    <div class="sect3">
                        <h4 id="validator-defineconstraints-spec">
                            <a class="anchor" href="#validator-defineconstraints-spec"></a>2.3.1. Jakarta Bean Validation 约束</h4>
                        <div class="paragraph">
                            <p>下面是 Jakarta Bean Validation API 中指定的所有约束的列表。 所有这些约束都适用于字段/属性级别，在 Jakarta Bean 验证规范中没有定义类级别约束。如果您使用 Hibernate 对象关系映射器，那么在为您的模型创建 DDL 时会考虑到一些约束 (see "Hibernate metadata impact").</p>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>Hibernate Validator 允许将一些约束应用于更多的数据类型，而不是 Jakarta Bean Validation 规范所要求的数据类型 (e.g. <code>@Max</code> 可以应用于字符串)。依赖此特性可能会影响应用程序在 Jakarta Bean Validation 提供程序之间的可移植性。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="dlist">
                            <dl>
                                <dt class="hdlist1"><code>@AssertFalse</code></dt>
                                <dd>
                                    <p>检查带注解的元素是否为false</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>Boolean</code>, <code>boolean</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@AssertTrue</code></dt>
                                <dd>
                                    <p>检查带注解的元素是否为true</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>Boolean</code>, <code>boolean</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@DecimalMax(value=, inclusive=)</code></dt>
                                <dd>
                                    <p>当 <code>inclusive</code> = false 时，检查带注解的值是否小于指定的最大值。否则，该值是否小于或等于指定的最大值。参数值是根据 <code>BigDecimal</code> 字符串表示形式的值。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>BigDecimal</code>, <code>BigInteger</code>, <code>CharSequence</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> 以及各自的基本类型包装器; Hibernate Validator还支持 <a href="https://jcp.org/en/jsr/detail?id=354">JSR 354 API</a>                                                    中的 <code>Number</code> 和 <code>javax.money.MonetaryAmount</code> 的实现。</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@DecimalMin(value=, inclusive=)</code></dt>
                                <dd>
                                    <p>当 <code>inclusive</code> = false 时，检查带注解的值是否大于指定的最小值。否则，该值是否大于或等于指定的最小值。参数值是根据 <code>BigDecimal</code> 字符串表示形式的值。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>BigDecimal</code>, <code>BigInteger</code>, <code>CharSequence</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> 以及各自的基本类型包装器; Hibernate Validator还支持 <a href="https://jcp.org/en/jsr/detail?id=354">JSR 354 API</a>                                                    中的 <code>Number</code> 和 <code>javax.money.MonetaryAmount</code> 的实现。</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Digits(integer=, fraction=)</code></dt>
                                <dd>
                                    <p>检查被注解的值是否最多有 <code>integer</code> 位整数和 <code>fraction</code> 位小数</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p>BigDecimal, <code>BigInteger</code>, <code>CharSequence</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> a以及各自的基本类型包装器; Hibernate Validator还支持 <a href="https://jcp.org/en/jsr/detail?id=354">JSR 354 API</a>                                                    中的 <code>Number</code> 和 <code>javax.money.MonetaryAmount</code> 的实现。</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>Defines column precision and scale</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Email</code></dt>
                                <dd>
                                    <p>检查指定的字符序列是否为有效的电子邮件地址。可选参数 regexp 和标志允许指定电子邮件必须匹配的附加正则表达式(包括正则表达式标志)。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Future</code></dt>
                                <dd>
                                    <p>检查注解的日期是否在将来</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>java.util.Date</code>, <code>java.util.Calendar</code>, <code>java.time.Instant</code>, <code>java.time.LocalDate</code>, <code>java.time.LocalDateTime</code>, <code>java.time.LocalTime</code>, <code>java.time.MonthDay</code>,
                                                    <code>java.time.OffsetDateTime</code>, <code>java.time.OffsetTime</code>, <code>java.time.Year</code>, <code>java.time.YearMonth</code>, <code>java.time.ZonedDateTime</code>, <code>java.time.chrono.HijrahDate</code>,
                                                    <code>java.time.chrono.JapaneseDate</code>, <code>java.time.chrono.MinguoDate</code>, <code>java.time.chrono.ThaiBuddhistDate</code>; Hibernate Validator还支持 <a href="http://www.joda.org/joda-time/">Joda Time</a>                                                    中的 <code>ReadablePartial</code> 和 <code>ReadableInstant</code> 实现</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@FutureOrPresent</code></dt>
                                <dd>
                                    <p>检查注解的日期是现在或者将来</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>java.util.Date</code>, <code>java.util.Calendar</code>, <code>java.time.Instant</code>, <code>java.time.LocalDate</code>, <code>java.time.LocalDateTime</code>, <code>java.time.LocalTime</code>, <code>java.time.MonthDay</code>,
                                                    <code>java.time.OffsetDateTime</code>, <code>java.time.OffsetTime</code>, <code>java.time.Year</code>, <code>java.time.YearMonth</code>, <code>java.time.ZonedDateTime</code>, <code>java.time.chrono.HijrahDate</code>,
                                                    <code>java.time.chrono.JapaneseDate</code>, <code>java.time.chrono.MinguoDate</code>, <code>java.time.chrono.ThaiBuddhistDate</code>; Hibernate Validator还支持 <a href="http://www.joda.org/joda-time/">Joda Time</a>                                                    中的 <code>ReadablePartial</code> 和 <code>ReadableInstant</code> 实现</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Max(value=)</code></dt>
                                <dd>
                                    <p>检查注解的值是否小于或等于指定的最大值</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>BigDecimal</code>, <code>BigInteger</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> and the respective wrappers of the primitive types; Hibernate Validator还支持 <code>CharSequence</code>                                                    的子类 (字符序列表示的数值被求值),以及 <code>Number</code> 和 <code>javax.money.MonetaryAmount</code> 的子类。</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>Adds a check constraint on the column</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Min(value=)</code></dt>
                                <dd>
                                    <p>检查注解的值是否高于或等于指定的最小值</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>BigDecimal</code>, <code>BigInteger</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> and the respective wrappers of the primitive types; Hibernate Validator还支持 <code>CharSequence</code>                                                    的子类 (字符序列表示的数值被求值),以及 <code>Number</code> 和 <code>javax.money.MonetaryAmount</code> 的子类。</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>Adds a check constraint on the column</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@NotBlank</code></dt>
                                <dd>
                                    <p>检查带注解的字符序列是否为空，去除首尾的空格后的长度是否大于0。 与 <code>@NotEmpty</code> 的不同之处在于，这个约束只能应用于字符序列，并且尾随的空格被忽略。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@NotEmpty</code></dt>
                                <dd>
                                    <p>检查带注解的元素是否为 <code>null</code> 或 ""</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code>, <code>Collection</code>, <code>Map</code> and arrays</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@NotNull</code></dt>
                                <dd>
                                    <p>检查注解的值是否为 <code>null</code></p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p>Any type</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>Column(s) are not nullable</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Negative</code></dt>
                                <dd>
                                    <p>检查元素是否严格为负。零值无效。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>BigDecimal</code>, <code>BigInteger</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> 和各自的基本类型包装器;Hibernate Validator还支持 <code>CharSequence</code> 的子类 (字符序列表示的数值被求值),以及
                                                    <code>Number</code> 和 <code>javax.money.MonetaryAmount</code> 的子类。</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@NegativeOrZero</code></dt>
                                <dd>
                                    <p>检查元素是否为负数或零。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>BigDecimal</code>, <code>BigInteger</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> 和各自的基本类型包装器;Hibernate Validator还支持 <code>CharSequence</code> 的子类 (字符序列表示的数值被求值),以及
                                                    <code>Number</code> 和 <code>javax.money.MonetaryAmount</code> 的子类。</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Null</code></dt>
                                <dd>
                                    <p>检查注解的值是否为 <code>null</code></p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p>Any type</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Past</code></dt>
                                <dd>
                                    <p>检查注解的日期是否在过去</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>java.util.Date</code>,<code>java.util.Calendar</code>, <code>java.time.Instant</code>, <code>java.time.LocalDate</code>, <code>java.time.LocalDateTime</code>, <code>java.time.LocalTime</code>, <code>java.time.MonthDay</code>,
                                                    <code>java.time.OffsetDateTime</code>, <code>java.time.OffsetTime</code>, <code>java.time.Year</code>, <code>java.time.YearMonth</code>, <code>java.time.ZonedDateTime</code>, <code>java.time.chrono.HijrahDate</code>,
                                                    <code>java.time.chrono.JapaneseDate</code>, <code>java.time.chrono.MinguoDate</code>, <code>java.time.chrono.ThaiBuddhistDate</code>; Hibernate Validator还支持 <a href="http://www.joda.org/joda-time/">Joda Time</a>                                                    中的 <code>ReadablePartial</code> 和 <code>ReadableInstant</code> 实现</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@PastOrPresent</code></dt>
                                <dd>
                                    <p>检查注解的日期是过去或者现在</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>java.util.Date</code>,<code>java.util.Calendar</code>, <code>java.time.Instant</code>, <code>java.time.LocalDate</code>, <code>java.time.LocalDateTime</code>, <code>java.time.LocalTime</code>, <code>java.time.MonthDay</code>,
                                                    <code>java.time.OffsetDateTime</code>, <code>java.time.OffsetTime</code>, <code>java.time.Year</code>, <code>java.time.YearMonth</code>, <code>java.time.ZonedDateTime</code>, <code>java.time.chrono.HijrahDate</code>,
                                                    <code>java.time.chrono.JapaneseDate</code>, <code>java.time.chrono.MinguoDate</code>, <code>java.time.chrono.ThaiBuddhistDate</code>; Hibernate Validator还支持 <a href="http://www.joda.org/joda-time/">Joda Time</a>                                                    中的 <code>ReadablePartial</code> 和 <code>ReadableInstant</code> 实现</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Pattern(regex=, flags=)</code></dt>
                                <dd>
                                    <p>考虑给定的标志匹配，检查带注解的字符串是否与正则表达式 <code>regex</code> 匹配</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Positive</code></dt>
                                <dd>
                                    <p>检查元素是否为严格正数。零值无效。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>BigDecimal</code>, <code>BigInteger</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> 和各自的基本类型包装器;Hibernate Validator还支持 <code>CharSequence</code> 的子类 (字符序列表示的数值被求值),以及
                                                    <code>Number</code> 和 <code>javax.money.MonetaryAmount</code> 的子类。</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@PositiveOrZero</code></dt>
                                <dd>
                                    <p>检查元素是正数或者零。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>BigDecimal</code>, <code>BigInteger</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> 和各自的基本类型包装器;Hibernate Validator还支持 <code>CharSequence</code> 的子类 (字符序列表示的数值被求值),以及
                                                    <code>Number</code> 和 <code>javax.money.MonetaryAmount</code> 的子类。</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Size(min=, max=)</code></dt>
                                <dd>
                                    <p>检查带注解的元素的大小是否介于最小和最大(包括)之间</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code>, <code>Collection</code>, <code>Map</code> and arrays</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>Column length will be set to <code>max</code></p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                            </dl>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>在上面列出的参数之上，每个约束都有参数消息、组和有效负载。这是 Jakarta Bean Validation 规范的一个要求。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="validator-defineconstraints-hv-constraints">
                            <a class="anchor" href="#validator-defineconstraints-hv-constraints"></a>2.3.2. 附加约束</h4>
                        <div class="paragraph">
                            <p>除了 Jakarta Bean Validation API 定义的约束之外，Hibernate Validator 还提供了下面列出的几个有用的自定义约束。除了一个 <code>@ScriptAssert</code> 例外可以用于类级别的约束，这些约束只适用于字段/属性级别。</p>
                        </div>
                        <div class="dlist">
                            <dl>
                                <dt class="hdlist1"><code>@CreditCardNumber(ignoreNonDigitCharacters=)</code></dt>
                                <dd>
                                    <p>检查带注解的字符序列是否通过 Luhn 校验和测试。注意，此验证旨在检查用户错误，而不是信用卡的有效性！参见 <a href="http://www.dirigodev.com/blog/ecommerce/anatomy-of-a-credit-card-number/">Anatomy of a credit card number</a>. <code>ignoreNonDigitCharacters</code> 允许忽略非数字字符。默认值为
                                        <code>false</code>。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Currency(value=)</code></dt>
                                <dd>
                                    <p>检查带注解的 <code>javax.money.MonetaryAmount</code> 的货币单位是否是指定货币单位的一部分。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>javax.money.MonetaryAmount</code> <a href="https://jcp.org/en/jsr/detail?id=354">JSR 354 API</a> 的实现类</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@DurationMax(days=, hours=, minutes=, seconds=, millis=, nanos=, inclusive=)</code></dt>
                                <dd>
                                    <p>注解了 <code>java.time.Duration</code> 元素不大于由注解参数构造的元素。如果将 <code>inclusive</code> 标志设置为 <code>true</code>，则允许相等。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>java.time.Duration</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@DurationMin(days=, hours=, minutes=, seconds=, millis=, nanos=, inclusive=)</code></dt>
                                <dd>
                                    <p>注解了 <code>java.time.Duration</code> 元素不小于由注解参数构造的元素。如果将 <code>inclusive</code> 标志设置为 <code>true</code>，则允许相等。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>java.time.Duration</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@EAN</code></dt>
                                <dd>
                                    <p>检查带注解的字符序列是否为有效的 <a href="http://en.wikipedia.org/wiki/International_Article_Number_%28EAN%29">EAN</a> 条形码。类型决定了条形码的类型。默认值是 EAN-13。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@ISBN</code></dt>
                                <dd>
                                    <p>检查带注解的字符序列是否为有效的 <a href="https://en.wikipedia.org/wiki/International_Standard_Book_Number">ISBN</a> 条形码。类型决定了条形码的类型。默认值是 ISBN-13。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Length(min=, max=)</code></dt>
                                <dd>
                                    <p>验证带注解的字符序列长度是否在 <code>min</code> 和 <code>max</code> 之间</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>Column length will be set to max</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@CodePointLength(min=, max=, normalizationStrategy=)</code></dt>
                                <dd>
                                    <p>验证带注解的字符序列的代码点长度是否在最小值和最大值之间。如果设置了 <code>normalizationStrategy</code> ，则验证规范化值。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@LuhnCheck(startIndex= , endIndex=, checkDigitIndex=, ignoreNonDigitCharacters=)</code></dt>
                                <dd>
                                    <p>检查带注解的字符序列中的数字是否通过 Luhn 校验和算法 (see also <a href="http://en.wikipedia.org/wiki/Luhn_algorithm">Luhn algorithm</a>). <code>startIndex</code> 和 <code>endIndex</code> 只允许在指定的子字符串上运行算法。 <code>checkDigitIndex</code> 允许使用字符序列中的任意数字作为校验数字。如果未指定，则假定检查数字是指定范围的一部分。最后但并非最不重要的是，<code>ignoreNonDigitCharacters</code>                                        允许忽略非数字字符。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Mod10Check(multiplier=, weight=, startIndex=, endIndex=, checkDigitIndex=, ignoreNonDigitCharacters=)</code></dt>
                                <dd>
                                    <p>检查带注解的字符序列中的数字是否通过了通用的 mod 10校验和算法。 <code>multiplier</code> 决定奇数的乘数(缺省为3) ，加权为偶数(缺省为1)。 <code>startIndex</code> 和 <code>endIndex</code> 只允许在指定的子字符串上运行算法。 <code>checkDigitIndex</code> 允许使用字符序列中的任意数字作为校验数字。如果未指定，则假定检查数字是指定范围的一部分。最后但并非最不重要的是，<code>ignoreNonDigitCharacters</code>                                        允许忽略非数字字符。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Mod11Check(threshold=, startIndex=, endIndex=, checkDigitIndex=, ignoreNonDigitCharacters=, treatCheck10As=, treatCheck11As=)</code></dt>
                                <dd>
                                    <p>C检查带注解的字符序列中的数字是否通过 mod 11校验和算法。 <code>threshold`指定 mod11乘数增长的阈值; 如果没有指定值，乘数将无限增长。 `treatCheck10As</code> 和 <code>treatCheck11As</code> 分别指定当 mod 11校验和等于10或11时使用的校验数字。默认值分别为 x 和0。 <code>startIndex</code>, <code>endIndex</code>                                        <code>checkDigitIndex</code> and <code>ignoreNonDigitCharacters</code> 的语义与 `@Mod10Check`中的相同。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Normalized(form=)</code></dt>
                                <dd>
                                    <p>验证注解的字符序列是否根据给定的 <code>form</code> 进行了规范化。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@Range(min=, max=)</code></dt>
                                <dd>
                                    <p>检查注解值是否位于指定的最小值和最大值之间</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>BigDecimal</code>, <code>BigInteger</code>, <code>CharSequence</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code> 以及基元类型的相应包装器</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@ScriptAssert(lang=, script=, alias=, reportOn=)</code></dt>
                                <dd>
                                    <p>检查是否可以根据带注解的元素成功地计算给定的脚本。为了使用这个约束，JSR 223(“ Java <sup>TM</sup> 平台的脚本编程”)定义的 Java 脚本 API 的实现必须是类路径的一部分。要求值的表达式可以使用任何脚本或表达式语言编写，在类路径中可以找到与 JSR 223兼容的引擎。即使这是一个类级别的约束，也可以使用 <code>reportOn</code> 属性报告特定属性(而不是整个对象)上的约束冲突。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p>Any type</p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@UniqueElements</code></dt>
                                <dd>
                                    <p>检查带注解的集合是否只包含唯一元素。相等是使用 <code>equals()</code> 方法确定的。默认消息不包含重复元素的列表，但是可以通过重写消息并使用{ <code>duplicates</code> }消息参数来包含它。重复元素列表也包含在约束违反的动态有效负载中。</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>Collection</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                                <dt class="hdlist1"><code>@URL(protocol=, host=, port=, regexp=, flags=)</code></dt>
                                <dd>
                                    <p>根据 RFC2396检查带注解的字符序列是否为有效的 URL。如果指定了任何可选参数 <code>protocol</code>, <code>host</code> or <code>port</code> ，则相应的 URL 片段必须匹配指定的值。可选参数 <code>regexp</code> 和 <code>flags</code> 允许指定 URL 必须匹配的附加正则表达式(包括正则表达式标志)。根据默认情况，此约束使用
                                        <code>java. net. URL</code> 构造函数验证给定字符串是否表示有效 URL。还有一个基于正则表达式的版本—— <code>RegexpURLValidator</code> ——可以通过 XML ( see <a href="#section-mapping-xml-constraints">Section 8.2, &#8220;Mapping constraints via <code>constraint-mappings</code>&#8221;</a>)
                                        或 (see <a href="#section-programmatic-constraint-definition">Section 12.15.2, &#8220;Adding constraint definitions programmatically&#8221;</a>).</p>
                                    <div class="dlist">
                                        <dl>
                                            <dt class="hdlist1">Supported data types</dt>
                                            <dd>
                                                <p><code>CharSequence</code></p>
                                            </dd>
                                            <dt class="hdlist1">Hibernate metadata impact</dt>
                                            <dd>
                                                <p>None</p>
                                            </dd>
                                        </dl>
                                    </div>
                                </dd>
                            </dl>
                        </div>
                        <div class="sect4">
                            <h5 id="_特殊国家约束">
                                <a class="anchor" href="#_特殊国家约束"></a>2.3.2.1. 特殊国家约束</h5>
                            <div class="paragraph">
                                <p>Hibernate Validator 还提供了一些国家特有的约束，例如用于验证社会安全号码。</p>
                            </div>
                            <div class="admonitionblock note">
                                <table>
                                    <tr>
                                        <td class="icon">
                                            <div class="title">Note</div>
                                        </td>
                                        <td class="content">
                                            <div class="paragraph">
                                                <p>如果您必须实现一个国家特定的约束，可以考虑将其作为 Hibernate Validator 的一个贡献！</p>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="dlist">
                                <dl>
                                    <dt class="hdlist1"><code>@CNPJ</code></dt>
                                    <dd>
                                        <p>检查带注解的字符序列是否代表巴西公司纳税人注册号(Cadastro de Pessoa Jurídica)</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Supported data types</dt>
                                                <dd>
                                                    <p><code>CharSequence</code></p>
                                                </dd>
                                                <dt class="hdlist1">Hibernate metadata impact</dt>
                                                <dd>
                                                    <p>None</p>
                                                </dd>
                                                <dt class="hdlist1">Country</dt>
                                                <dd>
                                                    <p>Brazil</p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>@CPF</code></dt>
                                    <dd>
                                        <p>检查带注解的字符序列是否代表巴西个人纳税人登记号(Cadastro de Pessoa Física)</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Supported data types</dt>
                                                <dd>
                                                    <p><code>CharSequence</code></p>
                                                </dd>
                                                <dt class="hdlist1">Hibernate metadata impact</dt>
                                                <dd>
                                                    <p>None</p>
                                                </dd>
                                                <dt class="hdlist1">Country</dt>
                                                <dd>
                                                    <p>Brazil</p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>@TituloEleitoral</code></dt>
                                    <dd>
                                        <p>检查带注解的字符序列是否代表巴西选民身份证号码 (<a href="http://www.exceldoseujeito.com.br/2008/12/19/validar-cpf-cnpj-e-titulo-de-eleitor-parte-ii/">Título Eleitoral</a>)</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Supported data types</dt>
                                                <dd>
                                                    <p><code>CharSequence</code></p>
                                                </dd>
                                                <dt class="hdlist1">Hibernate metadata impact</dt>
                                                <dd>
                                                    <p>None</p>
                                                </dd>
                                                <dt class="hdlist1">Country</dt>
                                                <dd>
                                                    <p>Brazil</p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>@NIP</code></dt>
                                    <dd>
                                        <p>检查带注解的字符序列是否表示波兰 VAT 标识号 (<a href="https://pl.wikipedia.org/wiki/NIP">NIP</a>)</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Supported data types</dt>
                                                <dd>
                                                    <p><code>CharSequence</code></p>
                                                </dd>
                                                <dt class="hdlist1">Hibernate metadata impact</dt>
                                                <dd>
                                                    <p>None</p>
                                                </dd>
                                                <dt class="hdlist1">Country</dt>
                                                <dd>
                                                    <p>Poland</p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>@PESEL</code></dt>
                                    <dd>
                                        <p>检查带注解的字符序列是否表示波兰国家标识号 (<a href="https://pl.wikipedia.org/wiki/PESEL">PESEL</a>)</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Supported data types</dt>
                                                <dd>
                                                    <p><code>CharSequence</code></p>
                                                </dd>
                                                <dt class="hdlist1">Hibernate metadata impact</dt>
                                                <dd>
                                                    <p>None</p>
                                                </dd>
                                                <dt class="hdlist1">Country</dt>
                                                <dd>
                                                    <p>Poland</p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>@REGON</code></dt>
                                    <dd>
                                        <p>检查带注解的字符序列是否表示波兰纳税人识别号 (<a href="https://pl.wikipedia.org/wiki/REGON">REGON</a>). 。可同时应用于9位和14位数字版本的 REGON</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Supported data types</dt>
                                                <dd>
                                                    <p><code>CharSequence</code></p>
                                                </dd>
                                                <dt class="hdlist1">Hibernate metadata impact</dt>
                                                <dd>
                                                    <p>None</p>
                                                </dd>
                                                <dt class="hdlist1">Country</dt>
                                                <dd>
                                                    <p>Poland</p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                    <dt class="hdlist1"><code>@INN</code></dt>
                                    <dd>
                                        <p>检查带注解的字符序列是否表示一个俄罗斯纳税人识别号 (<a href="https://ru.wikipedia.org/wiki/%D0%98%D0%B4%D0%B5%D0%BD%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D1%8B%D0%B9_%D0%BD%D0%BE%D0%BC%D0%B5%D1%80_%D0%BD%D0%B0%D0%BB%D0%BE%D0%B3%D0%BE%D0%BF%D0%BB%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D1%89%D0%B8%D0%BA%D0%B0">INN</a>).
                                            可以适用于国际旅馆的个人和法律版本</p>
                                        <div class="dlist">
                                            <dl>
                                                <dt class="hdlist1">Supported data types</dt>
                                                <dd>
                                                    <p><code>CharSequence</code></p>
                                                </dd>
                                                <dt class="hdlist1">Hibernate metadata impact</dt>
                                                <dd>
                                                    <p>None</p>
                                                </dd>
                                                <dt class="hdlist1">Country</dt>
                                                <dd>
                                                    <p>Russia</p>
                                                </dd>
                                            </dl>
                                        </div>
                                    </dd>
                                </dl>
                            </div>
                            <div class="admonitionblock tip">
                                <table>
                                    <tr>
                                        <td class="icon">
                                            <div class="title">Tip</div>
                                        </td>
                                        <td class="content">
                                            <div class="paragraph">
                                                <p>在某些情况下，Jakarta Bean Validation 约束和 Hibernate Validator提供的自定义约束都不能满足您的需求。在这种情况下，您可以很容易地编写自己的约束。你可以 <a href="#validator-customconstraints">Chapter 6, <em>自定义约束</em></a> 中找到更多信息。</p>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="chapter-method-constraints">
                <a class="anchor" href="#chapter-method-constraints"></a>3. 声明和校验 method 约束</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>从 Bean Validation 1.1 开始，约束不仅应用于 JavaBeans 中的变量及其 Getter 方法 ,还可以应用于 Java 方法的返回值和构造函数的参数。同样也是使用 Jakarta Bean Validation 约束来指定。</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p>在调用方法或构造函数之前（对可执行方法的输入参数施加约束），可以保证调用者必须满足的前提条件</p>
                        </li>
                        <li>
                            <p>在方法或构造函数调用返回后（通过将约束应用于可执行方法的返回值），可以保证调用方可以保证的后置条件</p>
                        </li>
                    </ul>
                </div>
                <div class="admonitionblock note">
                    <table>
                        <tr>
                            <td class="icon">
                                <div class="title">Note</div>
                            </td>
                            <td class="content">
                                <div class="paragraph">
                                    <p>对于本参考指南，<em>method constraint(方法约束)</em> 既指方法约束，也指构造函数约束，如果没有另行说明的话。有时，在引用方法和构造函数时会使用术语 <em>executable(可执行方法)</em>。</p>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="paragraph">
                    <p>与传统的检查参数和返回值正确性的方法相比，这种方法有几个优点:</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p>检查不必手动执行(例如通过引发 <code>IllegalArgumentException</code> 或类似的异常) ，从而减少了需要编写和维护的代码</p>
                        </li>
                        <li>
                            <p>可执行方法的输入、返回约束不必在其文档中重新表示，因为约束注解将自动包含在生成的 JavaDoc 中。这样可以避免冗余，并减少实现和文档之间不一致的可能性</p>
                        </li>
                    </ul>
                </div>
                <div class="admonitionblock tip">
                    <table>
                        <tr>
                            <td class="icon">
                                <div class="title">Tip</div>
                            </td>
                            <td class="content">
                                <div class="paragraph">
                                    <p>为了使注解显示在被注解元素的 JavaDoc 中，注解类型本身必须使用元注解 @Documented 来注解。这是所有内置约束的情况，并且被认为是任何自定义约束的最佳实践。</p>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="paragraph">
                    <p>在本章剩下的部分中，您将学习如何声明输入参数和返回值约束，以及如何使用 <code>ExecutableValidator</code> API 校验它们。</p>
                </div>
                <div class="sect2">
                    <h3 id="section-declaring-method-constraints">
                        <a class="anchor" href="#section-declaring-method-constraints"></a>3.1. 声明方法约束</h3>
                    <div class="sect3">
                        <h4 id="_参数约束">
                            <a class="anchor" href="#_参数约束"></a>3.1.1. 参数约束</h4>
                        <div class="paragraph">
                            <p>您可以通过向方法或构造函数的输入参数添加约束注解来指定方法或构造函数的前置条件，如 <a href="#example-declaring-parameter-constraints">Example 27, &#8220;声明方法和构造函数参数约束&#8221;</a>.</p>
                        </div>
                        <div id="example-declaring-parameter-constraints" class="exampleblock">
                            <div class="title">Example 27. 声明方法和构造函数参数约束</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.parameter;

public class RentalStation {

	public RentalStation(@NotNull String name) {
		//...
	}

	public void rentCar(
			@NotNull Customer customer,
			@NotNull @Future Date startDate,
			@Min(1) int durationInDays) {
		//...
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>这里表示了以下先决条件:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>RentalCar</code> 构造函数中 <code>name</code> 字段不能为 <code>null</code></p>
                                </li>
                                <li>
                                    <p>当调用 <code>rentCar()</code> 方法时, <code>customer</code> 字段不能为 <code>null</code>, <code>startDate</code> 字段不能为 <code>null</code> 且为将来的时间， <code>durationInDays</code> 字段的最小值为1。</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>请注意，声明方法或构造函数约束本身并不会在调用可执行文件时自动导致它们的校验。相反，必须使用 <code>ExecutableValidator</code> API (see
                                <a href="#section-validating-executable-constraints">Section 3.2, &#8220;校验方法约束&#8221;</a>) 来执行校验，这通常使用方法拦截工具(如 AOP、代理对象等)来完成。</p>
                        </div>
                        <div class="paragraph">
                            <p>约束只能应用于实例方法，即不支持在静态方法上声明约束。根据您用于触发方法校验的拦截技术，可能会适用其他限制，例如，关于被支持作为拦截目标的方法的可见性。请参阅拦截技术的文档以查明是否存在任何此类限制。</p>
                        </div>
                        <div class="sect4">
                            <h5 id="_交叉参数约束">
                                <a class="anchor" href="#_交叉参数约束"></a>3.1.1.1. 交叉参数约束</h5>
                            <div class="paragraph">
                                <p>有时，一次校验不仅依赖于单个参数，而是依赖于方法或构造函数的多个甚至全部参数。这种需求可以通过交叉参数约束来实现。</p>
                            </div>
                            <div class="paragraph">
                                <p>交叉参数约束可视为等价于类级约束的方法校验。两者都可用于实现基于几个元素的校验需求。虽然类级别约束适用于 bean 的多个属性，但交叉参数约束适用于可执行方法的多个参数。</p>
                            </div>
                            <div class="paragraph">
                                <p>与单参数约束不同，交叉参数约束是在方法或构造函数上声明的，如 <a href="#example-using-cross-parameter-constraint">Example 28, &#8220;声明交叉参数约束&#8221;</a> 。这里使用了 <code>load()</code> 方法中声明的交叉参数约束 <code>@LuggageCountMatchesPassengerCount</code> ，以确保旅客的行李不超过两件。</p>
                            </div>
                            <div id="example-using-cross-parameter-constraint" class="exampleblock">
                                <div class="title">Example 28. 声明交叉参数约束</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.crossparameter;

public class Car {

	@LuggageCountMatchesPassengerCount(piecesOfLuggagePerPassenger = 2)
	public void load(List&lt;Person&gt; passengers, List&lt;PieceOfLuggage&gt; luggage) {
		//...
	}
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>正如您将在下一节中了解到的，返回值约束也是在方法级别声明的。为了区分跨参数约束和返回值约束，使用 <code>@supportedvalidationtarget</code> 注解在 <code>ConstraintValidator</code> 实现中配置约束目标。您可以在
                                    <a href="#section-cross-parameter-constraints">Section 6.3, &#8220;Cross-parameter constraints&#8221;</a> ，该节展示了如何实现自己的交叉参数约束。</p>
                            </div>
                            <div class="paragraph">
                                <p>在某些情况下，约束可以应用于可执行方法的参数(即它是一个交叉参数约束) ，也可以应用于返回值。例如，允许使用表达式或脚本语言指定校验规则的自定义约束。</p>
                            </div>
                            <div class="paragraph">
                                <p>这样的约束必须定义一个成员 <code>validationAppliesTo()</code> ，它可以在声明时用于指定约束目标。如<a href="#example-specifying-constraint-target">Example 29, &#8220;指定约束的目标&#8221;</a> 通过指定
                                    <code>validationAppliesTo = ConstraintTarget.PARAMETERS</code>, 将约束应用于可执行方法的输入参数校验，而 <code>ConstraintTarget.RETURN_VALUE</code> 用于将约束应用于可执行方法的返回值校验。</p>
                            </div>
                            <div id="example-specifying-constraint-target" class="exampleblock">
                                <div class="title">Example 29. 指定约束的目标</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.crossparameter.constrainttarget;

public class Garage {

	@ELAssert(expression = "...", validationAppliesTo = ConstraintTarget.PARAMETERS)
	public Car buildCar(List&lt;Part&gt; parts) {
		//...
		return null;
	}

	@ELAssert(expression = "...", validationAppliesTo = ConstraintTarget.RETURN_VALUE)
	public Car paintCar(int color) {
		//...
		return null;
	}
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>尽管这种约束适用于可执行方法的参数和返回值，但目标方法通常可以自动推断。就会出现下面几种情况，就对函数声明进行约束</p>
                            </div>
                            <div class="ulist">
                                <ul>
                                    <li>
                                        <p>带输入参数的无返回值函数 (将约束用于输入参数上)</p>
                                    </li>
                                    <li>
                                        <p>无输入但有返回值的函数 (将约束用于返回参数上)</p>
                                    </li>
                                    <li>
                                        <p>既不是方法也不是构造函数，而是字段、参数等(约束用于带注解的元素)</p>
                                    </li>
                                </ul>
                            </div>
                            <div class="paragraph">
                                <p>在这些情况下，您不必指定约束目标。如果它增加了源代码的可读性，仍然建议这样做。如果在无法自动确定约束目标的情况下未指定该约束目标，则会引发 <code>ConstraintDeclarationException</code>。</p>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_返回值约束">
                            <a class="anchor" href="#_返回值约束"></a>3.1.2. 返回值约束</h4>
                        <div class="paragraph">
                            <p>方法或构造函数的返回参数的校验也可以通过添加约束注解来声明，如<a href="#example-declaring-return-value-constraints">Example 30, &#8220;声明方法和构造函数返回值约束&#8221;</a>.</p>
                        </div>
                        <div id="example-declaring-return-value-constraints" class="exampleblock">
                            <div class="title">Example 30. 声明方法和构造函数返回值约束</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.returnvalue;

public class RentalStation {

	@ValidRentalStation
	public RentalStation() {
		//...
	}

	@NotNull
	@Size(min = 1)
	public List&lt;@NotNull Customer&gt; getCustomers() {
		//...
		return null;
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>列限制适用于 <code>RentalStation</code> 的约束:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p>创建 <code>RentalStation</code> 对象必须通过 <code>@ValidRentalStation</code> 校验</p>
                                </li>
                                <li>
                                    <p><code>getCustomers()</code> 返回值不能为 <code>null</code> ，并且必须至少包含元素</p>
                                </li>
                                <li>
                                    <p><code>getCustomers()</code> 不能为 <code>null</code> 对象</p>
                                </li>
                            </ul>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>正如您在上面的示例中看到的，方法返回值支持容器元素约束。方法参数也支持它们。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_级联校验">
                            <a class="anchor" href="#_级联校验"></a>3.1.3. 级联校验</h4>
                        <div class="paragraph">
                            <p>类似于 JavaBeans 属性的级联校验 (see
                                <a href="#section-object-graph-validation">Section 2.1.6, &#8220;对象图&#8221;</a>), <code>@Valid</code> 注解可用于标记可执行参数和级联校验的返回值。在校验带有 <code>@Valid</code> 注解的参数或返回值时，也会校验在参数或返回值对象上声明的约束。</p>
                        </div>
                        <div class="paragraph">
                            <p>在 <a href="#example-cascaded-executable-validation">Example 31, &#8220;级联校验标记输入参数和返回值&#8221;</a> 中, <code>Garage#checkCar()</code> 方法的输入参数 <code>car</code> 和构造函数 <code>Garage</code> 一样都会进行级联校验。</p>
                        </div>
                        <div id="example-cascaded-executable-validation" class="exampleblock">
                            <div class="title">Example 31. 级联校验标记输入参数和返回值</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.cascaded;

public class Garage {

	@NotNull
	private String name;

	@Valid
	public Garage(String name) {
		this.name = name;
	}

	public boolean checkCar(@Valid @NotNull Car car) {
		//...
		return false;
	}
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.cascaded;

public class Car {

	@NotNull
	private String manufacturer;

	@NotNull
	@Size(min = 2, max = 14)
	private String licensePlate;

	public Car(String manufacturer, String licencePlate) {
		this.manufacturer = manufacturer;
		this.licensePlate = licencePlate;
	}

	//getters and setters ...
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>在校验 <code>checkCar()</code> 方法的输入参数时, 还将计算传递的 <code>Car</code> 对象的属性上的约束。类似地，在校验 <code>Garage</code> 构造函数的返回值时，将检查 <code>Garage</code> 的 name 字段的 <code>@NotNull</code> 约束。</p>
                        </div>
                        <div class="paragraph">
                            <p>通常，级联校验对可执行方法的工作方式与上一章对 JavaBeans 属性的工作方式完全相同。</p>
                        </div>
                        <div class="paragraph">
                            <p>特别是，在级联校验过程中忽略 <code>null</code> (当然在构造函数返回值校验过程中不会发生这种情况) ，并且级联校验是递归执行的，例如，如果标记为级联校验的参数或返回值对象本身的属性标记为 <code>@Valid</code> ，那么在被引用元素上声明的约束也将得到校验。</p>
                        </div>
                        <div class="paragraph">
                            <p>与字段和属性一样，还可以对返回值和输入参数的容器元素(例如集合元素、映射或自定义容器)声明级联校验。</p>
                        </div>
                        <div class="paragraph">
                            <p>在这种情况下，将校验容器包含的每个元素。在
                                <a href="#example-cascaded-executable-validation-container-elements">Example 32, &#8220;标记为级联校验的方法参数的容器元素&#8221;</a> 中的 <code>checkCars()</code> 法的参数时, 将对列表里的每一个 <code>Car</code> 实例进行校验，并在校验失败的情况下创建 <code>ConstraintViolation</code>                                对象。</p>
                        </div>
                        <div id="example-cascaded-executable-validation-container-elements" class="exampleblock">
                            <div class="title">Example 32. 标记为级联校验的方法参数的容器元素</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.cascaded.containerelement;

public class Garage {

	public boolean checkCars(@NotNull List&lt;@Valid Car&gt; cars) {
		//...
		return false;
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-method-constraints-inheritance-hierarchies">
                            <a class="anchor" href="#section-method-constraints-inheritance-hierarchies"></a>3.1.4. 继承层次中的方法约束</h4>
                        <div class="paragraph">
                            <p>在继承层次结构中声明方法约束时，注意以下规则非常重要:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p>方法的调用方要满足的输入参数不能在子类的重写方法中加强</p>
                                </li>
                                <li>
                                    <p>保证给方法的调用方的输出参数不能在子类的重写方法中弱化</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>这些规则是由 <em>behavioral subtyping</em> 的概念驱动的，它要求在任何使用 <code>T</code> 类型的地方， 用 <code>T</code> 的 <em>subType(子类型)</em> <code>S</code> 替换 <code>T</code> 但是不会改变程序的行为。</p>
                        </div>
                        <div class="paragraph">
                            <p>举个例子，假设一个类调用一个静态方法返回 <code>T</code> ，如果该对象的运行时类型是 <code>S</code> ，而 <code>S</code> 加强了输入参数的校验，则客户端类可能无法满足这些前置条件，因为它们不知道这些前置条件。这一规则也被称为 <a href="http://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov
substitution principle</a>。</p>
                        </div>
                        <div class="paragraph">
                            <p>Jakarta Bean Validation 规范实现了第一个规则，它禁止对重写或实现在超类型(超类或接口)中声明的方法进行参数约束。例
                                <a href="#example-illegal-parameter-constraints">Example 33, &#8220;子类型中的非法方法参数约束&#8221;</a></p>
                        </div>
                        <div id="example-illegal-parameter-constraints" class="exampleblock">
                            <div class="title">Example 33. 子类型中的非法方法参数约束</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.parameter;

public interface Vehicle {

	void drive(@Max(75) int speedInMph);
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.parameter;

public class Car implements Vehicle {

	@Override
	public void drive(@Max(55) int speedInMph) {
		//...
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p><code>Car#drive()</code> 上面的 <code>@Max</code> 约束是非法的，因为此方法实现了接口方法
                                <code>Vehicle#drive()</code> 。注意，如果超类的方法本身没有声明任何参数约束，则也不允许重写方法上的参数约束。</p>
                        </div>
                        <div class="paragraph">
                            <p>此外，如果一个方法覆盖或实现了在几个并行超类型中声明的方法(例如，两个没有相互扩展的接口，或者一个类和一个没有被该类实现的接口) ，那么在任何涉及的类型中都不能为该方法指定参数约束。 <a href="#example-illegal-parameter-constraints-parallel-types">Example 34, &#8220;层次结构的并行类型中的非法方法参数约束&#8221;</a> 中的类型显示了对该规则的违反。 <code>RacingCar#drive()</code>                                重写了 <code>Vehicle#drive()</code> 和 <code>Car#drive()</code> 方法。 所以 <code>Vehicle#drive()</code> 是非法的。</p>
                        </div>
                        <div id="example-illegal-parameter-constraints-parallel-types" class="exampleblock">
                            <div class="title">Example 34. 层次结构的并行类型中的非法方法参数约束</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.parallel;

public interface Vehicle {

	void drive(@Max(75) int speedInMph);
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.parallel;

public interface Car {

	void drive(int speedInMph);
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.parallel;

public class RacingCar implements Car, Vehicle {

	@Override
	public void drive(int speedInMph) {
		//...
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>前面描述的限制只适用于输入参数约束。相反，返回值约束可以添加到重写或实现任何超类方法的方法中。</p>
                        </div>
                        <div class="paragraph">
                            <p>在这种情况下，所有方法的返回值约束都适用于子类型方法，即子类型方法本身上声明的约束，以及重写/实现的超类型方法上的任何返回值约束。这是合法的，因为增加额外的回报值约束可能永远不会削弱方法调用者得到的后置条件保证。</p>
                        </div>
                        <div class="paragraph">
                            <p>在 <a href="#example-return-value-constraints-in-hierarchy">Example 35, &#8220;超类型和子类型方法的返回值约束&#8221;</a> 中，校验 <code>Car#getPassengers()</code> 方法的返回值， <code>@Size</code> 方法也会在重写的 <code>Vehicle#getPassengers()</code> 的返回值被校验。</p>
                        </div>
                        <div id="example-return-value-constraints-in-hierarchy" class="exampleblock">
                            <div class="title">Example 35. 超类型和子类型方法的返回值约束</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.returnvalue;

public interface Vehicle {

	@NotNull
	List&lt;Person&gt; getPassengers();
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.inheritance.returnvalue;

public class Car implements Vehicle {

	@Override
	@Size(min = 1)
	public List&lt;Person&gt; getPassengers() {
		//...
		return null;
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>如果校验引擎检测到违反了上述任何规则，则将抛出
                                <code>ConstraintDeclarationException</code> 异常</p>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>本节中描述的规则只适用于方法，而不适用于构造函数。根据定义，构造函数永远不会重写超类型构造函数。因此，在校验构造函数调用的参数或返回值时，只应用构造函数本身声明的约束，而不应用超类型构造函数声明的任何约束。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="admonitionblock tip">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Tip</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>在创建 Validator 实例之前，可以通过设置 <code>MethodValidationConfiguration</code> 的 <code>HibernateValidatorConfiguration</code> 属性中包含的配置参数来放松这些规则的实施。 See also <a href="#section-method-validation-prerequisite-relaxation">Section 12.3, &#8220;Relaxation of requirements for method validation in class hierarchies&#8221;</a>.</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-validating-executable-constraints">
                        <a class="anchor" href="#section-validating-executable-constraints"></a>3.2. 校验方法约束</h3>
                    <div class="paragraph">
                        <p>方法约束的校验使用 <code>ExecutableValidator</code> 接口完成。</p>
                    </div>
                    <div class="paragraph">
                        <p>在 <a href="#section-obtaining-executable-validator">Section 3.2.1, &#8220;获取 <code>ExecutableValidator</code> 实例&#8221;</a> 你将学会如何掌握一个 <code>ExecutableValidator</code> 实例。 在 <a href="#section-executable-validator-methods">Section 3.2.2, &#8220;<code>ExecutableValidator</code> 的方法&#8221;</a>                            展示了如何使用这个接口提供的不同方法。</p>
                    </div>
                    <div class="paragraph">
                        <p><code>ExecutableValidator</code> 不是直接从应用程序代码中调用需要校验方法，而是通过方法拦截技术(如 AOP、代理对象等)调用它们。这将导致在方法或构造函数调用时自动和透明地校验可执行约束。通常，集成层在违反任何约束时都会引发 <code>ConstraintViolationException</code> 。</p>
                    </div>
                    <div class="sect3">
                        <h4 id="section-obtaining-executable-validator">
                            <a class="anchor" href="#section-obtaining-executable-validator"></a>3.2.1. 获取 <code>ExecutableValidator</code> 实例</h4>
                        <div class="paragraph">
                            <p>可以通过 <code>Validator#forExecutables()</code> 检索 <code>ExecutableValidator</code> 实例，如
                                <a href="#example-obtaining-executable-validator">Example 36, &#8220;获取 <code>ExecutableValidator</code> 实例&#8221;</a> 。</p>
                        </div>
                        <div id="example-obtaining-executable-validator" class="exampleblock">
                            <div class="title">Example 36. 获取 <code>ExecutableValidator</code> 实例</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
executableValidator = factory.getValidator().forExecutables();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>在这个例子中，可执行校验程序是从默认校验程序工厂获取的，但是如果需要做相关配置的话，您可以阅读
                                <a href="#chapter-bootstrapping">Chapter 9, <em>Bootstrapping</em></a> 。例如，为了使用特定的参数名称提供程序 (see <a href="#section-parameter-name-provider">Section 9.2.4, &#8220;<code>ParameterNameProvider</code>&#8221;</a>)。</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-executable-validator-methods">
                            <a class="anchor" href="#section-executable-validator-methods"></a>3.2.2. <code>ExecutableValidator</code> 的方法</h4>
                        <div class="paragraph">
                            <p><code>ExecutableValidator</code> 接口提供了四种方法:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>validateParameters()</code> 和 <code>validateReturnValue()</code> 用于方法的校验</p>
                                </li>
                                <li>
                                    <p><code>validateConstructorParameters()</code> 和 <code>validateConstructorReturnValue()</code> 用于构造函数的校验</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>和 <code>Validator</code> 的方法一样,所有这些方法都返回一个 <code>Set&lt;ConstraintViolation&gt;</code> ，它包含每个违反的约束的 <code>ConstraintViolation</code> ，如果校验成功，该实例将为空。此外，所有方法都有一个 var-args groups 参数，您可以通过该参数传递要考虑进行校验的校验组。</p>
                        </div>
                        <div class="paragraph">
                            <p>以下部分中的示例基于 <a href="#example-executable-validator-class-car">Example 37, &#8220;<code>Car</code> 使用约束方法和构造函数&#8221;</a> 中的 <code>Car</code> 类。</p>
                        </div>
                        <div id="example-executable-validator-class-car" class="exampleblock">
                            <div class="title">Example 37. <code>Car</code> 使用约束方法和构造函数</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.validation;

public class Car {

	public Car(@NotNull String manufacturer) {
		//...
	}

	@ValidRacingCar
	public Car(String manufacturer, String team) {
		//...
	}

	public void drive(@Max(75) int speedInMph) {
		//...
	}

	@Size(min = 1)
	public List&lt;Passenger&gt; getPassengers() {
		//...
		return Collections.emptyList();
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_executablevalidatorvalidateparameters">
                                <a class="anchor" href="#_executablevalidatorvalidateparameters"></a>3.2.2.1. <code>ExecutableValidator#validateParameters()</code></h5>
                            <div class="paragraph">
                                <p><code>validateParameters()</code> 法用于验证方法调用的参数。在
                                    <a href="#example-executable-validator-validate-parameters">Example 38, &#8220;使用 <code>ExecutableValidator#validateParameters()</code>&#8221;</a> 中 <code>drive()</code> 方法违法了 <code>@Max</code> 约束。</p>
                            </div>
                            <div id="example-executable-validator-validate-parameters" class="exampleblock">
                                <div class="title">Example 38. 使用 <code>ExecutableValidator#validateParameters()</code></div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car object = new Car( "Morris" );
Method method = Car.class.getMethod( "drive", int.class );
Object[] parameterValues = { 80 };
Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = executableValidator.validateParameters(
		object,
		method,
		parameterValues
);

assertEquals( 1, violations.size() );
Class&lt;? extends Annotation&gt; constraintType = violations.iterator()
		.next()
		.getConstraintDescriptor()
		.getAnnotation()
		.annotationType();
assertEquals( Max.class, constraintType );</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>请注意 <code>validateParameters()</code> 校验方法的所有参数约束，即包括单个参数的约束以及交叉参数约束。</p>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_executablevalidatorvalidatereturnvalue">
                                <a class="anchor" href="#_executablevalidatorvalidatereturnvalue"></a>3.2.2.2. <code>ExecutableValidator#validateReturnValue()</code></h5>
                            <div class="paragraph">
                                <p>使用 <code>validateReturnValue()</code> 可以验证方法的返回值。在
                                    <a href="#example-executable-validator-validate-return-value">Example 39, &#8220;使用 <code>ExecutableValidator#validateReturnValue()</code>&#8221;</a> 产生一个约束冲突，因为 <code>getPassengers()</code> 方法需要至少返回一个 <code>Passenger</code>                                    实例。</p>
                            </div>
                            <div id="example-executable-validator-validate-return-value" class="exampleblock">
                                <div class="title">Example 39. 使用 <code>ExecutableValidator#validateReturnValue()</code></div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car object = new Car( "Morris" );
Method method = Car.class.getMethod( "getPassengers" );
Object returnValue = Collections.&lt;Passenger&gt;emptyList();
Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = executableValidator.validateReturnValue(
		object,
		method,
		returnValue
);

assertEquals( 1, violations.size() );
Class&lt;? extends Annotation&gt; constraintType = violations.iterator()
		.next()
		.getConstraintDescriptor()
		.getAnnotation()
		.annotationType();
assertEquals( Size.class, constraintType );</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_executablevalidatorvalidateconstructorparameters">
                                <a class="anchor" href="#_executablevalidatorvalidateconstructorparameters"></a>3.2.2.3. <code>ExecutableValidator#validateConstructorParameters()</code></h5>
                            <div class="paragraph">
                                <p>使用 <code>validateConstructorParameters()</code> 验证构造函数调用的参数，如<a href="#example-executable-validator-validate-constructor-parameters">Example 40, &#8220;使用 <code>ExecutableValidator#validateConstructorParameters()</code>&#8221;</a>.
                                    因为 <code>manufacturer</code> 字段的 <code>@NotNull</code> 约束，校验调用返回一个约束冲突。</p>
                            </div>
                            <div id="example-executable-validator-validate-constructor-parameters" class="exampleblock">
                                <div class="title">Example 40. 使用 <code>ExecutableValidator#validateConstructorParameters()</code></div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Constructor&lt;Car&gt; constructor = Car.class.getConstructor( String.class );
Object[] parameterValues = { null };
Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = executableValidator.validateConstructorParameters(
		constructor,
		parameterValues
);

assertEquals( 1, violations.size() );
Class&lt;? extends Annotation&gt; constraintType = violations.iterator()
		.next()
		.getConstraintDescriptor()
		.getAnnotation()
		.annotationType();
assertEquals( NotNull.class, constraintType );</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_executablevalidatorvalidateconstructorreturnvalue">
                                <a class="anchor" href="#_executablevalidatorvalidateconstructorreturnvalue"></a>3.2.2.4. <code>ExecutableValidator#validateConstructorReturnValue()</code></h5>
                            <div class="paragraph">
                                <p>最后，通过使用 <code>validateConstructorReturnValue()</code> ，可以验证构造函数的返回值。
                                    <a href="#example-executable-validator-validate-constructor-return-value">Example 41, &#8220;使用 <code>ExecutableValidator#validateConstructorReturnValue()</code>&#8221;</a>, <code>validateConstructorReturnValue()</code>                                    返回一个约束冲突，因为构造函数返回的 <code>Car</code> 实例不满足 <code>@ValidRacingCar</code> 约束。</p>
                            </div>
                            <div id="example-executable-validator-validate-constructor-return-value" class="exampleblock">
                                <div class="title">Example 41. 使用 <code>ExecutableValidator#validateConstructorReturnValue()</code></div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">//constructor for creating racing cars
Constructor&lt;Car&gt; constructor = Car.class.getConstructor( String.class, String.class );
Car createdObject = new Car( "Morris", null );
Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = executableValidator.validateConstructorReturnValue(
		constructor,
		createdObject
);

assertEquals( 1, violations.size() );
Class&lt;? extends Annotation&gt; constraintType = violations.iterator()
		.next()
		.getConstraintDescriptor()
		.getAnnotation()
		.annotationType();
assertEquals( ValidRacingCar.class, constraintType );</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_校验方法的结果_constraintviolation">
                            <a class="anchor" href="#_校验方法的结果_constraintviolation"></a>3.2.3. 校验方法的结果 <code>ConstraintViolation</code></h4>
                        <div class="paragraph">
                            <p>除了 <a href="#section-constraint-violation-methods">Section 2.2.3, &#8220;<code>ConstraintViolation</code>&#8221;</a> 介绍的方法之外，<code>ConstraintViolation</code> 还提供了另外两个特定于验证可执行参数和返回值的方法。</p>
                        </div>
                        <div class="paragraph">
                            <p><code>ConstraintViolation#getExecutableParameters()</code> 在方法或构造函数参数验证的情况下返回验证过的参数数组 ， 而 <code>ConstraintViolation#getExecutableReturnValue()</code> 在返回值验证的情况下提供对验证对象的访问。
                            </p>
                        </div>
                        <div class="paragraph">
                            <p>所有其他 <code>ConstraintViolation</code> 方法通常都以验证 bean 的方式工作于方法验证一样。</p>
                        </div>
                        <div class="paragraph">
                            <p>注意 <code>getPropertyPath()</code> 对于获取有关验证参数或返回值的详细信息非常有用，例如用于日志记录。特别是，您可以从路径节点检索相关方法的名称和参数类型以及相关参数的索引。<a href="#example-executable-validation-property-path">Example 42, &#8220;检索方法和参数信息&#8221;</a> 中显示了如何做到这一点。</p>
                        </div>
                        <div id="example-executable-validation-property-path" class="exampleblock">
                            <div class="title">Example 42. 检索方法和参数信息</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car object = new Car( "Morris" );
Method method = Car.class.getMethod( "drive", int.class );
Object[] parameterValues = { 80 };
Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = executableValidator.validateParameters(
		object,
		method,
		parameterValues
);

assertEquals( 1, violations.size() );
Iterator&lt;Node&gt; propertyPath = violations.iterator()
		.next()
		.getPropertyPath()
		.iterator();

MethodNode methodNode = propertyPath.next().as( MethodNode.class );
assertEquals( "drive", methodNode.getName() );
assertEquals( Arrays.&lt;Class&lt;?&gt;&gt;asList( int.class ), methodNode.getParameterTypes() );

ParameterNode parameterNode = propertyPath.next().as( ParameterNode.class );
assertEquals( "speedInMph", parameterNode.getName() );
assertEquals( 0, parameterNode.getParameterIndex() );</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>参数名称是使用当前的 <code>ParameterNameProvider</code> (see
                                <a href="#section-parameter-name-provider">Section 9.2.4, &#8220;<code>ParameterNameProvider</code>&#8221;</a>).</p>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-builtin-method-constraints">
                        <a class="anchor" href="#section-builtin-method-constraints"></a>3.3. 内置方法约束</h3>
                    <div class="paragraph">
                        <p>除了 <a href="#section-builtin-constraints">Section 2.3, &#8220;内置约束&#8221;</a> 中讨论的内置 bean 和属性级约束之外，Hibernate Validator 目前还提供了一个方法级约束 <code>@ParameterScriptAssert</code> 这是一个通用的跨参数约束，它允许使用任何与 JSR 223兼容(“ Java <sup>TM</sup> 平台的脚本编写”)的脚本语言实现验证例程，前提是在类路径中可以使用这种语言的引擎。</p>
                    </div>
                    <div class="paragraph">
                        <p>若要从表达式内引用可执行文件的参数，请使用从活动参数名称提供程序获得的参数名称 (see <a href="#section-parameter-name-provider">Section 9.2.4, &#8220;<code>ParameterNameProvider</code>&#8221;</a>).
                            <a href="#example-parameterscriptassert">Example 43, &#8220;使用 <code>@ParameterScriptAssert</code>&#8221;</a> 示了如何在 <code>@LuggageCountMatchesPassengerCount</code> 的帮助下表示 <a href="#example-using-cross-parameter-constraint">Example 28, &#8220;声明交叉参数约束&#8221;</a>                            的 <code>@ParameterScriptAssert</code> 约束的验证逻辑。</p>
                    </div>
                    <div id="example-parameterscriptassert" class="exampleblock">
                        <div class="title">Example 43. 使用 <code>@ParameterScriptAssert</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter03.parameterscriptassert;

public class Car {

	@ParameterScriptAssert(lang = "javascript", script = "luggage.size() &lt;= passengers.size() * 2")
	public void load(List&lt;Person&gt; passengers, List&lt;PieceOfLuggage&gt; luggage) {
		//...
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="chapter-message-interpolation">
                <a class="anchor" href="#chapter-message-interpolation"></a>4. 添加约束错误消息</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>消息插值是违反 Jakarta Bean Validation 约束后创建错误消息的过程。在本章中，您将学习如何定义和解析这些消息，以及如何在默认算法不足以满足需求的情况下插入自定义消息插入器。</p>
                </div>
                <div class="sect2">
                    <h3 id="section-message-interpolation">
                        <a class="anchor" href="#section-message-interpolation"></a>4.1. 默认消息插值</h3>
                    <div class="paragraph">
                        <p>违反约束的消息是从所谓的消息descriptors(描述器)中检索的。每个约束都定义了它们自己其默认消息descriptors(描述器)。在声明时，默认descriptors(描述器)可以被特定的值覆盖，如 <a href="#example-overriding-message">Example 44, &#8220;使用消息属性指定消息描述符&#8221;</a>.</p>
                    </div>
                    <div id="example-overriding-message" class="exampleblock">
                        <div class="title">Example 44. 使用消息属性指定消息描述符</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter04;

public class Car {

	@NotNull(message = "The manufacturer name must not be null")
	private String manufacturer;

	//constructor, getters and setters ...
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>如果违反了相关约束注解，将由validation引擎使用当前配置的 <code>MessageInterpolator</code> 进行消息的构建。然后通过调用 <code>ConstraintViolation#getMessage()</code> 方法可以获取结果。</p>
                    </div>
                    <div class="paragraph">
                        <p>消息描述符可以包含 <em>message parameters(消息参数)</em> 以及在插值期间将要解析的 <em>message expressions(消息表达式)</em> 。消息参数是封闭在 <code>{}</code> 中的字符串，而消息表达式是封闭在 <code>${}</code> 中的字符串。在方法插值过程中应用了以下算法:</p>
                    </div>
                    <div class="olist arabic">
                        <ol class="arabic">
                            <li>
                                <p>将 <em>message parameters(消息参数)</em> 作为键值(key)在资源包 <em>ValidationMessages</em> 中检索value值。 如果这个资源包包含给定 <em>message parameters(消息参数)</em> ，那么该参数的value将在消息中的 <em>message parameters(消息参数)</em> 替换。如果替换的值再次包含消息参数，将递归地执行此步骤。资源包应该由应用程序开发人员提供，例如，通过将名为
                                    <em>ValidationMessages.properties</em> 的文件添加到类路径中。您还可以通过提供此包的特定于国家的语言文件(如 <em>ValidationMessages_en_US.properties</em> )来创建本地化的错误消息。默认情况下，在包中查找消息时将使用 JVM 的默认语言环境( <code>Locale#getDefault()</code> )。</p>
                            </li>
                            <li>
                                <p>通过将任何消息参数用作包含 Jakarta Bean Validation规范附录 B 中定义的内置约束的标准错误消息的资源包的键来解析它们。对于 Hibernate Validator，这个绑定包名为 <code>org.hibernate.validator.ValidationMessages</code> 。如果此步骤触发替换，则再次执行步骤1，否则应用步骤3。</p>
                            </li>
                            <li>
                                <p>通过将任何消息参数替换为具有相同名称的约束注解成员的值来解析它们。这允许在错误消息中引用约束的属性值(例如 <code>Size#min()</code>)(例如"must be at least ${ min }")。</p>
                            </li>
                            <li>
                                <p>通过将任何消息表达式计算为统一表达式语言表达式来解析它们。请参阅<a href="#section-interpolation-with-message-expressions">Section 4.1.2, &#8220;带有消息表达式的插值&#8221;</a> 了解有关在错误消息中使用统一 EL 的更多信息。</p>
                            </li>
                        </ol>
                    </div>
                    <div class="admonitionblock tip">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Tip</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>您可以在 Jakarta Bean Validation 规范的6.3.1.1节中找到插值算法的形式化定义。</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="sect3">
                        <h4 id="section-special-characters">
                            <a class="anchor" href="#section-special-characters"></a>4.1.1. 特殊字符</h4>
                        <div class="paragraph">
                            <p>由于字符 <code>{</code>, <code>}</code> 和 <code>$</code> 在消息描述符中具有特殊的含义，如果要按字面意思使用它们，就需要对它们进行转义。以下规则适用:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>\{</code> 代表字符 <code>{</code></p>
                                </li>
                                <li>
                                    <p><code>\}</code> 代表字符 <code>}</code></p>
                                </li>
                                <li>
                                    <p><code>\$</code> 代表字符 <code>$</code></p>
                                </li>
                                <li>
                                    <p><code>\\</code> 代表字符 <code>\</code></p>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-interpolation-with-message-expressions">
                            <a class="anchor" href="#section-interpolation-with-message-expressions"></a>4.1.2. 带有消息表达式的插值</h4>
                        <div class="paragraph">
                            <p>从 Hibernate Validator 5 (Bean Validation 1.1) 开始，可以在违反约束的消息中使用
                                <a href="https://projects.eclipse.org/projects/ee4j.el">Jakarta Expression Language</a> 。这允许基于条件逻辑定义错误消息，还支持高级格式设置选项。验证引擎使以下对象在 EL 上下文中可用:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p>通过约束的属性名称映射到配置的值</p>
                                </li>
                                <li>
                                    <p><em>validatedValue</em> 表式的当前验证的值(属性、 bean、方法参数等)</p>
                                </li>
                                <li>
                                    <p>也可以用 <code>format(String format, Object…​ args)</code> 格式化输出，它的行为类似于 <code>java.util.Formatter.format(String format, Object&#8230;&#8203; args)</code> 。</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>Expression Language非常灵活，Hibernate Validator 提供了几个特性级别，您可以通过 <code>ExpressionLanguageFeatureLevel</code> 这个枚举来启用不同等级表达式语言特性:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>NONE</code>: Expression Language 插值完全禁用。</p>
                                </li>
                                <li>
                                    <p><code>VARIABLES</code>: 允许通过 <code>addExpressionVariable()</code>, 资源包 和 <code>formatter</code> 对象.</p>
                                </li>
                                <li>
                                    <p><code>BEAN_PROPERTIES</code>: 除了 <code>VARIABLES</code> 允许的还包括插入bean的属性。</p>
                                </li>
                                <li>
                                    <p><code>BEAN_METHODS</code>: 也允许执行BEAN方法。对于硬编码的约束消息可以认为是安全的，但是对于需要额外注意的 <a href="#section-hibernateconstraintvalidatorcontext">custom violations</a> (自定义约束)。</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>约束消息的默认特性级别是 <code>BEAN_PROPERTIES</code>.</p>
                        </div>
                        <div class="paragraph">
                            <p>你也可以在启动的时候设置级别 <a href="#el-features">bootstrapping the <code>ValidatorFactory</code></a>.</p>
                        </div>
                        <div class="paragraph">
                            <p>以下部分提供了在错误消息中使用 EL 表达式的几个示例：</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_示例">
                            <a class="anchor" href="#_示例"></a>4.1.3. 示例</h4>
                        <div class="paragraph">
                            <p><a href="#example-message-descriptors">Example 45, &#8220;指定消息descriptors(描述符)&#8221;</a> 展示了如何使用不同的选项来指定消息descriptors(描述符)。</p>
                        </div>
                        <div id="example-message-descriptors" class="exampleblock">
                            <div class="title">Example 45. 指定消息descriptors(描述符)</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter04.complete;

public class Car {

	@NotNull
	private String manufacturer;

	@Size(
			min = 2,
			max = 14,
			message = "The license plate '${validatedValue}' must be between {min} and {max} characters long"
	)
	private String licensePlate;

	@Min(
			value = 2,
			message = "There must be at least {value} seat${value &gt; 1 ? 's' : ''}"
	)
	private int seatCount;

	@DecimalMax(
			value = "350",
			message = "The top speed ${formatter.format('%1$.2f', validatedValue)} is higher " +
					"than {value}"
	)
	private double topSpeed;

	@DecimalMax(value = "100000", message = "Price must not be higher than ${value}")
	private BigDecimal price;

	public Car(
			String manufacturer,
			String licensePlate,
			int seatCount,
			double topSpeed,
			BigDecimal price) {
		this.manufacturer = manufacturer;
		this.licensePlate = licensePlate;
		this.seatCount = seatCount;
		this.topSpeed = topSpeed;
		this.price = price;
	}

	//getters and setters ...
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>校验一个无效的 <code>Car</code> 实例会产生违反约束的行为，用该单元测试验证 <a href="#example-expected-error-messages">Example 46, &#8220;判断是否为预期的错误消息&#8221;</a></p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>manufacturer</code> 字段的 <code>@NotNull</code> 约束将输出错误信息 "must not be null" ，这是由的Jakarta Bean Validation 规范定义的，加之你没有特殊的指定输出信息。</p>
                                </li>
                                <li>
                                    <p><code>licensePlate</code> 字段的 <code>@Size</code> 约束，展示如何使用 <em>message parameters(消息参数)</em> (<code>{min}</code>, <code>{max}</code>) 以及如何添加当前校验值，通过EL表达式: <code>${validatedValue}</code>。</p>
                                </li>
                                <li>
                                    <p><code>seatCount</code> 字段的 <code>@Min</code> 约束，演示了如何使用带有三元表达式的 EL 表达式动态选择单数或复数形式，这取决于约束的属性("There must be at least 1 seat" vs. "There must be at least 2 seats")</p>
                                </li>
                                <li>
                                    <p><code>topSpeed</code> 字段的 <code>@DecimalMax</code> 展示了如何使用格式化程序实例格式化已验证的值</p>
                                </li>
                                <li>
                                    <p>最后，<code>price</code> 字段的 <code>@DecimalMax</code> 约束显示参数插值优先于表达式求值，导致 <code>$</code> 符号显示在最大价格前面</p>
                                </li>
                            </ul>
                        </div>
                        <div class="admonitionblock tip">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Tip</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>只有实际的约束属性可以使用格式 <code>{attributeName}</code> 。当引用添加到插值上下文中的验证值或自定义表达式变量时(参见 <a href="#section-hibernateconstraintvalidatorcontext">Section 12.13.1, &#8220;<code>HibernateConstraintValidatorContext</code>&#8221;</a>),
                                                必须使用形式为 <code>${attributeName}</code> 的 EL 表达式。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div id="example-expected-error-messages" class="exampleblock">
                            <div class="title">Example 46. 判断是否为预期的错误消息</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car car = new Car( null, "A", 1, 400.123456, BigDecimal.valueOf( 200000 ) );

String message = validator.validateProperty( car, "manufacturer" )
		.iterator()
		.next()
		.getMessage();
assertEquals( "must not be null", message );

message = validator.validateProperty( car, "licensePlate" )
		.iterator()
		.next()
		.getMessage();
assertEquals(
		"The license plate 'A' must be between 2 and 14 characters long",
		message
);

message = validator.validateProperty( car, "seatCount" ).iterator().next().getMessage();
assertEquals( "There must be at least 2 seats", message );

message = validator.validateProperty( car, "topSpeed" ).iterator().next().getMessage();
assertEquals( "The top speed 400.12 is higher than 350", message );

message = validator.validateProperty( car, "price" ).iterator().next().getMessage();
assertEquals( "Price must not be higher than $100000", message );</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-custom-message-interpolation">
                        <a class="anchor" href="#section-custom-message-interpolation"></a>4.2. 自定义消息插值</h3>
                    <div class="paragraph">
                        <p>如果默认的消息插值算法不符合您的要求，也可以自己实现一个 <code>MessageInterpolator</code> 。</p>
                    </div>
                    <div class="paragraph">
                        <p>自定义插值器必须实现接口 <code>jakarta.validation.MessageInterpolator</code>。 注意，您的实现必须是线程安全的。建议自定义消息内插器将最终实现委托给缺省的内插器，可以通过
                            <code>Configuration#getDefaultMessageInterpolator()</code> 获取。</p>
                    </div>
                    <div class="paragraph">
                        <p>为了使用自定义消息插入器，必须在 Jakarta Bean Validation XML 配置文件 <em>META-INF/validation.xml</em> (see <a href="#section-configuration-validation-xml">Section 8.1, &#8220;Configuring the validator factory in <em>validation.xml</em>&#8221;</a>)
                            中配置它，或者启动过程中配置 <code>ValidatorFactory</code> 或 <code>Validator</code> 时传递它 (see <a href="#section-validator-factory-message-interpolator">Section 9.2.1, &#8220;<code>MessageInterpolator</code>&#8221;</a> and <a href="#section-configuring-validator">Section 9.3, &#8220;Configuring a Validator&#8221;</a>,
                            respectively).</p>
                    </div>
                    <div class="sect3">
                        <h4 id="section-resource-bundle-locator">
                            <a class="anchor" href="#section-resource-bundle-locator"></a>4.2.1. <code>ResourceBundleLocator</code></h4>
                        <div class="paragraph">
                            <p>在某些用例中，您希望使用 Bean Validation 规范定义的消息插值算法，但是从 <em>ValidationMessages</em> 以外的其他资源包中检索错误消息。在这种情况下 Hibernate Validator 的 <code>ResourceBundleLocator</code> SPI 可以提供帮助。</p>
                        </div>
                        <div class="paragraph">
                            <p>Hibernate Validator 中的缺省消息内插器 <code>ResourceBundleMessageInterpolator</code> 资源包的检索委托给该 SPI。在启动加载程序 <code>ValidatorFactory</code> 时，使用替代的资源包只需要传递一个具有资源包名称的 <code>PlatformResourceBundleLocator</code> 实例，如 <a href="#example-using-specific-resource-bundle-locator">Example 47, &#8220;使用特定的资源包&#8221;</a>.</p>
                        </div>
                        <div id="example-using-specific-resource-bundle-locator" class="exampleblock">
                            <div class="title">Example 47. 使用特定的资源包</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Validator validator = Validation.byDefaultProvider()
		.configure()
		.messageInterpolator(
				new ResourceBundleMessageInterpolator(
						new PlatformResourceBundleLocator( "MyMessages" )
				)
		)
		.buildValidatorFactory()
		.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>当然，您也可以实现一个完全不同的 <code>ResourceBundleLocator</code>, 例如，它返回由数据库中的记录支持的包。在这种情况下，您可以通过
                                <code>HibernateValidatorConfiguration#getDefaultResourceBundleLocator()</code>, 获得默认定位器，例如，您可以使用它作为定制定位器的备用定位器。</p>
                        </div>
                        <div class="paragraph">
                            <p>除了 <code>PlatformResourceBundleLocator</code> 之外，Hibernate Validator还提供了另一个资源包定位器实现，即 <code>AggregateResourceBundleLocator</code> ，它允许从多个资源包检索错误消息。例如，您可以在多模块应用程序中使用此实现，其中每个模块需要一个消息包。<a href="#example-using-aggregate-resource-bundle-locator">Example 48, &#8220;使用 <code>AggregateResourceBundleLocator</code>&#8221;</a>                                展示了如何使用 <code>AggregateResourceBundleLocator</code> 。</p>
                        </div>
                        <div id="example-using-aggregate-resource-bundle-locator" class="exampleblock">
                            <div class="title">Example 48. 使用 <code>AggregateResourceBundleLocator</code></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Validator validator = Validation.byDefaultProvider()
		.configure()
		.messageInterpolator(
				new ResourceBundleMessageInterpolator(
						new AggregateResourceBundleLocator(
								Arrays.asList(
										"MyMessages",
										"MyOtherMessages"
								)
						)
				)
		)
		.buildValidatorFactory()
		.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>请注意，资源包是按照传递给构造函数的顺序处理的。这意味着，如果多个资源包包含给定消息键的条目，则该值将从包含该键的列表中的第一个资源包中取出。</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="chapter-groups">
                <a class="anchor" href="#chapter-groups"></a>5. 分组约束</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>在前面几章中讨论的 <code>Validator</code> 和 <code>ExecutableValidator</code> 中的所有校验方法都可以输入参数 <code>groups</code> 。到目前为止，我们一直忽略这个参数，但是现在是时候仔细研究一下了。</p>
                </div>
                <div class="sect2">
                    <h3 id="_请求分组">
                        <a class="anchor" href="#_请求分组"></a>5.1. 请求分组</h3>
                    <div class="paragraph">
                        <p>(分组)Groups允许你在校验的时候限制校验范围，校验分组的一个使用场景是UI导航，其中每个步骤中只有指定的约束子集应该得到校验。目标分组作为参数传递给适当的校验方法。</p>
                    </div>
                    <div class="paragraph">
                        <p>让我们来看接下来的这个例子， <a href="#example-person">Example 49, &#8220;实体类 <code>Person</code>&#8221;</a> 中的 <code>Person</code> 类的 <code>name</code> 有一个 <code>@NotNull</code> 注解约束。如果没有特别指定分组，那么会分组为默认的 <code>jakarta.validation.groups.Default</code>                            。</p>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>当校验一个或多个分组的时候，也没有显示的指定分组。那么会被分类至 <code>jakarta.validation.groups.Default</code> 。</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div id="example-person" class="exampleblock">
                        <div class="title">Example 49. 实体类 <code>Person</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

public class Person {

	@NotNull
	private String name;

	public Person(String name) {
		this.name = name;
	}

	// getters and setters ...
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p><a href="#example-driver">Example 50, &#8220;Driver类&#8221;</a> 中的 <code>Driver</code> 类继承至 <code>Person</code> 类，同时添加了 <code>age</code> 和 <code>hasDrivingLicense</code> 两个字段。司机必须年满18岁(<code>@Min(18)</code>)并持有驾驶执照( <code>@AssertTrue</code>                            ) ， 在这些属性上定义的约束都属于 <code>DriverChecks</code> 分组，它只是一个简单的标记接口。</p>
                    </div>
                    <div class="admonitionblock tip">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Tip</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>使用接口使得组的使用类型安全，并且允许轻松地进行重构。这也意味着组可以通过类继承彼此继承。见 <a href="#section-group-inheritance">Section 5.2, &#8220;分组继承&#8221;</a></p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div id="example-driver" class="exampleblock">
                        <div class="title">Example 50. Driver类</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

public class Driver extends Person {

	@Min(
			value = 18,
			message = "You have to be 18 to drive a car",
			groups = DriverChecks.class
	)
	public int age;

	@AssertTrue(
			message = "You first have to pass the driving test",
			groups = DriverChecks.class
	)
	public boolean hasDrivingLicense;

	public Driver(String name) {
		super( name );
	}

	public void passedDrivingTest(boolean b) {
		hasDrivingLicense = b;
	}

	public int getAge() {
		return age;
	}

	public void setAge(int age) {
		this.age = age;
	}
}</code></pre>
                                </div>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

public interface DriverChecks {
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>最后 <code>Car</code> 类(<a href="#example-car">Example 51, &#8220;Car类&#8221;</a>) 具有一些约束，这些约束是默认组的一部分，但是 <code>passedVehicleInspection</code> 字段的 <code>@AssertTrue</code> 约束注解属于 <code>CarChecks</code> 分组，它表示一辆汽车是否通过了道路测试。</p>
                    </div>
                    <div id="example-car" class="exampleblock">
                        <div class="title">Example 51. Car类</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

public class Car {
	@NotNull
	private String manufacturer;

	@NotNull
	@Size(min = 2, max = 14)
	private String licensePlate;

	@Min(2)
	private int seatCount;

	@AssertTrue(
			message = "The car has to pass the vehicle inspection first",
			groups = CarChecks.class
	)
	private boolean passedVehicleInspection;

	@Valid
	private Driver driver;

	public Car(String manufacturer, String licencePlate, int seatCount) {
		this.manufacturer = manufacturer;
		this.licensePlate = licencePlate;
		this.seatCount = seatCount;
	}

	public boolean isPassedVehicleInspection() {
		return passedVehicleInspection;
	}

	public void setPassedVehicleInspection(boolean passedVehicleInspection) {
		this.passedVehicleInspection = passedVehicleInspection;
	}

	public Driver getDriver() {
		return driver;
	}

	public void setDriver(Driver driver) {
		this.driver = driver;
	}

	// getters and setters ...
}</code></pre>
                                </div>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

public interface CarChecks {
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>总的来说，示例中使用了三个不同的组:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p><code>Person.name</code>, <code>Car.manufacturer</code>, <code>Car.licensePlate</code> 和 <code>Car.seatCount</code> 字段属于 <code>Default</code> 分组</p>
                            </li>
                            <li>
                                <p><code>Driver.age</code> 和 <code>Driver.hasDrivingLicense</code> 字段属于 <code>DriverChecks</code> 分组</p>
                            </li>
                            <li>
                                <p><code>Car.passedVehicleInspection</code> 字段属于 <code>CarChecks</code> 分组</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p><a href="#example-drive-away">Example 52, &#8220;使用校验分组&#8221;</a> 展示了如何将不同的组合传递给 <code>Validator#validate()</code> 方法，从而导致不同的校验结果。
                        </p>
                    </div>
                    <div id="example-drive-away" class="exampleblock">
                        <div class="title">Example 52. 使用校验分组</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">// create a car and check that everything is ok with it.
Car car = new Car( "Morris", "DD-AB-123", 2 );
Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );
assertEquals( 0, constraintViolations.size() );

// but has it passed the vehicle inspection?
constraintViolations = validator.validate( car, CarChecks.class );
assertEquals( 1, constraintViolations.size() );
assertEquals(
		"The car has to pass the vehicle inspection first",
		constraintViolations.iterator().next().getMessage()
);

// let's go to the vehicle inspection
car.setPassedVehicleInspection( true );
assertEquals( 0, validator.validate( car, CarChecks.class ).size() );

// now let's add a driver. He is 18, but has not passed the driving test yet
Driver john = new Driver( "John Doe" );
john.setAge( 18 );
car.setDriver( john );
constraintViolations = validator.validate( car, DriverChecks.class );
assertEquals( 1, constraintViolations.size() );
assertEquals(
		"You first have to pass the driving test",
		constraintViolations.iterator().next().getMessage()
);

// ok, John passes the test
john.passedDrivingTest( true );
assertEquals( 0, validator.validate( car, DriverChecks.class ).size() );

// just checking that everything is in order now
assertEquals(
		0, validator.validate(
		car,
		Default.class,
		CarChecks.class,
		DriverChecks.class
).size()
);</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p><a href="#example-drive-away">Example 52, &#8220;使用校验分组&#8221;</a> 中第一次调用 <code>validate()</code> 方法是在没有显式指定分组的情况下完成的。没有验证错误，即使 <code>passedVehicleInspection</code> 的默认值是 <code>false</code> ，因为在该属性上定义的约束不属于默认组。</p>
                    </div>
                    <div class="paragraph">
                        <p>第二次校验的是 <code>CarChecks</code> 分组，会校验失败除非汽车通过车辆检查(passedVehicleInspection = true)。为汽车添加一个驾驶员，会再次导致校验失败，因为驾驶员尚未通过驾驶考试，只有将 <code>passedDrivingTest</code> 设置为 <code>true</code> 后，对 <code>DriverChecks</code> 的分组才会通过。</p>
                    </div>
                    <div class="paragraph">
                        <p>最后一次调用 <code>validate()</code> 表示所有定义的分组的约束都通过校验。</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-group-inheritance">
                        <a class="anchor" href="#section-group-inheritance"></a>5.2. 分组继承</h3>
                    <div class="paragraph">
                        <p>在 <a href="#example-drive-away">Example 52, &#8220;使用校验分组&#8221;</a>, 我们需要为每个校验分组调用一次 <code>validate()</code> ， 或者一次性指定他们所有。</p>
                    </div>
                    <div class="paragraph">
                        <p>在某些情况下，您可能希望定义一组包含另一组的约束。您可以使用分组继承来实现这一点。</p>
                    </div>
                    <div class="paragraph">
                        <p>在 <a href="#example-supercar">Example 53, &#8220;SuperCar类&#8221;</a>中，我们定义了一个变量 <code>SuperCar</code> 和一个 <code>RaceCarChecks</code> 分组，<code>RaceCarChecks</code> 分组继承至 <code>Default</code> 分组。 <code>SuperCar</code> (超级跑车)必须配备安全带才能参加比赛。</p>
                    </div>
                    <div id="example-supercar" class="exampleblock">
                        <div class="title">Example 53. SuperCar类</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05.groupinheritance;

public class SuperCar extends Car {

	@AssertTrue(
			message = "Race car must have a safety belt",
			groups = RaceCarChecks.class
	)
	private boolean safetyBelt;

	// getters and setters ...

}</code></pre>
                                </div>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05.groupinheritance;

import jakarta.validation.groups.Default;

public interface RaceCarChecks extends Default {
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>在下面的例子中，我们将校验 <code>SuperCar</code> 在只有一个座位且没有安全带，是否是合格的汽车？是否是合格的竞速车辆？</p>
                    </div>
                    <div id="example-group-inheritance" class="exampleblock">
                        <div class="title">Example 54. 使用分组继承</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">// create a supercar and check that it's valid as a generic Car
SuperCar superCar = new SuperCar( "Morris", "DD-AB-123", 1  );
assertEquals( "must be greater than or equal to 2", validator.validate( superCar ).iterator().next().getMessage() );

// check that this supercar is valid as generic car and also as race car
Set&lt;ConstraintViolation&lt;SuperCar&gt;&gt; constraintViolations = validator.validate( superCar, RaceCarChecks.class );

assertThat( constraintViolations ).extracting( "message" ).containsOnly(
		"Race car must have a safety belt",
		"must be greater than or equal to 2"
);</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>在第一次调用 <code>validate()</code> 时，我们不指定分组。有一个验证错误，因为汽车必须至少有一个座位。它是来自 <code>Default</code> 分组的约束。</p>
                    </div>
                    <div class="paragraph">
                        <p>在第二次调用中，我们只指定 <code>RaceCarChecks</code> 分组。有两个验证错误: 一个是 <code>Default</code> 分组的座位丢失，另一个是 <code>RaceCarChecks</code> 分组没有安全带。</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-defining-group-sequences">
                        <a class="anchor" href="#section-defining-group-sequences"></a>5.3. 定义分组序列</h3>
                    <div class="paragraph">
                        <p>默认情况下，不管约束属于哪个分组，约束都不按特定顺序进行计算。然而，在某些情况下，控制校验约束的顺序是有很用的。</p>
                    </div>
                    <div class="paragraph">
                        <p>在 <a href="#example-drive-away">Example 52, &#8220;使用校验分组&#8221;</a> 中。要求在检查汽车的适应性之前，首先要通过所有默认的汽车约束。最后，在开车离开之前，应该检查实际的驾驶员约束。</p>
                    </div>
                    <div class="paragraph">
                        <p>为了实现这样的验证顺序，您只需定义一个接口并使用 <code>@GroupSequence</code> 对其进行注解，定义必须验证组的顺序(参见 <a href="#example-defining-group-sequence">Example 55, &#8220;定义一个分组序列&#8221;</a>). 如果序列组中有一个约束校验失败，序列组中以下各组的约束都不会得到验证。</p>
                    </div>
                    <div id="example-defining-group-sequence" class="exampleblock">
                        <div class="title">Example 55. 定义一个分组序列</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

import jakarta.validation.GroupSequence;
import jakarta.validation.groups.Default;

@GroupSequence({ Default.class, CarChecks.class, DriverChecks.class })
public interface OrderedChecks {
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="admonitionblock warning">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Warning</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>定义序列的组和组成序列的组不能直接或间接地通过级联序列定义或组继承参与循环依赖。如果计算包含这种循环的组，则会引发 <code>GroupDefinitionException</code> 。</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>然后您可以在<a href="#example-group-sequence">Example 56, &#8220;使用分组序列&#8221;</a>使用刚刚定义的分组序列。</p>
                    </div>
                    <div id="example-group-sequence" class="exampleblock">
                        <div class="title">Example 56. 使用分组序列</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car car = new Car( "Morris", "DD-AB-123", 2 );
car.setPassedVehicleInspection( true );

Driver john = new Driver( "John Doe" );
john.setAge( 18 );
john.passedDrivingTest( true );
car.setDriver( john );

assertEquals( 0, validator.validate( car, OrderedChecks.class ).size() );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-default-group-class">
                        <a class="anchor" href="#section-default-group-class"></a>5.4. 重新定义默认组序列</h3>
                    <div class="sect3">
                        <h4 id="_groupsequence">
                            <a class="anchor" href="#_groupsequence"></a>5.4.1. <code>@GroupSequence</code></h4>
                        <div class="paragraph">
                            <p>除了定义组序列, <code>@GroupSequence</code> 分组还允许为给定的类重新定义默认组。为此，只需将 <code>@GroupSequence</code> 注释添加到类中，并指定在注释中用 <code>Default</code> 替换该类的组的顺序。</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="#example-rental-car">Example 57, &#8220;为`RentalCar` 重新定义默认分组&#8221;</a> 介绍将 <code>RentalCar</code> 重新定义默认分组。</p>
                        </div>
                        <div id="example-rental-car" class="exampleblock">
                            <div class="title">Example 57. 为`RentalCar` 重新定义默认分组</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

@GroupSequence({ RentalChecks.class, CarChecks.class, RentalCar.class })
public class RentalCar extends Car {
	@AssertFalse(message = "The car is currently rented out", groups = RentalChecks.class)
	private boolean rented;

	public RentalCar(String manufacturer, String licencePlate, int seatCount) {
		super( manufacturer, licencePlate, seatCount );
	}

	public boolean isRented() {
		return rented;
	}

	public void setRented(boolean rented) {
		this.rented = rented;
	}
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05;

public interface RentalChecks {
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p><a href="#example-testCarIsRented">Example 58, &#8220;验证具有重定义的默认组的对象&#8221;</a> 当做了上述定义后，当你校验 <code>Default</code> 分组时，会同时校验 <code>RentalChecks</code>, <code>CarChecks</code> 分组 <code>RentalCar</code> 。</p>
                        </div>
                        <div id="example-testCarIsRented" class="exampleblock">
                            <div class="title">Example 58. 验证具有重定义的默认组的对象</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">RentalCar rentalCar = new RentalCar( "Morris", "DD-AB-123", 2 );
rentalCar.setPassedVehicleInspection( true );
rentalCar.setRented( true );

Set&lt;ConstraintViolation&lt;RentalCar&gt;&gt; constraintViolations = validator.validate( rentalCar );

assertEquals( 1, constraintViolations.size() );
assertEquals(
		"Wrong message",
		"The car is currently rented out",
		constraintViolations.iterator().next().getMessage()
);

rentalCar.setRented( false );
constraintViolations = validator.validate( rentalCar );

assertEquals( 0, constraintViolations.size() );</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>因为组和组序列定义中不能有循环依赖项，所以不能只是将 Default 添加到为类重新定义 Default 的序列中。相反，必须添加类本身。</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="paragraph">
                            <p><code>Default</code> 分组序列重写对于在其上定义的类是本地的，不会传播到关联的对象。对于本例，这意味着将 <code>DriverChecks</code> 添加到 <code>RentalCar</code> 的默认组序列中，而不会对其他类产生任何效果。只有组 <code>Default</code> 将被传播到驱动程序关联。</p>
                        </div>
                        <div class="paragraph">
                            <p>请注意，您可以通过声明组转换规则来控制传播的组(
                                <a href="#section-group-conversion">Section 5.5, &#8220;分组转化&#8221;</a>)。</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_groupsequenceprovider">
                            <a class="anchor" href="#_groupsequenceprovider"></a>5.4.2. <code>@GroupSequenceProvider</code></h4>
                        <div class="paragraph">
                            <p>除了通过 <code>@GroupSequence</code> 静态重新定义默认组序列之外，Hibernate Validator 还提供了一个 SPI，用于根据对象状态动态重新定义默认组序列。</p>
                        </div>
                        <div class="paragraph">
                            <p>为此，需要实现接口 <code>DefaultGroupSequenceProvider</code> ，并通过 <code>@GroupSequenceProvider</code> 注解向目标类注册该实现。例如，在租车场景中，您可以动态地添加 <code>CarChecks</code> ，如<a href="#example-implementing-using-default-group-sequence-provider">Example 59, &#8220;实现和使用默认的组序列提供程序&#8221;</a></p>
                        </div>
                        <div id="example-implementing-using-default-group-sequence-provider" class="exampleblock">
                            <div class="title">Example 59. 实现和使用默认的组序列提供程序</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05.groupsequenceprovider;

public class RentalCarGroupSequenceProvider
		implements DefaultGroupSequenceProvider&lt;RentalCar&gt; {

	@Override
	public List&lt;Class&lt;?&gt;&gt; getValidationGroups(RentalCar car) {
		List&lt;Class&lt;?&gt;&gt; defaultGroupSequence = new ArrayList&lt;Class&lt;?&gt;&gt;();
		defaultGroupSequence.add( RentalCar.class );

		if ( car != null &amp;&amp; !car.isRented() ) {
			defaultGroupSequence.add( CarChecks.class );
		}

		return defaultGroupSequence;
	}
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05.groupsequenceprovider;

@GroupSequenceProvider(RentalCarGroupSequenceProvider.class)
public class RentalCar extends Car {

	@AssertFalse(message = "The car is currently rented out", groups = RentalChecks.class)
	private boolean rented;

	public RentalCar(String manufacturer, String licencePlate, int seatCount) {
		super( manufacturer, licencePlate, seatCount );
	}

	public boolean isRented() {
		return rented;
	}

	public void setRented(boolean rented) {
		this.rented = rented;
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-group-conversion">
                        <a class="anchor" href="#section-group-conversion"></a>5.5. 分组转化</h3>
                    <div class="paragraph">
                        <p>如果你想校验汽车相关检查和驾驶员检查一起进行怎么办？当然，您可以显式地将所需的组传递给 validate 调用，但是如果您希望将这些验证作为 <code>Default</code> 分组验证的一部分进行呢？这里使用了 <code>@ConvertGroup</code> ，它允许您在级联验证期间使用与最初请求的组不同的组。</p>
                    </div>
                    <div class="paragraph">
                        <p>让我们看看 <a href="#example-group-conversion-dedault-to-driver-checks">Example 60, &#8220;<code>@ConvertGroup</code> 用例&#8221;</a>。这里 <code>@GroupSequence({
CarChecks.class, Car.class })</code> 是修改 <code>Default</code> 分组。 (see <a href="#section-default-group-class">Section 5.4, &#8220;重新定义默认组序列&#8221;</a>). 这里的 <code>@ConvertGroup(from = Default.class, to =
DriverChecks.class)</code> 它确保在对汽车程序关联进行级联验证期间将 <code>Default</code> 分组转化为 <code>DriverChecks</code> 分组。</p>
                    </div>
                    <div id="example-group-conversion-dedault-to-driver-checks" class="exampleblock">
                        <div class="title">Example 60. <code>@ConvertGroup</code> 用例</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05.groupconversion;

public class Driver {

	@NotNull
	private String name;

	@Min(
			value = 18,
			message = "You have to be 18 to drive a car",
			groups = DriverChecks.class
	)
	public int age;

	@AssertTrue(
			message = "You first have to pass the driving test",
			groups = DriverChecks.class
	)
	public boolean hasDrivingLicense;

	public Driver(String name) {
		this.name = name;
	}

	public void passedDrivingTest(boolean b) {
		hasDrivingLicense = b;
	}

	public int getAge() {
		return age;
	}

	public void setAge(int age) {
		this.age = age;
	}

	// getters and setters ...
}</code></pre>
                                </div>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter05.groupconversion;

@GroupSequence({ CarChecks.class, Car.class })
public class Car {

	@NotNull
	private String manufacturer;

	@NotNull
	@Size(min = 2, max = 14)
	private String licensePlate;

	@Min(2)
	private int seatCount;

	@AssertTrue(
			message = "The car has to pass the vehicle inspection first",
			groups = CarChecks.class
	)
	private boolean passedVehicleInspection;

	@Valid
	@ConvertGroup(from = Default.class, to = DriverChecks.class)
	private Driver driver;

	public Car(String manufacturer, String licencePlate, int seatCount) {
		this.manufacturer = manufacturer;
		this.licensePlate = licencePlate;
		this.seatCount = seatCount;
	}

	public boolean isPassedVehicleInspection() {
		return passedVehicleInspection;
	}

	public void setPassedVehicleInspection(boolean passedVehicleInspection) {
		this.passedVehicleInspection = passedVehicleInspection;
	}

	public Driver getDriver() {
		return driver;
	}

	public void setDriver(Driver driver) {
		this.driver = driver;
	}

	// getters and setters ...
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p><a href="#example-group-conversion-test">Example 61, &#8220;测试用例 <code>@ConvertGroup</code>&#8221;</a> 的校验结果是成功的。即使 <code>hasDrivingLicense</code> 的约束属于 <code>DriverChecks</code> 分组，并且 <code>validate()</code> 方法只校验 <code>Default</code>                            分组。</p>
                    </div>
                    <div id="example-group-conversion-test" class="exampleblock">
                        <div class="title">Example 61. 测试用例 <code>@ConvertGroup</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">// create a car and validate. The Driver is still null and does not get validated
Car car = new Car( "VW", "USD-123", 4 );
car.setPassedVehicleInspection( true );
Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );
assertEquals( 0, constraintViolations.size() );

// create a driver who has not passed the driving test
Driver john = new Driver( "John Doe" );
john.setAge( 18 );

// now let's add a driver to the car
car.setDriver( john );
constraintViolations = validator.validate( car );
assertEquals( 1, constraintViolations.size() );
assertEquals(
		"The driver constraint should also be validated as part of the default group",
		constraintViolations.iterator().next().getMessage(),
		"You first have to pass the driving test"
);</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>您可以在任何使用 <code>@Valid</code> 注解的地方，使用分组转化。即关联、方法和构造函数参数以及返回值。可以使用 <code>@ConvertGroup.List</code> 同时指定多种转化。</p>
                    </div>
                    <div class="paragraph">
                        <p>不过，仅在下面的场景不适用:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p><code>@ConvertGroup</code> 只能与 <code>@Valid</code> 结合使用。如果不使用，则引发 <code>ConstraintDeclarationException</code> 。</p>
                            </li>
                            <li>
                                <p>在同一个元素上具有相同的 <code>from</code> 值的多个转换规则是不合法的。在这种情况下，将引发 <code>ConstraintDeclarationException</code> 。</p>
                            </li>
                            <li>
                                <p><code>from</code> 属性不能引用分组序列。在这种情况下会引发 <code>ConstraintDeclarationException</code> 。</p>
                            </li>
                        </ul>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>规则不是递归执行的。使用第一个匹配转换规则，并忽略后续规则。例如，如果一组 `@ConvertGroup`声明 a 到 b，b 到 c，组 a 将被转换为 b 而不是 c。</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="validator-customconstraints">
                <a class="anchor" href="#validator-customconstraints"></a>6. 自定义约束</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>Jakarta Bean Validation API 定义了一整套标准约束注解，如 <code>@NotNull</code>,
                        <code>@Size</code> 等。在这些内置约束不够充分的情况下，可以轻松地创建根据特定校验需求定制的自定义约束。</p>
                </div>
                <div class="sect2">
                    <h3 id="validator-customconstraints-simple">
                        <a class="anchor" href="#validator-customconstraints-simple"></a>6.1. 创建一个简单的约束</h3>
                    <div class="paragraph">
                        <p>要创建自定义约束，需要以下三个步骤:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>创建一个约束注解</p>
                            </li>
                            <li>
                                <p>实现一个校验器</p>
                            </li>
                            <li>
                                <p>定义默认错误消息</p>
                            </li>
                        </ul>
                    </div>
                    <div class="sect3">
                        <h4 id="validator-customconstraints-constraintannotation">
                            <a class="anchor" href="#validator-customconstraints-constraintannotation"></a>6.1.1. 约束注解</h4>
                        <div class="paragraph">
                            <p>本节展示如何编写一个约束注解，该注解可用于确保给定的字符串完全大写或小写。稍后，这个约束将应用于 <a href="#validator-gettingstarted">Chapter 1, <em>快速开始</em></a> 中的 <code>Car</code> 类 <code>licensePlate</code> 字段。确保该字段始终是大写字母字符串。</p>
                        </div>
                        <div class="paragraph">
                            <p>首先需要的是一种表达这两种情况模式的方法。虽然可以使用 <code>String</code> 常量，但更好的方法是为此使用枚举:</p>
                        </div>
                        <div class="exampleblock">
                            <div class="title">Example 62. 枚举 <code>CaseMode</code> 表示大小写两种状态</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06;

public enum CaseMode {
	UPPER,
	LOWER;
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>下一步是定义约束注解。如果你以前从未设计过注解，这看起来可能有点吓人，但实际上并不难:</p>
                        </div>
                        <div id="example-defining-custom-constraint" class="exampleblock">
                            <div class="title">Example 63. 定义 <code>@CheckCase</code> 约束注解</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06;

import static java.lang.annotation.ElementType.ANNOTATION_TYPE;
import static java.lang.annotation.ElementType.FIELD;
import static java.lang.annotation.ElementType.METHOD;
import static java.lang.annotation.ElementType.PARAMETER;
import static java.lang.annotation.ElementType.TYPE_USE;
import static java.lang.annotation.RetentionPolicy.RUNTIME;

@Target({ FIELD, METHOD, PARAMETER, ANNOTATION_TYPE, TYPE_USE })
@Retention(RUNTIME)
@Constraint(validatedBy = CheckCaseValidator.class)
@Documented
@Repeatable(List.class)
public @interface CheckCase {

	String message() default "{org.hibernate.validator.referenceguide.chapter06.CheckCase." +
			"message}";

	Class&lt;?&gt;[] groups() default { };

	Class&lt;? extends Payload&gt;[] payload() default { };

	CaseMode value();

	@Target({ FIELD, METHOD, PARAMETER, ANNOTATION_TYPE })
	@Retention(RUNTIME)
	@Documented
	@interface List {
		CheckCase[] value();
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>使用 <code>@interface</code> 关键字定义注解类型。注解类型的所有属性都以类似于方法的方式声明。Jakarta Bean Validation API 规范要求任何约束注解定义:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>message</code> 属性返回校验失败的默认错误信息。</p>
                                </li>
                                <li>
                                    <p><code>groups</code> 属性允许对分组(see <a href="#chapter-groups">Chapter 5, <em>分组约束</em></a>)约束进行校验。这必须默认为 Class &lt; ? &gt; 类型的空数组.</p>
                                </li>
                                <li>
                                    <p><code>payload</code> 属性可以被Jakarta Bean Validation API的客户端用于将自定义有效负载对象分配给约束。API 本身不使用此属性。自定义有效负载的一个例子是严重性的定义:</p>
                                    <div class="exampleblock">
                                        <div class="content">
                                            <div class="listingblock">
                                                <div class="content">
                                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">public class Severity {
	public interface Info extends Payload {
	}

	public interface Error extends Payload {
	}
}</code></pre>
                                                </div>
                                            </div>
                                            <div class="listingblock">
                                                <div class="content">
                                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">public class ContactDetails {
	@NotNull(message = "Name is mandatory", payload = Severity.Error.class)
	private String name;

	@NotNull(message = "Phone number not specified, but not mandatory",
			payload = Severity.Info.class)
	private String phoneNumber;

	// ...
}</code></pre>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="paragraph">
                                        <p>现在，客户端可以在校验 <code>ContactDetails</code> 实例后，使用 <code>ConstraintViolation.getConstraintDescriptor().getPayload()</code> 访问约束的严重性。并其根据严重性调整其行为。</p>
                                    </div>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>除了这三个强制属性外，还有另一个属性 <code>value</code>，它允许指定所需的 case 模式。<code>value</code> 值是一个特殊的值，如果它是唯一指定的属性，在使用注解时可以省略，例如 <code>@CheckCase(CaseMode.UPPER)</code> 。</p>
                        </div>
                        <div class="paragraph">
                            <p>此外，约束注解还使用了一些元注解:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>@Target({ FIELD, METHOD, PARAMETER, ANNOTATION_TYPE, TYPE_USE})</code>: 定义约束支持的目标元素类型。 <code>@CheckCase</code> 可用于字段 ( <code>FIELD</code>), JavaBeans properties 和返回值 (<code>METHOD</code>), 方法/构造函数参数 (<code>PARAMETER</code>)
                                        和参数化类型的类型参数 (<code>TYPE_USE</code>)。元素类型 <code>ANNOTATION_TYPE</code> 允许 <code>@CheckCase</code> 创建组合约束。</p>
                                    <div class="paragraph">
                                        <p>在创建类级别约束 (see <a href="#validator-usingvalidator-classlevel">Section 2.1.4, &#8220;类层面的约束&#8221;</a>), <code>TYPE</code> 类型必须被支持。针对构造函数返回值的约束需要支持 <code>CONSTRUCTOR</code> 类型。 交叉参数的校验必须支持 <code>METHOD</code> 和 <code>CONSTRUCTOR</code>                                            。</p>
                                    </div>
                                </li>
                                <li>
                                    <p><code>@Retention(RUNTIME)</code>: 指定此类型的注解将在运行时通过反射的方式可用</p>
                                </li>
                                <li>
                                    <p><code>@Constraint(validatedBy = CheckCaseValidator.class)</code>: 标记在使用 <code>@CheckCase</code> 时指定一个指定的validator(校验器)。 如果某个约束可用于多个数据类型，则可以指定多个校验器，每个校验器对应一个数据类型。</p>
                                </li>
                                <li>
                                    <p><code>@Documented</code>: 表示 <code>@CheckCase</code> 的使用将包含在用它注解的元素的 JavaDoc 中。</p>
                                </li>
                                <li>
                                    <p><code>@Repeatable(List.class)</code>: 表示注解可以在同一个地方重复多次，通常使用不同的配置。 <code>List</code> 是包含的注解类型。</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>示例中还显示了这个包含注解类型名为 <code>List</code> 。它允许在同一个元素上指定多个 <code>@CheckCase</code> ，例如使用不同的校验组和消息。虽然可以使用另一个名称，但 Jakarta Bean Validation 范建议使用名称 <code>List</code> 并使注解成为相应约束类型的内部注解。</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-constraint-validator">
                            <a class="anchor" href="#section-constraint-validator"></a>6.1.2. 约束校验器</h4>
                        <div class="paragraph">
                            <p>在定义了注解之后，您需要创建一个约束校验器，它能够校验使用 <code>@CheckCase</code> 的元素。 为此，实现
                                <code>ConstraintValidator</code>，如下所示:</p>
                        </div>
                        <div id="example-constraint-validator" class="exampleblock">
                            <div class="title">Example 64. 实现 <code>@CheckCase</code> 约束的约束校验器</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06;

public class CheckCaseValidator implements ConstraintValidator&lt;CheckCase, String&gt; {

	private CaseMode caseMode;

	@Override
	public void initialize(CheckCase constraintAnnotation) {
		this.caseMode = constraintAnnotation.value();
	}

	@Override
	public boolean isValid(String object, ConstraintValidatorContext constraintContext) {
		if ( object == null ) {
			return true;
		}

		if ( caseMode == CaseMode.UPPER ) {
			return object.equals( object.toUpperCase() );
		}
		else {
			return object.equals( object.toLowerCase() );
		}
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>The <code>ConstraintValidator</code> interface defines two type parameters which are set in the implementation. The first one specifies the annotation type to be validated (<code>CheckCase</code>), the second one the type of
                                elements, which the validator can handle (<code>String</code>). In case a constraint supports several data types, a <code>ConstraintValidator</code> for each allowed type has to be implemented and registered at the constraint
                                annotation as shown above.</p>
                        </div>
                        <div class="paragraph">
                            <p>The implementation of the validator is straightforward. The <code>initialize()</code> method gives you access to the attribute values of the validated constraint and allows you to store them in a field of the validator as shown
                                in the example.</p>
                        </div>
                        <div class="paragraph">
                            <p>The <code>isValid()</code> method contains the actual validation logic. For <code>@CheckCase</code> this is the check whether a given string is either completely lower case or upper case, depending on the case mode retrieved
                                in <code>initialize()</code>. Note that the Jakarta Bean Validation specification recommends to consider null values as being valid. If <code>null</code> is not a valid value for an element, it should be annotated with
                                <code>@NotNull</code> explicitly.
                            </p>
                        </div>
                        <div class="sect4">
                            <h5 id="_the_constraintvalidatorcontext">
                                <a class="anchor" href="#_the_constraintvalidatorcontext"></a>6.1.2.1. The <code>ConstraintValidatorContext</code></h5>
                            <div class="paragraph">
                                <p><a href="#example-constraint-validator">Example 64, &#8220;实现 <code>@CheckCase</code> 约束的约束校验器&#8221;</a> relies on the default error message generation by just returning <code>true</code> or <code>false</code> from the
                                    <code>isValid()</code> method. Using the passed <code>ConstraintValidatorContext</code> object, it is possible to either add additional error messages or completely disable the default error message generation and solely
                                    define custom error messages. The <code>ConstraintValidatorContext</code> API is modeled as fluent interface and is best demonstrated with an example:</p>
                            </div>
                            <div id="example-constraint-validator-context" class="exampleblock">
                                <div class="title">Example 65. Using <code>ConstraintValidatorContext</code> to define custom error messages</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.constraintvalidatorcontext;

public class CheckCaseValidator implements ConstraintValidator&lt;CheckCase, String&gt; {

	private CaseMode caseMode;

	@Override
	public void initialize(CheckCase constraintAnnotation) {
		this.caseMode = constraintAnnotation.value();
	}

	@Override
	public boolean isValid(String object, ConstraintValidatorContext constraintContext) {
		if ( object == null ) {
			return true;
		}

		boolean isValid;
		if ( caseMode == CaseMode.UPPER ) {
			isValid = object.equals( object.toUpperCase() );
		}
		else {
			isValid = object.equals( object.toLowerCase() );
		}

		if ( !isValid ) {
			constraintContext.disableDefaultConstraintViolation();
			constraintContext.buildConstraintViolationWithTemplate(
					"{org.hibernate.validator.referenceguide.chapter06." +
					"constraintvalidatorcontext.CheckCase.message}"
			)
			.addConstraintViolation();
		}

		return isValid;
	}
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p><a href="#example-constraint-validator-context">Example 65, &#8220;Using <code>ConstraintValidatorContext</code> to define custom error messages&#8221;</a> shows how you can disable the default error message generation
                                    and add a custom error message using a specified message template. In this example the use of the <code>ConstraintValidatorContext</code> results in the same error message as the default error message generation.</p>
                            </div>
                            <div class="admonitionblock tip">
                                <table>
                                    <tr>
                                        <td class="icon">
                                            <div class="title">Tip</div>
                                        </td>
                                        <td class="content">
                                            <div class="paragraph">
                                                <p>It is important to add each configured constraint violation by calling <code>addConstraintViolation()</code>. Only after that the new constraint violation will be created.</p>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="paragraph">
                                <p>By default, Expression Language is not enabled for custom violations created in the <code>ConstraintValidatorContext</code>.</p>
                            </div>
                            <div class="paragraph">
                                <p>However, for some advanced requirements, using Expression Language might be necessary.</p>
                            </div>
                            <div class="paragraph">
                                <p>In this case, you need to unwrap the <code>HibernateConstraintValidatorContext</code> and enable Expression Language explicitly. See <a href="#section-hibernateconstraintvalidatorcontext">Section 12.13.1, &#8220;<code>HibernateConstraintValidatorContext</code>&#8221;</a>                                    for more information.</p>
                            </div>
                            <div class="paragraph">
                                <p>Refer to <a href="#section-custom-property-paths">Section 6.2.1, &#8220;Custom property paths&#8221;</a> to learn how to use the <code>ConstraintValidatorContext</code> API to control the property path of constraint violations
                                    for class-level constraints.</p>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="constraint-validator-hibernateconstraintvalidator">
                                <a class="anchor" href="#constraint-validator-hibernateconstraintvalidator"></a>6.1.2.2. The <code>HibernateConstraintValidator</code> extension</h5>
                            <div class="paragraph">
                                <p>Hibernate Validator provides an extension to the <code>ConstraintValidator</code> contract: <code>HibernateConstraintValidator</code>.</p>
                            </div>
                            <div class="paragraph">
                                <p>The purpose of this extension is to provide more contextual information to the <code>initialize()</code> method as, in the current <code>ConstraintValidator</code> contract, only the annotation is passed as parameter.</p>
                            </div>
                            <div class="paragraph">
                                <p>The <code>initialize()</code> method of <code>HibernateConstraintValidator</code> takes two parameters:</p>
                            </div>
                            <div class="ulist">
                                <ul>
                                    <li>
                                        <p>The <code>ConstraintDescriptor</code> of the constraint at hand. You can get access to the annotation using <code>ConstraintDescriptor#getAnnotation()</code>.</p>
                                    </li>
                                    <li>
                                        <p>The <code>HibernateConstraintValidatorInitializationContext</code> which provides useful helpers and contextual information, such as the clock provider or the temporal validation tolerance.</p>
                                    </li>
                                </ul>
                            </div>
                            <div class="paragraph">
                                <p>This extension is marked as incubating so it might be subject to change. The plan is to standardize it and to include it in Jakarta Bean Validation in the future.</p>
                            </div>
                            <div class="paragraph">
                                <p>The example below shows how to base your validators on <code>HibernateConstraintValidator</code>:</p>
                            </div>
                            <div id="example-constraint-validator-hibernateconstraintvalidator" class="exampleblock">
                                <div class="title">Example 66. Using the <code>HibernateConstraintValidator</code> contract</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06;

public class MyFutureValidator implements HibernateConstraintValidator&lt;MyFuture, Instant&gt; {

	private Clock clock;

	private boolean orPresent;

	@Override
	public void initialize(ConstraintDescriptor&lt;MyFuture&gt; constraintDescriptor,
			HibernateConstraintValidatorInitializationContext initializationContext) {
		this.orPresent = constraintDescriptor.getAnnotation().orPresent();
		this.clock = initializationContext.getClockProvider().getClock();
	}

	@Override
	public boolean isValid(Instant instant, ConstraintValidatorContext constraintContext) {
		//...

		return false;
	}
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="admonitionblock warning">
                                <table>
                                    <tr>
                                        <td class="icon">
                                            <div class="title">Warning</div>
                                        </td>
                                        <td class="content">
                                            <div class="paragraph">
                                                <p>You should only implement one of the <code>initialize()</code> methods. Be aware that both are called when initializing the validator.</p>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="constraint-validator-payload">
                                <a class="anchor" href="#constraint-validator-payload"></a>6.1.2.3. Passing a payload to the constraint validator</h5>
                            <div class="paragraph">
                                <p>From time to time, you might want to condition the constraint validator behavior on some external parameters.</p>
                            </div>
                            <div class="paragraph">
                                <p>For instance, your zip code validator could vary depending on the locale of your application instance if you have one instance per country. Another requirement could be to have different behaviors on specific environments:
                                    the staging environment may not have access to some external production resources necessary for the correct functioning of a validator.</p>
                            </div>
                            <div class="paragraph">
                                <p>The notion of constraint validator payload was introduced for all these use cases. It is an object passed from the <code>Validator</code> instance to each constraint validator via the <code>HibernateConstraintValidatorContext</code>.</p>
                            </div>
                            <div class="paragraph">
                                <p>The example below shows how to set a constraint validator payload during the <code>ValidatorFactory</code> initialization. Unless you override this default value, all the <code>Validator</code>s created by this <code>ValidatorFactory</code>                                    will have this constraint validator payload value set.</p>
                            </div>
                            <div id="example-constraint-validator-payload-definition-validatorfactory" class="exampleblock">
                                <div class="title">Example 67. Defining a constraint validator payload during the <code>ValidatorFactory</code> initialization</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
		.configure()
		.constraintValidatorPayload( "US" )
		.buildValidatorFactory();

Validator validator = validatorFactory.getValidator();</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Another option is to set the constraint validator payload per <code>Validator</code> using a context:</p>
                            </div>
                            <div id="example-constraint-validator-payload-definition-validatorcontext" class="exampleblock">
                                <div class="title">Example 68. Defining a constraint validator payload using a <code>Validator</code> context</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">HibernateValidatorFactory hibernateValidatorFactory = Validation.byDefaultProvider()
		.configure()
		.buildValidatorFactory()
		.unwrap( HibernateValidatorFactory.class );

Validator validator = hibernateValidatorFactory.usingContext()
		.constraintValidatorPayload( "US" )
		.getValidator();

// [...] US specific validation checks

validator = hibernateValidatorFactory.usingContext()
		.constraintValidatorPayload( "FR" )
		.getValidator();

// [...] France specific validation checks</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Once you have set the constraint validator payload, it can be used in your constraint validators as shown in the example below:</p>
                            </div>
                            <div id="example-constraint-validator-payload-usage" class="exampleblock">
                                <div class="title">Example 69. Using the constraint validator payload in a constraint validator</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.constraintvalidatorpayload;

public class ZipCodeValidator implements ConstraintValidator&lt;ZipCode, String&gt; {

	public String countryCode;

	@Override
	public boolean isValid(String object, ConstraintValidatorContext constraintContext) {
		if ( object == null ) {
			return true;
		}

		boolean isValid = false;

		String countryCode = constraintContext
				.unwrap( HibernateConstraintValidatorContext.class )
				.getConstraintValidatorPayload( String.class );

		if ( "US".equals( countryCode ) ) {
			// checks specific to the United States
		}
		else if ( "FR".equals( countryCode ) ) {
			// checks specific to France
		}
		else {
			// ...
		}

		return isValid;
	}
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p><code>HibernateConstraintValidatorContext#getConstraintValidatorPayload()</code> has a type parameter and returns the payload only if the payload is of the given type.</p>
                            </div>
                            <div class="admonitionblock note">
                                <table>
                                    <tr>
                                        <td class="icon">
                                            <div class="title">Note</div>
                                        </td>
                                        <td class="content">
                                            <div class="paragraph">
                                                <p>It is important to note that the constraint validator payload is different from the dynamic payload you can include in the constraint violation raised.</p>
                                            </div>
                                            <div class="paragraph">
                                                <p>The whole purpose of this constraint validator payload is to be used to condition the behavior of your constraint validators. It is not included in the constraint violations, unless a specific <code>ConstraintValidator</code>                                                    implementation passes on the payload to emitted constraint violations by using the <a href="#section-dynamic-payload">constraint violation dynamic payload mechanism</a>.</p>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="validator-customconstraints-errormessage">
                            <a class="anchor" href="#validator-customconstraints-errormessage"></a>6.1.3. The error message</h4>
                        <div class="paragraph">
                            <p>The last missing building block is an error message which should be used in case a <code>@CheckCase</code> constraint is violated. To define this, create a file <em>ValidationMessages.properties</em> with the following contents
                                (see also <a href="#section-message-interpolation">Section 4.1, &#8220;默认消息插值&#8221;</a>):</p>
                        </div>
                        <div class="exampleblock">
                            <div class="title">Example 70. Defining a custom error message for the <code>CheckCase</code> constraint</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre>org.hibernate.validator.referenceguide.chapter06.CheckCase.message=Case mode must be {value}.</pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>If a validation error occurs, the validation runtime will use the default value, that you specified for the message attribute of the <code>@CheckCase</code> annotation to look up the error message in this resource bundle.
                            </p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="validator-customconstraints-using">
                            <a class="anchor" href="#validator-customconstraints-using"></a>6.1.4. Using the constraint</h4>
                        <div class="paragraph">
                            <p>You can now use the constraint in the <code>Car</code> class from the <a href="#validator-gettingstarted">Chapter 1, <em>快速开始</em></a> chapter to specify that the <code>licensePlate</code> field should only contain upper-case
                                strings:</p>
                        </div>
                        <div id="example-car-with-checkcase" class="exampleblock">
                            <div class="title">Example 71. Applying the <code>@CheckCase</code> constraint</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06;

public class Car {

	@NotNull
	private String manufacturer;

	@NotNull
	@Size(min = 2, max = 14)
	@CheckCase(CaseMode.UPPER)
	private String licensePlate;

	@Min(2)
	private int seatCount;

	public Car(String manufacturer, String licencePlate, int seatCount) {
		this.manufacturer = manufacturer;
		this.licensePlate = licencePlate;
		this.seatCount = seatCount;
	}

	//getters and setters ...
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>Finally, <a href="#example-using-checkcase">Example 72, &#8220;Validating objects with the <code>@CheckCase</code> constraint&#8221;</a> demonstrates how validating a <code>Car</code> instance with an invalid license plate
                                causes the <code>@CheckCase</code> constraint to be violated.</p>
                        </div>
                        <div id="example-using-checkcase" class="exampleblock">
                            <div class="title">Example 72. Validating objects with the <code>@CheckCase</code> constraint</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">//invalid license plate
Car car = new Car( "Morris", "dd-ab-123", 4 );
Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =
		validator.validate( car );
assertEquals( 1, constraintViolations.size() );
assertEquals(
		"Case mode must be UPPER.",
		constraintViolations.iterator().next().getMessage()
);

//valid license plate
car = new Car( "Morris", "DD-AB-123", 4 );

constraintViolations = validator.validate( car );

assertEquals( 0, constraintViolations.size() );</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-class-level-constraints">
                        <a class="anchor" href="#section-class-level-constraints"></a>6.2. Class-level constraints</h3>
                    <div class="paragraph">
                        <p>As discussed earlier, constraints can also be applied on the class level to validate the state of an entire object. Class-level constraints are defined in the same way as are property constraints.
                            <a href="#example-implementing-classlevel-constraint">Example 73, &#8220;Implementing a class-level constraint&#8221;</a> shows constraint annotation and validator of the
                            <code>@ValidPassengerCount</code> constraint you already saw in use in <a href="#example-class-level">Example 19, &#8220;类级别约束&#8221;</a>.</p>
                    </div>
                    <div id="example-implementing-classlevel-constraint" class="exampleblock">
                        <div class="title">Example 73. Implementing a class-level constraint</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.classlevel;

@Target({ TYPE, ANNOTATION_TYPE })
@Retention(RUNTIME)
@Constraint(validatedBy = { ValidPassengerCountValidator.class })
@Documented
public @interface ValidPassengerCount {

	String message() default "{org.hibernate.validator.referenceguide.chapter06.classlevel." +
			"ValidPassengerCount.message}";

	Class&lt;?&gt;[] groups() default { };

	Class&lt;? extends Payload&gt;[] payload() default { };
}</code></pre>
                                </div>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.classlevel;

public class ValidPassengerCountValidator
		implements ConstraintValidator&lt;ValidPassengerCount, Car&gt; {

	@Override
	public void initialize(ValidPassengerCount constraintAnnotation) {
	}

	@Override
	public boolean isValid(Car car, ConstraintValidatorContext context) {
		if ( car == null ) {
			return true;
		}

		return car.getPassengers().size() &lt;= car.getSeatCount();
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>As the example demonstrates, you need to use the element type <code>TYPE</code> in the <code>@Target</code> annotation. This allows the constraint to be put on type definitions. The validator of the constraint in the example receives
                            a <code>Car</code> in the <code>isValid()</code> method and can access the complete object state to decide whether the given instance is valid or not.</p>
                    </div>
                    <div class="sect3">
                        <h4 id="section-custom-property-paths">
                            <a class="anchor" href="#section-custom-property-paths"></a>6.2.1. Custom property paths</h4>
                        <div class="paragraph">
                            <p>By default the constraint violation for a class-level constraint is reported on the level of the annotated type, e.g. <code>Car</code>.</p>
                        </div>
                        <div class="paragraph">
                            <p>In some cases it is preferable though that the violation&#8217;s property path refers to one of the involved properties. For instance you might want to report the <code>@ValidPassengerCount</code> constraint against the passengers
                                property instead of the <code>Car</code> bean.</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="#example-custom-error">Example 74, &#8220;Adding a new <code>ConstraintViolation</code> with custom property path&#8221;</a> shows how this can be done by using the constraint validator context passed to <code>isValid()</code>                                to build a custom constraint violation with a property node for the property passengers. Note that you also could add several property nodes, pointing to a sub-entity of the validated bean.</p>
                        </div>
                        <div id="example-custom-error" class="exampleblock">
                            <div class="title">Example 74. Adding a new <code>ConstraintViolation</code> with custom property path</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.custompath;

public class ValidPassengerCountValidator
		implements ConstraintValidator&lt;ValidPassengerCount, Car&gt; {

	@Override
	public void initialize(ValidPassengerCount constraintAnnotation) {
	}

	@Override
	public boolean isValid(Car car, ConstraintValidatorContext constraintValidatorContext) {
		if ( car == null ) {
			return true;
		}

		boolean isValid = car.getPassengers().size() &lt;= car.getSeatCount();

		if ( !isValid ) {
			constraintValidatorContext.disableDefaultConstraintViolation();
			constraintValidatorContext
					.buildConstraintViolationWithTemplate( "{my.custom.template}" )
					.addPropertyNode( "passengers" ).addConstraintViolation();
		}

		return isValid;
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-cross-parameter-constraints">
                        <a class="anchor" href="#section-cross-parameter-constraints"></a>6.3. Cross-parameter constraints</h3>
                    <div class="paragraph">
                        <p>Jakarta Bean Validation distinguishes between two different kinds of constraints.</p>
                    </div>
                    <div class="paragraph">
                        <p>Generic constraints (which have been discussed so far) apply to the annotated element, e.g. a type, field, container element, method parameter or return value etc. Cross-parameter constraints, in contrast, apply to the array of
                            parameters of a method or constructor and can be used to express validation logic which depends on several parameter values.</p>
                    </div>
                    <div class="paragraph">
                        <p>In order to define a cross-parameter constraint, its validator class must be annotated with
                            <code>@SupportedValidationTarget(ValidationTarget.PARAMETERS)</code>. The type parameter <code>T</code> from the
                            <code>ConstraintValidator</code> interface must resolve to either <code>Object</code> or <code>Object[]</code> in order to receive the array of method/constructor arguments in the <code>isValid()</code> method.</p>
                    </div>
                    <div class="paragraph">
                        <p>The following example shows the definition of a cross-parameter constraint which can be used to check that two <code>Date</code> parameters of a method are in the correct order:</p>
                    </div>
                    <div class="exampleblock">
                        <div class="title">Example 75. Cross-parameter constraint</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.crossparameter;

@Constraint(validatedBy = ConsistentDateParametersValidator.class)
@Target({ METHOD, CONSTRUCTOR, ANNOTATION_TYPE })
@Retention(RUNTIME)
@Documented
public @interface ConsistentDateParameters {

	String message() default "{org.hibernate.validator.referenceguide.chapter04." +
			"crossparameter.ConsistentDateParameters.message}";

	Class&lt;?&gt;[] groups() default { };

	Class&lt;? extends Payload&gt;[] payload() default { };
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The definition of a cross-parameter constraint isn&#8217;t any different from defining a generic constraint, i.e. it must specify the members <code>message()</code>, <code>groups()</code> and <code>payload()</code> and be annotated
                            with
                            <code>@Constraint</code>. This meta annotation also specifies the corresponding validator, which is shown in
                            <a href="#example-cross-parameter-validator">Example 76, &#8220;Generic and cross-parameter constraint&#8221;</a>. Note that besides the element types <code>METHOD</code> and <code>CONSTRUCTOR</code> also <code>ANNOTATION_TYPE</code>                            is specified as target of the annotation, in order to enable the creation of composed constraints based on <code>@ConsistentDateParameters</code> (see
                            <a href="#section-constraint-composition">Section 6.4, &#8220;Constraint composition&#8221;</a>).</p>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>Cross-parameter constraints are specified directly on the declaration of a method or constructor, which is also the case for return value constraints. In order to improve code readability, it is therefore recommended
                                            to choose constraint names - such as <code>@ConsistentDateParameters</code> - which make the constraint target apparent.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div id="example-cross-parameter-validator" class="exampleblock">
                        <div class="title">Example 76. Generic and cross-parameter constraint</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.crossparameter;

@SupportedValidationTarget(ValidationTarget.PARAMETERS)
public class ConsistentDateParametersValidator implements
		ConstraintValidator&lt;ConsistentDateParameters, Object[]&gt; {

	@Override
	public void initialize(ConsistentDateParameters constraintAnnotation) {
	}

	@Override
	public boolean isValid(Object[] value, ConstraintValidatorContext context) {
		if ( value.length != 2 ) {
			throw new IllegalArgumentException( "Illegal method signature" );
		}

		//leave null-checking to @NotNull on individual parameters
		if ( value[0] == null || value[1] == null ) {
			return true;
		}

		if ( !( value[0] instanceof Date ) || !( value[1] instanceof Date ) ) {
			throw new IllegalArgumentException(
					"Illegal method signature, expected two " +
							"parameters of type Date."
			);
		}

		return ( (Date) value[0] ).before( (Date) value[1] );
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>As discussed above, the validation target <code>PARAMETERS</code> must be configured for a cross-parameter validator by using the <code>@SupportedValidationTarget</code> annotation. Since a cross-parameter constraint could be applied
                            to any method or constructor, it is considered a best practice to check for the expected number and types of parameters in the validator implementation.</p>
                    </div>
                    <div class="paragraph">
                        <p>As with generic constraints, <code>null</code> parameters should be considered valid and <code>@NotNull</code> on the individual parameters should be used to make sure that parameters are not <code>null</code>.</p>
                    </div>
                    <div class="admonitionblock tip">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Tip</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>Similar to class-level constraints, you can create custom constraint violations on single parameters instead of all parameters when validating a cross-parameter constraint. Just obtain a node builder from the <code>ConstraintValidatorContext</code>                                            passed to <code>isValid()</code> and add a parameter node by calling
                                            <code>addParameterNode()</code>. In the example you could use this to create a constraint violation on the end date parameter of the validated method.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>In rare situations a constraint is both, generic and cross-parameter. This is the case if a constraint has a validator class which is annotated with
                            <code>@SupportedValidationTarget({ValidationTarget.PARAMETERS, ValidationTarget.ANNOTATED_ELEMENT})</code> or if it has a generic and a cross-parameter validator class.</p>
                    </div>
                    <div class="paragraph">
                        <p>When declaring such a constraint on a method which has parameters and also a return value, the intended constraint target can&#8217;t be determined. Constraints which are generic and cross-parameter at the same time must therefore
                            define a member <code>validationAppliesTo()</code> which allows the constraint user to specify the constraint&#8217;s target as shown in <a href="#example-dual-cross-parameter-constraint">Example 77, &#8220;Generic and cross-parameter constraint&#8221;</a>.</p>
                    </div>
                    <div id="example-dual-cross-parameter-constraint" class="exampleblock">
                        <div class="title">Example 77. Generic and cross-parameter constraint</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.crossparameter;

@Constraint(validatedBy = {
		ScriptAssertObjectValidator.class,
		ScriptAssertParametersValidator.class
})
@Target({ TYPE, FIELD, PARAMETER, METHOD, CONSTRUCTOR, ANNOTATION_TYPE })
@Retention(RUNTIME)
@Documented
public @interface ScriptAssert {

	String message() default "{org.hibernate.validator.referenceguide.chapter04." +
			"crossparameter.ScriptAssert.message}";

	Class&lt;?&gt;[] groups() default { };

	Class&lt;? extends Payload&gt;[] payload() default { };

	String script();

	ConstraintTarget validationAppliesTo() default ConstraintTarget.IMPLICIT;
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The <code>@ScriptAssert</code> constraint has two validators (not shown), a generic and a cross-parameter one and thus defines the member <code>validationAppliesTo()</code>. The default value <code>IMPLICIT</code> allows to derive
                            the target automatically in situations where this is possible (e.g. if the constraint is declared on a field or on a method which has parameters but no return value).</p>
                    </div>
                    <div class="paragraph">
                        <p>If the target can not be determined implicitly, it must be set by the user to either <code>PARAMETERS</code> or
                            <code>RETURN_VALUE</code> as shown in <a href="#example-dual-cross-parameter-constraint-usage">Example 78, &#8220;Specifying the target for a generic and cross-parameter constraint&#8221;</a>.</p>
                    </div>
                    <div id="example-dual-cross-parameter-constraint-usage" class="exampleblock">
                        <div class="title">Example 78. Specifying the target for a generic and cross-parameter constraint</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">@ScriptAssert(script = "arg1.size() &lt;= arg0", validationAppliesTo = ConstraintTarget.PARAMETERS)
public Car buildCar(int seatCount, List&lt;Passenger&gt; passengers) {
	//...
	return null;
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-constraint-composition">
                        <a class="anchor" href="#section-constraint-composition"></a>6.4. Constraint composition</h3>
                    <div class="paragraph">
                        <p>Looking at the <code>licensePlate</code> field of the <code>Car</code> class in <a href="#example-car-with-checkcase">Example 71, &#8220;Applying the <code>@CheckCase</code> constraint&#8221;</a>, you see three constraint annotations
                            already. In more complex scenarios, where even more constraints could be applied to one element, this might easily become a bit confusing. Furthermore, if there was a <code>licensePlate</code> field in another class, you would
                            have to copy all constraint declarations to the other class as well, violating the DRY principle.</p>
                    </div>
                    <div class="paragraph">
                        <p>You can address this kind of problem by creating higher level constraints, composed from several basic constraints. <a href="#example-composed-constraint">Example 79, &#8220;Creating a composing constraint <code>@ValidLicensePlate</code>&#8221;</a>                            shows a composed constraint annotation which comprises the constraints <code>@NotNull</code>, <code>@Size</code> and <code>@CheckCase</code>:</p>
                    </div>
                    <div id="example-composed-constraint" class="exampleblock">
                        <div class="title">Example 79. Creating a composing constraint <code>@ValidLicensePlate</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.constraintcomposition;

@NotNull
@Size(min = 2, max = 14)
@CheckCase(CaseMode.UPPER)
@Target({ METHOD, FIELD, ANNOTATION_TYPE, TYPE_USE })
@Retention(RUNTIME)
@Constraint(validatedBy = { })
@Documented
public @interface ValidLicensePlate {

	String message() default "{org.hibernate.validator.referenceguide.chapter06." +
			"constraintcomposition.ValidLicensePlate.message}";

	Class&lt;?&gt;[] groups() default { };

	Class&lt;? extends Payload&gt;[] payload() default { };
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>To create a composed constraint, simply annotate the constraint declaration with its comprising constraints. If the composed constraint itself requires a validator, this validator is to be specified within the <code>@Constraint</code>                            annotation. For composed constraints which don&#8217;t need an additional validator such as <code>@ValidLicensePlate</code>, just set <code>validatedBy()</code> to an empty array.</p>
                    </div>
                    <div class="paragraph">
                        <p>Using the new composed constraint at the <code>licensePlate</code> field is fully equivalent to the previous version, where the three constraints were declared directly at the field itself:</p>
                    </div>
                    <div class="exampleblock">
                        <div class="title">Example 80. Application of composing constraint <code>ValidLicensePlate</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.constraintcomposition;

public class Car {

	@ValidLicensePlate
	private String licensePlate;

	//...
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The set of <code>ConstraintViolation</code>s retrieved when validating a <code>Car</code> instance will contain an entry for each violated composing constraint of the <code>@ValidLicensePlate</code> constraint. If you rather prefer
                            a single <code>ConstraintViolation</code> in case any of the composing constraints is violated, the
                            <code>@ReportAsSingleViolation</code> meta constraint can be used as follows:</p>
                    </div>
                    <div class="exampleblock">
                        <div class="title">Example 81. Using @ReportAsSingleViolation</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter06.constraintcomposition.reportassingle;

//...
@ReportAsSingleViolation
public @interface ValidLicensePlate {

	String message() default "{org.hibernate.validator.referenceguide.chapter06." +
			"constraintcomposition.reportassingle.ValidLicensePlate.message}";

	Class&lt;?&gt;[] groups() default { };

	Class&lt;? extends Payload&gt;[] payload() default { };
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="chapter-valueextraction">
                <a class="anchor" href="#chapter-valueextraction"></a>7. Value extraction</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>Value extraction is the process of extracting values from a container so that they can be validated.</p>
                </div>
                <div class="paragraph">
                    <p>It is used when dealing with <a href="#container-element-constraints">container element
constraints</a> and <a href="#example-cascaded-validation-list">cascaded validation inside
containers</a>.</p>
                </div>
                <div class="sect2">
                    <h3 id="section-valueextraction-builtinvalueextractors">
                        <a class="anchor" href="#section-valueextraction-builtinvalueextractors"></a>7.1. Built-in value extractors</h3>
                    <div class="paragraph">
                        <p>Hibernate Validator comes with built-in value extractors for the usual Java container types so, except if you are using your own custom container types (or the ones of external libraries such as <a href="https://github.com/google/guava">Guava</a>'s
                            <code>Multimap</code>), you should not have to add your own value extractors.</p>
                    </div>
                    <div class="paragraph">
                        <p>Built-in value extractors are present for all the following container types:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p><code>java.util.Iterable</code>;</p>
                            </li>
                            <li>
                                <p><code>java.util.List</code>;</p>
                            </li>
                            <li>
                                <p><code>java.util.Map</code>: for keys and values;</p>
                            </li>
                            <li>
                                <p><code>java.util.Optional</code>, <code>java.util.OptionalInt</code>, <code>java.util.OptionalLong</code> and <code>java.util.OptionalDouble</code>;</p>
                            </li>
                            <li>
                                <p>{javafxDocsUrl}[JavaFX]'s <code>ObservableValue</code> (see <a href="#section-valueextraction-javafx">Section 7.4, &#8220;JavaFX value extractors&#8221;</a> for more details).</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>The complete list of built-in value extractors with all the details on how they behave can be found in the {bvSpecUrl}#valueextractordefinition-builtinvalueextractors[Jakarta Bean Validation specification].</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_implementing_a_valueextractor">
                        <a class="anchor" href="#_implementing_a_valueextractor"></a>7.2. Implementing a <code>ValueExtractor</code></h3>
                    <div class="paragraph">
                        <p>To extract values from a custom container, one needs to implement a <code>ValueExtractor</code>.</p>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>Implementing a <code>ValueExtractor</code> is not enough, you also need to register it. See <a href="#section-valueextraction-registeringvalueextractor">Section 7.5, &#8220;Registering a <code>ValueExtractor</code>&#8221;</a>                                            for more details.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p><code>ValueExtractor</code> is a very simple API as the only purpose of a value extractor is to provide the extracted values to a <code>ValueReceiver</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p>For instance, let&#8217;s consider the case of Guava&#8217;s <code>Optional</code>. It is an easy example as we can shape its value extractor after the <code>java.util.Optional</code> one:</p>
                    </div>
                    <div id="example-valueextraction-guava-optional-valueextractor" class="exampleblock">
                        <div class="title">Example 82. A <code>ValueExtractor</code> for Guava&#8217;s <code>Optional</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter07.valueextractor;

public class OptionalValueExtractor
		implements ValueExtractor&lt;Optional&lt;@ExtractedValue ?&gt;&gt; {

	@Override
	public void extractValues(Optional&lt;?&gt; originalValue, ValueReceiver receiver) {
		receiver.value( null, originalValue.orNull() );
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Some explanations are in order:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>The <code>@ExtractedValue</code> annotation marks the type argument under consideration: it is going to be used to resolve the type of the validated value;</p>
                            </li>
                            <li>
                                <p>We use the <code>value()</code> method of the receiver as <code>Optional</code> is a pure wrapper type;</p>
                            </li>
                            <li>
                                <p>We don&#8217;t want to add a node to the property path of the constraint violation as we want the violation to be reported as if it were directly on the property so we pass a <code>null</code> node name to <code>value()</code>.</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>A more interesting example is the case of Guava&#8217;s <code>Multimap</code>: we would like to be able to validate both the keys and the values of this container type.</p>
                    </div>
                    <div class="paragraph">
                        <p>Let&#8217;s first consider the case of the values. A value extractor extracting them is required:</p>
                    </div>
                    <div id="example-valueextraction-guava-multimap-value-valueextractor" class="exampleblock">
                        <div class="title">Example 83. A <code>ValueExtractor</code> for <code>Multimap</code> values</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter07.valueextractor;

public class MultimapValueValueExtractor
		implements ValueExtractor&lt;Multimap&lt;?, @ExtractedValue ?&gt;&gt; {

	@Override
	public void extractValues(Multimap&lt;?, ?&gt; originalValue, ValueReceiver receiver) {
		for ( Entry&lt;?, ?&gt; entry : originalValue.entries() ) {
			receiver.keyedValue( "&lt;multimap value&gt;", entry.getKey(), entry.getValue() );
		}
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>It allows to validate constraints for the values of the <code>Multimap</code>:</p>
                    </div>
                    <div class="exampleblock">
                        <div class="title">Example 84. Constraints on the values of a <code>Multimap</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">private Multimap&lt;String, @NotBlank String&gt; map1;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Another value extractor is required to be able to put constraints on the keys of a <code>Multimap</code>:</p>
                    </div>
                    <div id="example-valueextraction-guava-multimap-key-valueextractor" class="exampleblock">
                        <div class="title">Example 85. A <code>ValueExtractor</code> for <code>Multimap</code> keys</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter07.valueextractor;

public class MultimapKeyValueExtractor
		implements ValueExtractor&lt;Multimap&lt;@ExtractedValue ?, ?&gt;&gt; {

	@Override
	public void extractValues(Multimap&lt;?, ?&gt; originalValue, ValueReceiver receiver) {
		for ( Object key : originalValue.keySet() ) {
			receiver.keyedValue( "&lt;multimap key&gt;", key, key );
		}
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Once these two value extractors are registered, you can declare constraints on the keys and values of a <code>Multimap</code>:</p>
                    </div>
                    <div class="exampleblock">
                        <div class="title">Example 86. Constraints on the keys and values of a <code>Multimap</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">private Multimap&lt;@NotBlank String, @NotBlank String&gt; map2;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The differences between the two value extractors may be a bit subtle at a first glance so let&#8217;s shed some light on them:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>The <code>@ExtractedValue</code> annotation marks the targeted type argument (either
                                    <code>K</code> or <code>V</code> in this case).</p>
                            </li>
                            <li>
                                <p>We use different node names (<code>&lt;multimap key&gt;</code> vs. <code>&lt;multimap value&gt;</code>).</p>
                            </li>
                            <li>
                                <p>In one case, we pass the values to the receiver (third argument of the
                                    <code>keyedValue()</code> call), in the other, we pass the keys.</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>Depending on your container type, you should choose the <code>ValueReceiver</code> method fitting the best:</p>
                    </div>
                    <div class="dlist">
                        <dl>
                            <dt class="hdlist1"><code>value()</code></dt>
                            <dd>
                                <p>for a simple wrapping container - it is used for <code>Optional</code>s</p>
                            </dd>
                            <dt class="hdlist1"><code>iterableValue()</code></dt>
                            <dd>
                                <p>for an iterable container - it is used for <code>Set</code>s</p>
                            </dd>
                            <dt class="hdlist1"><code>indexedValue()</code></dt>
                            <dd>
                                <p>for a container containing indexed values - it is used for <code>List</code>s</p>
                            </dd>
                            <dt class="hdlist1"><code>keyedValue()</code></dt>
                            <dd>
                                <p>for a container containing keyed values - it is used for <code>Map</code>s. It is used for both the keys and the values. In the case of keys, the key is also passed as the validated value.</p>
                            </dd>
                        </dl>
                    </div>
                    <div class="paragraph">
                        <p>For all these methods, you need to pass a node name: it is the name included in the node added to the property path of the constraint violation. As mentioned earlier, if the node name is <code>null</code>, no node is added to the
                            property path: it is be useful for pure wrapper types similar to <code>Optional</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p>The choice of the method used is important as it adds contextual information to the property path of the constraint violation e.g. the index or the key of the validated value.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_non_generic_containers">
                        <a class="anchor" href="#_non_generic_containers"></a>7.3. Non generic containers</h3>
                    <div class="paragraph">
                        <p>You might have noticed that, until now, we only implemented value extractors for generic containers.</p>
                    </div>
                    <div class="paragraph">
                        <p>Hibernate Validator also supports value extraction for non generic containers.</p>
                    </div>
                    <div class="paragraph">
                        <p>Let&#8217;s take the case of <code>java.util.OptionalInt</code> which wraps a primitive <code>int</code> into an <code>Optional</code>-like container.</p>
                    </div>
                    <div class="paragraph">
                        <p>A first attempt at a value extractor for <code>OptionalInt</code> would look like:</p>
                    </div>
                    <div id="example-valueextraction-optionalint-valueextractor" class="exampleblock">
                        <div class="title">Example 87. A <code>ValueExtractor</code> for <code>OptionalInt</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter07.nongeneric;

public class OptionalIntValueExtractor
		implements ValueExtractor&lt;@ExtractedValue(type = Integer.class) OptionalInt&gt; {

	@Override
	public void extractValues(OptionalInt originalValue, ValueReceiver receiver) {
		receiver.value( null, originalValue.isPresent() ? originalValue.getAsInt() : null );
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>There is an obvious thing missing for a non generic container: we don&#8217;t have a type parameter. It has two consequences:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>we cannot determine the type of the validated value using the type argument;</p>
                            </li>
                            <li>
                                <p>we cannot add constraints on the type argument (e.g. <code>Container&lt;@NotNull String&gt;</code>).</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>First things first, we need a way to tell Hibernate Validator that the value extracted from an <code>OptionalInt</code> is of type <code>Integer</code>. As you can see in the above example, the <code>type</code> attribute of the
                            <code>@ExtractedValue</code> annotation allows to provide this information to the validation engine.</p>
                    </div>
                    <div class="paragraph">
                        <p>Then you have to tell the validation engine that the <code>Min</code> constraint you want to add to the <code>OptionalInt</code> property relates to the wrapped value and not the wrapper.</p>
                    </div>
                    <div class="paragraph">
                        <p>Jakarta Bean Validation provides the <code>Unwrapping.Unwrap</code> payload for this situation:</p>
                    </div>
                    <div id="example-valueextraction-optionalint-unwrapping" class="exampleblock">
                        <div class="title">Example 88. Using <code>Unwrapping.Unwrap</code> payload</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">@Min(value = 5, payload = Unwrapping.Unwrap.class)
private OptionalInt optionalInt1;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>If we take a step back, most - if not all - the constraints we would like to add to an
                            <code>OptionalInt</code> property would be applied to the wrapped value so having a way to make it the default would be nice.</p>
                    </div>
                    <div class="paragraph">
                        <p>This is exactly what the <code>@UnwrapByDefault</code> annotation is for:</p>
                    </div>
                    <div id="example-valueextraction-optionalint-unwrapbydefault-valueextractor" class="exampleblock">
                        <div class="title">Example 89. A <code>ValueExtractor</code> for <code>OptionalInt</code> marked with <code>@UnwrapByDefault</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter07.nongeneric;

@UnwrapByDefault
public class UnwrapByDefaultOptionalIntValueExtractor
		implements ValueExtractor&lt;@ExtractedValue(type = Integer.class) OptionalInt&gt; {

	@Override
	public void extractValues(OptionalInt originalValue, ValueReceiver receiver) {
		receiver.value( null, originalValue.isPresent() ? originalValue.getAsInt() : null );
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>When declaring this value extractor for <code>OptionalInt</code>, constraint annotations will by default be applied to the wrapped value:</p>
                    </div>
                    <div id="example-valueextraction-optionalint-implicitunwrapping" class="exampleblock">
                        <div class="title">Example 90. Implicit unwrapping thanks to <code>@UnwrapByDefault</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">@Min(5)
private OptionalInt optionalInt2;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Note that you can still declare an annotation for the wrapper itself by using the <code>Unwrapping.Skip</code> payload:</p>
                    </div>
                    <div id="example-valueextraction-optionalint-avoid-implicitunwrapping" class="exampleblock">
                        <div class="title">Example 91. Avoid implicit unwrapping with <code>Unwrapping.Skip</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">@NotNull(payload = Unwrapping.Skip.class)
@Min(5)
private OptionalInt optionalInt3;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>The <code>@UnwrapByDefault</code> value extractor for <code>OptionalInt</code> is part of the built-in value extractors: there is no need to add one.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-valueextraction-javafx">
                        <a class="anchor" href="#section-valueextraction-javafx"></a>7.4. JavaFX value extractors</h3>
                    <div class="paragraph">
                        <p>Bean properties in JavaFX are typically not of simple data types like <code>String</code> or <code>int</code>, but are wrapped in <code>Property</code> types which allows to make them observable, use them for data binding etc.</p>
                    </div>
                    <div class="paragraph">
                        <p>Thus, value extraction is required to be able to apply constraints on the wrapped values.</p>
                    </div>
                    <div class="paragraph">
                        <p>The JavaFX <code>ObservableValue</code> value extractor is marked with <code>@UnwrapByDefault</code>. As such, the constraints hosted on the container target the wrapped value by default.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>Thus, you can constrain a <code>StringProperty</code> as below:</p>
                    </div>
                    <div class="exampleblock">
                        <div class="title">Example 92. Constraining a <code>StringProperty</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">@NotBlank
private StringProperty stringProperty;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Or a <code>LongProperty</code>:</p>
                    </div>
                    <div class="exampleblock">
                        <div class="title">Example 93. Constraining a <code>LongProperty</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">@Min(5)
private LongProperty longProperty;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The iterable property types, namely <code>ReadOnlyListProperty</code>,
                            <code>ListProperty</code> and their <code>Set</code> and <code>Map</code> counterparts are generic and, as such, container element constraints can be used. Thus, they have specific value extractors that are not marked with
                            <code>@UnwrapByDefault</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p>A <code>ReadOnlyListProperty</code> would naturally be constrained as a <code>List</code>:</p>
                    </div>
                    <div class="exampleblock">
                        <div class="title">Example 94. Constraining a <code>ReadOnlyListProperty</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">@Size(min = 1)
private ReadOnlyListProperty&lt;@NotBlank String&gt; listProperty;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-valueextraction-registeringvalueextractor">
                        <a class="anchor" href="#section-valueextraction-registeringvalueextractor"></a>7.5. Registering a <code>ValueExtractor</code></h3>
                    <div class="paragraph">
                        <p>Hibernate Validator does not detect automatically the value extractors in the classpath so they have to be registered.</p>
                    </div>
                    <div class="paragraph">
                        <p>There are several ways to register value extractors (in increasing order of priority):
                        </p>
                    </div>
                    <div class="dlist">
                        <dl>
                            <dt class="hdlist1">Provided by the validation engine itself</dt>
                            <dd>
                                <p>See <a href="#section-valueextraction-builtinvalueextractors">Section 7.1, &#8220;Built-in value extractors&#8221;</a>.</p>
                            </dd>
                            <dt class="hdlist1">Via the Java service loader mechanism</dt>
                            <dd>
                                <p>The file <code>META-INF/services/jakarta.validation.valueextraction.ValueExtractor</code> must be provided, with the fully-qualified names of one or more value extractor implementations as its contents, each on a separate
                                    line.</p>
                            </dd>
                            <dt class="hdlist1">In the <code>META-INF/validation.xml</code> file</dt>
                            <dd>
                                <p>See <a href="#section-configuration-validation-xml">Section 8.1, &#8220;Configuring the validator factory in <em>validation.xml</em>&#8221;</a> for more information about how to register value extractors in the XML configuration.</p>
                            </dd>
                            <dt class="hdlist1">By calling <code>Configuration#addValueExtractor(ValueExtractor&lt;?&gt;)</code></dt>
                            <dd>
                                <p>See <a href="#section-bootstrapping-valueextractors">Section 9.2.6, &#8220;Registering <code>ValueExtractor</code>s&#8221;</a> for more information.</p>
                            </dd>
                            <dt class="hdlist1">By invoking <code>ValidatorContext#addValueExtractor(ValueExtractor&lt;?&gt;)</code></dt>
                            <dd>
                                <p>It only declares the value extractor for this <code>Validator</code> instance.</p>
                            </dd>
                        </dl>
                    </div>
                    <div class="paragraph">
                        <p>A value extractor for a given type and type parameter specified at a higher priority overrides any other extractors for the same type and type parameter given at lower priorities.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_resolution_algorithms">
                        <a class="anchor" href="#_resolution_algorithms"></a>7.6. Resolution algorithms</h3>
                    <div class="paragraph">
                        <p>In most cases, you should not have to worry about this but, if you are overriding existing value extractors, you can find a detailed description of the value extractors resolution algorithms in the Jakarta Bean Validation specification:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>for {bvSpecUrl}#constraintdeclarationvalidationprocess-validationroutine-valueextractorresolution-algorithm-constraints[container element constraints],</p>
                            </li>
                            <li>
                                <p>for {bvSpecUrl}#constraintdeclarationvalidationprocess-validationroutine-valueextractorresolution-algorithm-cascaded[cascaded validation],</p>
                            </li>
                            <li>
                                <p>and for {bvSpecUrl}#constraintdeclarationvalidationprocess-validationroutine-valueextractorresolution-implicitunwrapping[implicit unwrapping].</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>One important thing to have in mind is that:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>for container element constraints, the declared type is used to resolve the value extractors;
                                </p>
                            </li>
                            <li>
                                <p>for cascaded validation, it is the runtime type.</p>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="chapter-xml-configuration">
                <a class="anchor" href="#chapter-xml-configuration"></a>8. Configuring via XML</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>So far we have used the default configuration source for Jakarta Bean Validation, namely annotations. However, there also exist two kinds of XML descriptors allowing configuration via XML. The first descriptor describes general Jakarta
                        Bean Validation behaviour and is provided as <em>META-INF/validation.xml</em>. The second one describes constraint declarations and closely matches the constraint declaration approach via annotations. Let&#8217;s have a look at
                        these two document types.</p>
                </div>
                <div class="admonitionblock note">
                    <table>
                        <tr>
                            <td class="icon">
                                <div class="title">Note</div>
                            </td>
                            <td class="content">
                                <div class="paragraph">
                                    <p>The XSD files are available on the <a href="https://jakarta.ee/xml/ns/validation/" class="bare">https://jakarta.ee/xml/ns/validation/</a> page.</p>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="sect2">
                    <h3 id="section-configuration-validation-xml">
                        <a class="anchor" href="#section-configuration-validation-xml"></a>8.1. Configuring the validator factory in <em>validation.xml</em></h3>
                    <div class="paragraph">
                        <p>The key to enable XML configuration for Hibernate Validator is the file <em>META-INF/validation.xml</em>. If this file exists on the classpath its configuration will be applied when the <code>ValidatorFactory</code> gets created.
                            <a href="#image-validation-configuration">Figure 1, &#8220;Validation configuration schema&#8221;</a> shows a model view of the XML schema to which
                            <em>validation.xml</em> has to adhere.</p>
                    </div>
                    <div id="image-validation-configuration" class="imageblock">
                        <div class="content">
                            <img src="validation-configuration-2.0.png" alt="validation-configuration-2.0.xsd">
                        </div>
                        <div class="title">Figure 1. Validation configuration schema</div>
                    </div>
                    <div class="paragraph">
                        <p><a href="#example-validation-xml">Example 95, &#8220;<code>validation.xml</code>&#8221;</a> shows the several configuration options of <em>validation.xml</em>. All settings are optional and the same configuration options are also
                            available programmatically through <code>jakarta.validation.Configuration</code>. In fact, the XML configuration will be overridden by values explicitly specified via the programmatic API. It is even possible to ignore the
                            XML configuration completely via
                            <code>Configuration#ignoreXmlConfiguration()</code>. See also <a href="#section-configuring-validator-factory">Section 9.2, &#8220;Configuring a <code>ValidatorFactory</code>&#8221;</a>.</p>
                    </div>
                    <div id="example-validation-xml" class="exampleblock">
                        <div class="title">Example 95. <code>validation.xml</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;validation-config
        xmlns="https://jakarta.ee/xml/ns/validation/configuration"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="https://jakarta.ee/xml/ns/validation/configuration
            https://jakarta.ee/xml/ns/validation/validation-configuration-3.0.xsd"
        version="3.0"&gt;

    &lt;default-provider&gt;com.acme.ValidationProvider&lt;/default-provider&gt;

    &lt;message-interpolator&gt;com.acme.MessageInterpolator&lt;/message-interpolator&gt;
    &lt;traversable-resolver&gt;com.acme.TraversableResolver&lt;/traversable-resolver&gt;
    &lt;constraint-validator-factory&gt;
        com.acme.ConstraintValidatorFactory
    &lt;/constraint-validator-factory&gt;
    &lt;parameter-name-provider&gt;com.acme.ParameterNameProvider&lt;/parameter-name-provider&gt;
    &lt;clock-provider&gt;com.acme.ClockProvider&lt;/clock-provider&gt;

    &lt;value-extractor&gt;com.acme.ContainerValueExtractor&lt;/value-extractor&gt;

    &lt;executable-validation enabled="true"&gt;
        &lt;default-validated-executable-types&gt;
            &lt;executable-type&gt;CONSTRUCTORS&lt;/executable-type&gt;
            &lt;executable-type&gt;NON_GETTER_METHODS&lt;/executable-type&gt;
            &lt;executable-type&gt;GETTER_METHODS&lt;/executable-type&gt;
        &lt;/default-validated-executable-types&gt;
    &lt;/executable-validation&gt;

    &lt;constraint-mapping&gt;META-INF/validation/constraints-car.xml&lt;/constraint-mapping&gt;

    &lt;property name="hibernate.validator.fail_fast"&gt;false&lt;/property&gt;
&lt;/validation-config&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="admonitionblock warning">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Warning</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>There must only be one file named <em>META-INF/validation.xml</em> on the classpath. If more than one is found an exception is thrown.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>The node <code>default-provider</code> allows to choose the Jakarta Bean Validation provider. This is useful if there is more than one provider on the classpath. <code>message-interpolator</code>, <code>traversable-resolver</code>,
                            <code>constraint-validator-factory</code>, <code>parameter-name-provider</code> and <code>clock-provider</code> allow to customize the used implementations for the interfaces <code>MessageInterpolator</code>, <code>TraversableResolver</code>,
                            <code>ConstraintValidatorFactory</code>, <code>ParameterNameProvider</code> and <code>ClockProvider</code> defined in the
                            <code>jakarta.validation</code> package. See the sub-sections of <a href="#section-configuring-validator-factory">Section 9.2, &#8220;Configuring a <code>ValidatorFactory</code>&#8221;</a> for more information about these interfaces.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p><code>value-extractor</code> allows to declare additional value extractors either to extract values from custom container types or to override the built-in value extractors. See <a href="#chapter-valueextraction">Chapter 7, <em>Value extraction</em></a>                            for more information about how to implement <code>jakarta.validation.valueextraction.ValueExtractor</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p><code>executable-validation</code> and its subnodes define defaults for method validation. The Jakarta Bean Validation specification defines constructor and non getter methods as defaults. The enabled attribute acts as global switch
                            to turn method validation on and off (see also <a href="#chapter-method-constraints">Chapter 3, <em>声明和校验 method 约束</em></a>).</p>
                    </div>
                    <div class="paragraph">
                        <p>Via the <code>constraint-mapping</code> element you can list an arbitrary number of additional XML files containing the actual constraint configuration. Mapping file names must be specified using their fully-qualified name on the
                            classpath. Details on writing mapping files can be found in the next section.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>Last but not least, you can specify provider specific properties via the <code>property</code> nodes. In the example, we are using the Hibernate Validator specific <code>hibernate.validator.fail_fast</code> property (see
                            <a href="#section-fail-fast">Section 12.2, &#8220;Fail fast mode&#8221;</a>).</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-mapping-xml-constraints">
                        <a class="anchor" href="#section-mapping-xml-constraints"></a>8.2. Mapping constraints via <code>constraint-mappings</code></h3>
                    <div class="paragraph">
                        <p>Expressing constraints in XML is possible via files adhering to the schema seen in
                            <a href="#image-mapping-configuration">Figure 2, &#8220;Validation mapping schema&#8221;</a>. Note that these mapping files are only processed if listed via constraint-mapping in <em>validation.xml</em>.</p>
                    </div>
                    <div id="image-mapping-configuration" class="imageblock">
                        <div class="content">
                            <img src="validation-mapping-2.0.png" alt="validation-mapping-2.0.xsd">
                        </div>
                        <div class="title">Figure 2. Validation mapping schema</div>
                    </div>
                    <div class="paragraph">
                        <p><a href="#example-constraints-car">Example 96, &#8220;Bean constraints configured via XML&#8221;</a> shows how the classes Car and RentalCar from <a href="#example-car">Example 51, &#8220;Car类&#8221;</a> resp.
                            <a href="#example-rental-car">Example 57, &#8220;为`RentalCar` 重新定义默认分组&#8221;</a> could be mapped in XML.</p>
                    </div>
                    <div id="example-constraints-car" class="exampleblock">
                        <div class="title">Example 96. Bean constraints configured via XML</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;constraint-mappings
        xmlns="https://jakarta.ee/xml/ns/validation/mapping"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="https://jakarta.ee/xml/ns/validation/mapping
            https://jakarta.ee/xml/ns/validation/validation-mapping-3.0.xsd"
        version="3.0"&gt;

    &lt;default-package&gt;org.hibernate.validator.referenceguide.chapter05&lt;/default-package&gt;
    &lt;bean class="Car" ignore-annotations="true"&gt;
        &lt;field name="manufacturer"&gt;
            &lt;constraint annotation="jakarta.validation.constraints.NotNull"/&gt;
        &lt;/field&gt;
        &lt;field name="licensePlate"&gt;
            &lt;constraint annotation="jakarta.validation.constraints.NotNull"/&gt;
        &lt;/field&gt;
        &lt;field name="seatCount"&gt;
            &lt;constraint annotation="jakarta.validation.constraints.Min"&gt;
                &lt;element name="value"&gt;2&lt;/element&gt;
            &lt;/constraint&gt;
        &lt;/field&gt;
        &lt;field name="driver"&gt;
            &lt;valid/&gt;
        &lt;/field&gt;
        &lt;field name="partManufacturers"&gt;
            &lt;container-element-type type-argument-index="0"&gt;
                &lt;valid/&gt;
            &lt;/container-element-type&gt;
            &lt;container-element-type type-argument-index="1"&gt;
                &lt;container-element-type&gt;
                    &lt;valid/&gt;
                    &lt;constraint annotation="jakarta.validation.constraints.NotNull"/&gt;
                &lt;/container-element-type&gt;
            &lt;/container-element-type&gt;
        &lt;/field&gt;
        &lt;getter name="passedVehicleInspection" ignore-annotations="true"&gt;
            &lt;constraint annotation="jakarta.validation.constraints.AssertTrue"&gt;
                &lt;message&gt;The car has to pass the vehicle inspection first&lt;/message&gt;
                &lt;groups&gt;
                    &lt;value&gt;CarChecks&lt;/value&gt;
                &lt;/groups&gt;
                &lt;element name="max"&gt;10&lt;/element&gt;
            &lt;/constraint&gt;
        &lt;/getter&gt;
    &lt;/bean&gt;
    &lt;bean class="RentalCar" ignore-annotations="true"&gt;
        &lt;class ignore-annotations="true"&gt;
            &lt;group-sequence&gt;
                &lt;value&gt;RentalCar&lt;/value&gt;
                &lt;value&gt;CarChecks&lt;/value&gt;
            &lt;/group-sequence&gt;
        &lt;/class&gt;
    &lt;/bean&gt;
    &lt;constraint-definition annotation="org.mycompany.CheckCase"&gt;
        &lt;validated-by include-existing-validators="false"&gt;
            &lt;value&gt;org.mycompany.CheckCaseValidator&lt;/value&gt;
        &lt;/validated-by&gt;
    &lt;/constraint-definition&gt;
&lt;/constraint-mappings&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p><a href="#example-rental-station-xml">Example 97, &#8220;Method constraints configured via XML&#8221;</a> shows how the constraints from
                            <a href="#example-declaring-parameter-constraints">Example 27, &#8220;声明方法和构造函数参数约束&#8221;</a>, <a href="#example-declaring-return-value-constraints">Example 30, &#8220;声明方法和构造函数返回值约束&#8221;</a> and <a href="#example-specifying-constraint-target">Example 29, &#8220;指定约束的目标&#8221;</a>                            can be expressed in XML.</p>
                    </div>
                    <div id="example-rental-station-xml" class="exampleblock">
                        <div class="title">Example 97. Method constraints configured via XML</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;constraint-mappings
        xmlns="https://jakarta.ee/xml/ns/validation/mapping"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="https://jakarta.ee/xml/ns/validation/mapping
            https://jakarta.ee/xml/ns/validation/validation-mapping-3.0.xsd"
        version="3.0"&gt;

    &lt;default-package&gt;org.hibernate.validator.referenceguide.chapter08&lt;/default-package&gt;

    &lt;bean class="RentalStation" ignore-annotations="true"&gt;
        &lt;constructor&gt;
            &lt;return-value&gt;
                &lt;constraint annotation="ValidRentalStation"/&gt;
            &lt;/return-value&gt;
        &lt;/constructor&gt;

        &lt;constructor&gt;
            &lt;parameter type="java.lang.String"&gt;
                &lt;constraint annotation="jakarta.validation.constraints.NotNull"/&gt;
            &lt;/parameter&gt;
        &lt;/constructor&gt;

        &lt;method name="getCustomers"&gt;
            &lt;return-value&gt;
                &lt;constraint annotation="jakarta.validation.constraints.NotNull"/&gt;
                &lt;constraint annotation="jakarta.validation.constraints.Size"&gt;
                    &lt;element name="min"&gt;1&lt;/element&gt;
                &lt;/constraint&gt;
            &lt;/return-value&gt;
        &lt;/method&gt;

        &lt;method name="rentCar"&gt;
            &lt;parameter type="Customer"&gt;
                &lt;constraint annotation="jakarta.validation.constraints.NotNull"/&gt;
            &lt;/parameter&gt;
            &lt;parameter type="java.util.Date"&gt;
                &lt;constraint annotation="jakarta.validation.constraints.NotNull"/&gt;
                &lt;constraint annotation="jakarta.validation.constraints.Future"/&gt;
            &lt;/parameter&gt;
            &lt;parameter type="int"&gt;
                &lt;constraint annotation="jakarta.validation.constraints.Min"&gt;
                    &lt;element name="value"&gt;1&lt;/element&gt;
                &lt;/constraint&gt;
            &lt;/parameter&gt;
        &lt;/method&gt;

        &lt;method name="addCars"&gt;
            &lt;parameter type="java.util.List"&gt;
                &lt;container-element-type&gt;
                    &lt;valid/&gt;
                    &lt;constraint annotation="jakarta.validation.constraints.NotNull"/&gt;
                &lt;/container-element-type&gt;
            &lt;/parameter&gt;
        &lt;/method&gt;
    &lt;/bean&gt;

    &lt;bean class="Garage" ignore-annotations="true"&gt;
        &lt;method name="buildCar"&gt;
            &lt;parameter type="java.util.List"/&gt;
            &lt;cross-parameter&gt;
                &lt;constraint annotation="ELAssert"&gt;
                    &lt;element name="expression"&gt;...&lt;/element&gt;
                    &lt;element name="validationAppliesTo"&gt;PARAMETERS&lt;/element&gt;
                &lt;/constraint&gt;
            &lt;/cross-parameter&gt;
        &lt;/method&gt;
        &lt;method name="paintCar"&gt;
            &lt;parameter type="int"/&gt;
            &lt;return-value&gt;
                &lt;constraint annotation="ELAssert"&gt;
                    &lt;element name="expression"&gt;...&lt;/element&gt;
                    &lt;element name="validationAppliesTo"&gt;RETURN_VALUE&lt;/element&gt;
                &lt;/constraint&gt;
            &lt;/return-value&gt;
        &lt;/method&gt;
    &lt;/bean&gt;

&lt;/constraint-mappings&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>The XML configuration is closely mirroring the programmatic API. For this reason it should suffice to just add some comments. <code>default-package</code> is used for all fields where a class name is expected. If the specified
                            class is not fully qualified the configured default package will be used. Every mapping file can then have several bean nodes, each describing the constraints on the entity with the specified class name.</p>
                    </div>
                    <div class="admonitionblock warning">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Warning</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>A given class can only be configured once across all configuration files. The same applies for constraint definitions for a given constraint annotation. It can only occur in one mapping file. If these rules are
                                            violated a <code>ValidationException</code> is thrown.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>Setting <code>ignore-annotations</code> to <code>true</code> means that constraint annotations placed on the configured bean are ignored. The default for this value is true. <code>ignore-annotations</code> is also available for
                            the nodes
                            <code>class</code>, <code>fields</code>, <code>getter</code>, <code>constructor</code>, <code>method</code>, <code>parameter</code>, <code>cross-parameter</code> and <code>return-value</code>. If not explicitly specified on
                            these levels the configured bean value applies.</p>
                    </div>
                    <div class="paragraph">
                        <p>The nodes <code>class</code>, <code>field</code>, <code>getter</code>, <code>container-element-type</code>, <code>constructor</code> and <code>method</code> (and its sub node parameter) determine on which level the constraint gets
                            placed. The <code>valid</code> node is used to enable cascaded validation and the <code>constraint</code> node to add a constraint on the corresponding level. Each constraint definition must define the class via the <code>annotation</code>                            attribute. The constraint attributes required by the Jakarta Bean Validation specification (<code>message</code>, <code>groups</code> and
                            <code>payload</code>) have dedicated nodes. All other constraint specific attributes are configured using the
                            <code>element</code> node.</p>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p><code>container-element-type</code> allows to define the cascaded validation behavior and the constraints for container elements. In the above examples, you can see an example of nested container element constraints
                                            on a <code>List</code> nested in the values of a <code>Map</code>. <code>type-argument-index</code> is used to precise which type argument of the <code>Map</code> is concerned by the configuration. It can be
                                            ommitted if the type only has one type argument (e.g. the <code>List</code>s in our examples).</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>The <code>class</code> node also allows to reconfigure the default group sequence (see
                            <a href="#section-default-group-class">Section 5.4, &#8220;重新定义默认组序列&#8221;</a>) via the <code>group-sequence</code> node. Not shown in the example is the use of <code>convert-group</code> to specify group conversions (see
                            <a href="#section-group-conversion">Section 5.5, &#8220;分组转化&#8221;</a>). This node is available on <code>field</code>,
                            <code>getter</code>, <code>container-element-type</code>, <code>parameter</code> and <code>return-value</code> and specifies a <code>from</code> and a <code>to</code> attributes to specify the groups.</p>
                    </div>
                    <div class="paragraph">
                        <p>Last but not least, the list of <code>ConstraintValidator</code> instances associated to a given constraint can be altered via the <code>constraint-definition</code> node. The annotation attribute represents the constraint annotation
                            being altered. The <code>validated-by</code> element represent the (ordered) list of <code>ConstraintValidator</code> implementations associated to the constraint. If <code>include-existing-validator</code> is set to <code>false</code>,
                            validators defined on the constraint annotation are ignored. If set to <code>true</code>, the list of constraint validators described in XML is concatenated to the list of validators specified on the annotation.</p>
                    </div>
                    <div class="admonitionblock tip">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Tip</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>One use case for constraint-definition is to change the default constraint definition for <code>@URL</code>. Historically, Hibernate Validator&#8217;s default constraint validator for this constraint uses the
                                            <code>java.net.URL</code> constructor to verify that an URL is valid. However, there is also a purely regular expression based version available which can be configured using XML:
                                        </p>
                                    </div>
                                    <div class="listingblock">
                                        <div class="title">Using XML to register a regular expression based constraint definition for <code>@URL</code></div>
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;constraint-definition annotation="org.hibernate.validator.constraints.URL"&gt;
  &lt;validated-by include-existing-validators="false"&gt;
    &lt;value&gt;org.hibernate.validator.constraintvalidators.RegexpURLValidator&lt;/value&gt;
  &lt;/validated-by&gt;
&lt;/constraint-definition&gt;</code></pre>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="chapter-bootstrapping">
                <a class="anchor" href="#chapter-bootstrapping"></a>9. Bootstrapping</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>In <a href="#section-obtaining-validator">Section 2.2.1, &#8220;获取 <code>Validator</code> 实例&#8221;</a>, you already saw one way of creating a <code>Validator</code> instance - via
                        <code>Validation#buildDefaultValidatorFactory()</code>. In this chapter, you will learn how to use the other methods in <code>jakarta.validation.Validation</code> in order to bootstrap specifically configured validators.</p>
                </div>
                <div class="sect2">
                    <h3 id="section-retrieving-validator-factory-validator">
                        <a class="anchor" href="#section-retrieving-validator-factory-validator"></a>9.1. Retrieving <code>ValidatorFactory</code> and <code>Validator</code></h3>
                    <div class="paragraph">
                        <p>You obtain a <code>Validator</code> by retrieving a <code>ValidatorFactory</code> via one of the static methods on
                            <code>jakarta.validation.Validation</code> and calling <code>getValidator()</code> on the factory instance.</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="#example-build-default-validator-factory">Example 98, &#8220;Bootstrapping default <code>ValidatorFactory</code> and <code>Validator</code>&#8221;</a> shows how to obtain a validator from the default validator factory:</p>
                    </div>
                    <div id="example-build-default-validator-factory" class="exampleblock">
                        <div class="title">Example 98. Bootstrapping default <code>ValidatorFactory</code> and <code>Validator</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.buildDefaultValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="admonitionblock tip">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Tip</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>The generated <code>ValidatorFactory</code> and <code>Validator</code> instances are thread-safe and can be cached. As Hibernate Validator uses the factory as context for caching constraint metadata it is recommended
                                            to work with one factory instance within an application.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>Jakarta Bean Validation supports working with several providers such as Hibernate Validator within one application. If more than one provider is present on the classpath, it is not guaranteed which one is chosen when creating a
                            factory via <code>buildDefaultValidatorFactory()</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p>In this case, you can explicitly specify the provider to use via <code>Validation#byProvider()</code>, passing the provider&#8217;s <code>ValidationProvider</code> class as shown in <a href="#example-using-specific-provider">Example 99, &#8220;Bootstrapping <code>ValidatorFactory</code> and <code>Validator</code> using a specific provider&#8221;</a>.</p>
                    </div>
                    <div id="example-using-specific-provider" class="exampleblock">
                        <div class="title">Example 99. Bootstrapping <code>ValidatorFactory</code> and <code>Validator</code> using a specific provider</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
		.configure()
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Note that the configuration object returned by <code>configure()</code> allows to specifically customize the factory before calling <code>buildValidatorFactory()</code>. The available options are discussed later in this chapter.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>Similarly you can retrieve the default validator factory for configuration which is demonstrated in
                            <a href="#example-configuring-default-provider">Example 100, &#8220;Retrieving the default <code>ValidatorFactory</code> for configuration&#8221;</a>.</p>
                    </div>
                    <div id="example-configuring-default-provider" class="exampleblock">
                        <div class="title">Example 100. Retrieving the default <code>ValidatorFactory</code> for configuration</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
		.configure()
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>If a <code>ValidatorFactory</code> instance is no longer in use, it should be disposed by calling
                                            <code>ValidatorFactory#close()</code>. This will free any resources possibly allocated by the factory.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="sect3">
                        <h4 id="section-validation-provider-resolver">
                            <a class="anchor" href="#section-validation-provider-resolver"></a>9.1.1. <code>ValidationProviderResolver</code></h4>
                        <div class="paragraph">
                            <p>By default, available Jakarta Bean Validation providers are discovered using the {javaTechnotesBaseUrl}/guides/jar/jar.html#Service_Provider[Java Service Provider] mechanism.</p>
                        </div>
                        <div class="paragraph">
                            <p>For that purpose, each provider includes the file <em>META-
INF/services/jakarta.validation.spi.ValidationProvider</em>, containing the fully qualified classname of its <code>ValidationProvider</code> implementation. In the case of Hibernate Validator, this is
                                <code>org.hibernate.validator.HibernateValidator</code>.</p>
                        </div>
                        <div class="paragraph">
                            <p>Depending on your environment and its classloading specifics, provider discovery via the Java&#8217;s service loader mechanism might not work. In this case, you can plug in a custom
                                <code>ValidationProviderResolver</code> implementation which performs the provider retrieval. An example is OSGi, where you could implement a provider resolver which uses OSGi services for provider discovery.</p>
                        </div>
                        <div class="paragraph">
                            <p>To use a custom provider resolver, pass it via <code>providerResolver()</code> as shown in
                                <a href="#example-using-custom-validation-provider-resolver">Example 101, &#8220;Using a custom <code>ValidationProviderResolver</code>&#8221;</a>.</p>
                        </div>
                        <div id="example-using-custom-validation-provider-resolver" class="exampleblock">
                            <div class="title">Example 101. Using a custom <code>ValidationProviderResolver</code></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter09;

public class OsgiServiceDiscoverer implements ValidationProviderResolver {

	@Override
	public List&lt;ValidationProvider&lt;?&gt;&gt; getValidationProviders() {
		//...
		return null;
	}
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
		.providerResolver( new OsgiServiceDiscoverer() )
		.configure()
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-configuring-validator-factory">
                        <a class="anchor" href="#section-configuring-validator-factory"></a>9.2. Configuring a <code>ValidatorFactory</code></h3>
                    <div class="paragraph">
                        <p>By default, validator factories retrieved from <code>Validation</code> and any validators they create are configured as per the XML descriptor <em>META-INF/validation.xml</em> (see <a href="#chapter-xml-configuration">Chapter 8, <em>Configuring via XML</em></a>),
                            if present.</p>
                    </div>
                    <div class="paragraph">
                        <p>If you want to disable the XML based configuration, you can do so by invoking
                            <code>Configuration#ignoreXmlConfiguration()</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p>The different values of the XML configuration can be accessed via
                            <code>Configuration#getBootstrapConfiguration()</code>. This can for instance be helpful if you want to integrate Jakarta Bean Validation into a managed environment and want to create managed instances of the objects configured
                            via XML.</p>
                    </div>
                    <div class="paragraph">
                        <p>Using the fluent configuration API, you can override one or more of the settings when bootstrapping the factory. The following sections show how to make use of the different options. Note that the
                            <code>Configuration</code> class exposes the default implementations of the different extension points which can be useful if you want to use these as delegates for your custom implementations.</p>
                    </div>
                    <div class="sect3">
                        <h4 id="section-validator-factory-message-interpolator">
                            <a class="anchor" href="#section-validator-factory-message-interpolator"></a>9.2.1. <code>MessageInterpolator</code></h4>
                        <div class="paragraph">
                            <p>Message interpolators are used by the validation engine to create user readable error messages from constraint message descriptors.</p>
                        </div>
                        <div class="paragraph">
                            <p>In case the default message interpolation algorithm described in <a href="#chapter-message-interpolation">Chapter 4, <em>添加约束错误消息</em></a> is not sufficient for your needs, you can pass in your own implementation of the <code>MessageInterpolator</code>                                interface via <code>Configuration#messageInterpolator()</code> as shown in
                                <a href="#example-using-custom-message-interpolator">Example 102, &#8220;Using a custom <code>MessageInterpolator</code>&#8221;</a>.</p>
                        </div>
                        <div id="example-using-custom-message-interpolator" class="exampleblock">
                            <div class="title">Example 102. Using a custom <code>MessageInterpolator</code></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter09;

public class MyMessageInterpolator implements MessageInterpolator {

	@Override
	public String interpolate(String messageTemplate, Context context) {
		//...
		return null;
	}

	@Override
	public String interpolate(String messageTemplate, Context context, Locale locale) {
		//...
		return null;
	}
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
		.configure()
		.messageInterpolator( new MyMessageInterpolator() )
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-validator-factory-traversable-resolver">
                            <a class="anchor" href="#section-validator-factory-traversable-resolver"></a>9.2.2. <code>TraversableResolver</code></h4>
                        <div class="paragraph">
                            <p>In some cases the validation engine should not access the state of a bean property. The most obvious example for that is a lazily loaded property or association of a JPA entity. Validating this lazy property or association
                                would mean that its state would have to be accessed, triggering a load from the database.</p>
                        </div>
                        <div class="paragraph">
                            <p>Which properties can be accessed and which ones not is controlled by querying the
                                <code>TraversableResolver</code> interface. <a href="#example-using-custom-traversable-resolver">Example 103, &#8220;Using a custom <code>TraversableResolver</code>&#8221;</a> shows how to use a custom traversable resolver
                                implementation.</p>
                        </div>
                        <div id="example-using-custom-traversable-resolver" class="exampleblock">
                            <div class="title">Example 103. Using a custom <code>TraversableResolver</code></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter09;

public class MyTraversableResolver implements TraversableResolver {

	@Override
	public boolean isReachable(
			Object traversableObject,
			Node traversableProperty,
			Class&lt;?&gt; rootBeanType,
			Path pathToTraversableObject,
			ElementType elementType) {
		//...
		return false;
	}

	@Override
	public boolean isCascadable(
			Object traversableObject,
			Node traversableProperty,
			Class&lt;?&gt; rootBeanType,
			Path pathToTraversableObject,
			ElementType elementType) {
		//...
		return false;
	}
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
		.configure()
		.traversableResolver( new MyTraversableResolver() )
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>If no specific traversable resolver has been configured, the default behavior is to consider all properties as reachable and cascadable. When using Hibernate Validator together with a JPA 2 provider such as Hibernate ORM, only
                                those properties will be considered reachable which already have been loaded by the persistence provider and all properties will be considered cascadable.</p>
                        </div>
                        <div class="paragraph">
                            <p>By default, the traversable resolver calls are cached per validation call. This is especially important in a JPA environment where calling <code>isReachable()</code> has a significant cost.</p>
                        </div>
                        <div class="paragraph">
                            <p>This caching adds some overhead. In the case your custom traversable resolver is very fast, it might be better to consider turning off the cache.</p>
                        </div>
                        <div class="paragraph">
                            <p>You can disable the cache either via the XML configuration:</p>
                        </div>
                        <div id="example-disabling-traversable-resolver-result-cache-xml-configuration" class="exampleblock">
                            <div class="title">Example 104. Disabling the <code>TraversableResolver</code> result cache via the XML configuration</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;validation-config
        xmlns="https://jakarta.ee/xml/ns/validation/configuration"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="https://jakarta.ee/xml/ns/validation/configuration https://jakarta.ee/xml/ns/validation/validation-configuration-3.0.xsd"
        version="3.0"&gt;
    &lt;default-provider&gt;org.hibernate.validator.HibernateValidator&lt;/default-provider&gt;

    &lt;property name="hibernate.validator.enable_traversable_resolver_result_cache"&gt;false&lt;/property&gt;
&lt;/validation-config&gt;</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>or via the programmatic API:</p>
                        </div>
                        <div id="example-disabling-traversable-resolver-result-cache-programmatic-api" class="exampleblock">
                            <div class="title">Example 105. Disabling the <code>TraversableResolver</code> result cache via the programmatic API</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
		.configure()
		.traversableResolver( new MyFastTraversableResolver() )
		.enableTraversableResolverResultCache( false )
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_constraintvalidatorfactory">
                            <a class="anchor" href="#_constraintvalidatorfactory"></a>9.2.3. <code>ConstraintValidatorFactory</code></h4>
                        <div class="paragraph">
                            <p><code>ConstraintValidatorFactory</code> is the extension point for customizing how constraint validators are instantiated and released.</p>
                        </div>
                        <div class="paragraph">
                            <p>The default <code>ConstraintValidatorFactory</code> provided by Hibernate Validator requires a public no-arg constructor to instantiate <code>ConstraintValidator</code> instances (see <a href="#section-constraint-validator">Section 6.1.2, &#8220;约束校验器&#8221;</a>).
                                Using a custom <code>ConstraintValidatorFactory</code> offers for example the possibility to use dependency injection in constraint validator implementations.</p>
                        </div>
                        <div class="paragraph">
                            <p>To configure a custom constraint validator factory call <code>Configuration#constraintValidatorFactory()</code> (see <a href="#example-using-custom-constraint-validator-factory">Example 106, &#8220;Using a custom <code>ConstraintValidatorFactory</code>&#8221;</a>.</p>
                        </div>
                        <div id="example-using-custom-constraint-validator-factory" class="exampleblock">
                            <div class="title">Example 106. Using a custom <code>ConstraintValidatorFactory</code></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter09;

public class MyConstraintValidatorFactory implements ConstraintValidatorFactory {

	@Override
	public &lt;T extends ConstraintValidator&lt;?, ?&gt;&gt; T getInstance(Class&lt;T&gt; key) {
		//...
		return null;
	}

	@Override
	public void releaseInstance(ConstraintValidator&lt;?, ?&gt; instance) {
		//...
	}
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
		.configure()
		.constraintValidatorFactory( new MyConstraintValidatorFactory() )
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="admonitionblock warning">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Warning</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>Any constraint implementations relying on <code>ConstraintValidatorFactory</code> behaviors specific to an implementation (dependency injection, no no-arg constructor and so on) are not considered portable.</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p><code>ConstraintValidatorFactory</code> implementations should not cache validator instances as the state of each instance can be altered in the <code>initialize()</code> method.</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-parameter-name-provider">
                            <a class="anchor" href="#section-parameter-name-provider"></a>9.2.4. <code>ParameterNameProvider</code></h4>
                        <div class="paragraph">
                            <p>In case a method or constructor parameter constraint is violated, the <code>ParameterNameProvider</code> interface is used to retrieve the parameter name and make it available to the user via the property path of the constraint
                                violation.</p>
                        </div>
                        <div class="paragraph">
                            <p>The default implementation returns parameter names as obtained through the Java reflection API. If you compile your sources using the <code>-parameters</code> compiler flag, the actual parameter names as in the source code
                                will be returned. Otherwise synthetic names in the form of <code>arg0</code>, <code>arg1</code> etc. will be used.</p>
                        </div>
                        <div class="paragraph">
                            <p>To use a custom parameter name provider either pass an instance of the provider during bootstrapping as shown in <a href="#example-using-custom-parameter-name-provider">Example 107, &#8220;Using a custom <code>ParameterNameProvider</code>&#8221;</a>,
                                or specify the fully qualified class name of the provider as value for the <code>&lt;parameter-name-provider&gt;</code> element in the <em>META-INF/validation.xml</em> file (see <a href="#section-configuration-validation-xml">Section 8.1, &#8220;Configuring the validator factory in <em>validation.xml</em>&#8221;</a>).
                                This is demonstrated in
                                <a href="#example-using-custom-parameter-name-provider">Example 107, &#8220;Using a custom <code>ParameterNameProvider</code>&#8221;</a>.</p>
                        </div>
                        <div id="example-using-custom-parameter-name-provider" class="exampleblock">
                            <div class="title">Example 107. Using a custom <code>ParameterNameProvider</code></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter09;

public class MyParameterNameProvider implements ParameterNameProvider {

	@Override
	public List&lt;String&gt; getParameterNames(Constructor&lt;?&gt; constructor) {
		//...
		return null;
	}

	@Override
	public List&lt;String&gt; getParameterNames(Method method) {
		//...
		return null;
	}
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
		.configure()
		.parameterNameProvider( new MyParameterNameProvider() )
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="admonitionblock tip">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Tip</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>Hibernate Validator comes with a custom <code>ParameterNameProvider</code> implementation based on the
                                                <a href="https://github.com/paul-hammant/paranamer/">ParaNamer</a> library which provides several ways for obtaining parameter names at runtime. Refer to <a href="#section-paranamer-parameternameprovider">Section 12.14, &#8220;Paranamer based <code>ParameterNameProvider</code>&#8221;</a>                                                to learn more about this specific implementation.</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-clock-provider">
                            <a class="anchor" href="#section-clock-provider"></a>9.2.5. <code>ClockProvider</code> and temporal validation tolerance</h4>
                        <div class="paragraph">
                            <p>For time related validation (<code>@Past</code> and <code>@Future</code> constraints for instance), it might be useful to define what is considered <code>now</code>.</p>
                        </div>
                        <div class="paragraph">
                            <p>This is especially important when you want to test your constraints in a reliable manner.</p>
                        </div>
                        <div class="paragraph">
                            <p>The reference time is defined by the <code>ClockProvider</code> contract. The responsibility of the <code>ClockProvider</code> is to provide a <code>java.time.Clock</code> defining <code>now</code> for time related validators.</p>
                        </div>
                        <div id="example-using-custom-clock-provider" class="exampleblock">
                            <div class="title">Example 108. Using a custom <code>ClockProvider</code></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter09;

import java.time.Clock;
import java.time.ZonedDateTime;

import jakarta.validation.ClockProvider;

public class FixedClockProvider implements ClockProvider {

	private Clock clock;

	public FixedClockProvider(ZonedDateTime dateTime) {
		clock = Clock.fixed( dateTime.toInstant(), dateTime.getZone() );
	}

	@Override
	public Clock getClock() {
		return clock;
	}

}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
		.configure()
		.clockProvider( new FixedClockProvider( ZonedDateTime.of( 2016, 6, 15, 0, 0, 0, 0, ZoneId.of( "Europe/Paris" ) ) ) )
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>Alternatively, you can specify the fully-qualified classname of a <code>ClockProvider</code> implementation using the
                                <code>&lt;clock-provider&gt;</code> element when configuring the default validator factory via <em>META-INF/validation.xml</em> (see <a href="#chapter-xml-configuration">Chapter 8, <em>Configuring via XML</em></a>).</p>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>When validating <code>@Future</code> and <code>@Past</code> constraints, you might want to obtain the current time.</p>
                                        </div>
                                        <div class="paragraph">
                                            <p>You can obtain the <code>ClockProvider</code> in your validators by calling the
                                                <code>ConstraintValidatorContext#getClockProvider()</code> method.</p>
                                        </div>
                                        <div class="paragraph">
                                            <p>For instance, this might be useful if you want to replace the default message of the <code>@Future</code> constraint with a more explicit one.</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="paragraph">
                            <p>When dealing with distributed architectures, you might need some tolerance when applying temporal constraints such as <code>@Past</code> or <code>@Future</code>.</p>
                        </div>
                        <div class="paragraph">
                            <p>You can set a temporal validation tolerance by bootstrapping your <code>ValidatorFactory</code> as below:</p>
                        </div>
                        <div id="example-using-temporal-validation-tolerance" class="exampleblock">
                            <div class="title">Example 109. Using temporal validation tolerance</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
		.configure()
		.temporalValidationTolerance( Duration.ofMillis( 10 ) )
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>Alternatively, you can define it in the XML configuration by setting the <code>hibernate.validator.temporal_validation_tolerance</code> property in your <em>META-INF/validation.xml</em>.</p>
                        </div>
                        <div class="paragraph">
                            <p>The value of this property must be a <code>long</code> defining the tolerance in milliseconds.</p>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>When implementing your own temporal constraints, you might need to have access to the temporal validation tolerance.</p>
                                        </div>
                                        <div class="paragraph">
                                            <p>It can be obtained by calling the <code>HibernateConstraintValidatorInitializationContext#getTemporalValidationTolerance()</code> method.</p>
                                        </div>
                                        <div class="paragraph">
                                            <p>Note that to get access to this context at initialization, your constraint validator has to implement the <code>HibernateConstraintValidator</code> contract (see <a href="#constraint-validator-hibernateconstraintvalidator">Section 6.1.2.2, &#8220;The <code>HibernateConstraintValidator</code> extension&#8221;</a>).
                                                This contract is currently marked as incubating: it might be subject to change in the future.</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-bootstrapping-valueextractors">
                            <a class="anchor" href="#section-bootstrapping-valueextractors"></a>9.2.6. Registering <code>ValueExtractor</code>s</h4>
                        <div class="paragraph">
                            <p>As mentioned in <a href="#chapter-valueextraction">Chapter 7, <em>Value extraction</em></a>, additional value extractors can be registered during bootstrapping (see <a href="#section-valueextraction-registeringvalueextractor">Section 7.5, &#8220;Registering a <code>ValueExtractor</code>&#8221;</a>                                for the other ways to register a value extractor).</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="#example-registering-value-extractor">Example 110, &#8220;Registering additional value extractors&#8221;</a> shows how we would register the value extractors we previously created to extract the keys and the values
                                of Guava&#8217;s <code>Multimap</code>.</p>
                        </div>
                        <div id="example-registering-value-extractor" class="exampleblock">
                            <div class="title">Example 110. Registering additional value extractors</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byDefaultProvider()
		.configure()
		.addValueExtractor( new MultimapKeyValueExtractor() )
		.addValueExtractor( new MultimapValueValueExtractor() )
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_adding_mapping_streams">
                            <a class="anchor" href="#_adding_mapping_streams"></a>9.2.7. Adding mapping streams</h4>
                        <div class="paragraph">
                            <p>As discussed earlier, you can configure the constraints applied to your Java beans using XML based constraint mappings.</p>
                        </div>
                        <div class="paragraph">
                            <p>Besides the mapping files specified in <em>META-INF/validation.xml</em>, you can add further mappings via
                                <code>Configuration#addMapping()</code> (see <a href="#example-adding-mapping-streams">Example 111, &#8220;Adding constraint mapping streams&#8221;</a>). Note that the passed input stream(s) must adhere to the XML schema
                                for constraint mappings presented in
                                <a href="#section-mapping-xml-constraints">Section 8.2, &#8220;Mapping constraints via <code>constraint-mappings</code>&#8221;</a>.</p>
                        </div>
                        <div id="example-adding-mapping-streams" class="exampleblock">
                            <div class="title">Example 111. Adding constraint mapping streams</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">InputStream constraintMapping1 = null;
InputStream constraintMapping2 = null;
ValidatorFactory validatorFactory = Validation.byDefaultProvider()
		.configure()
		.addMapping( constraintMapping1 )
		.addMapping( constraintMapping2 )
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>You should close any passed input stream after the validator factory has been created.</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-provider-specific-settings">
                            <a class="anchor" href="#section-provider-specific-settings"></a>9.2.8. Provider-specific settings</h4>
                        <div class="paragraph">
                            <p>Via the configuration object returned by <code>Validation#byProvider()</code>, provider specific options can be configured.
                            </p>
                        </div>
                        <div class="paragraph">
                            <p>In the case of Hibernate Validator, this e.g. allows you to enable the fail fast mode and pass one or more programmatic constraint mappings as demonstrated in
                                <a href="#example-hibernate-validator-specific-options">Example 112, &#8220;Setting Hibernate Validator specific options&#8221;</a>.</p>
                        </div>
                        <div id="example-hibernate-validator-specific-options" class="exampleblock">
                            <div class="title">Example 112. Setting Hibernate Validator specific options</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
		.configure()
		.failFast( true )
		.addMapping( (ConstraintMapping) null )
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>Alternatively, provider-specific options can be passed via <code>Configuration#addProperty()</code>. Hibernate Validator supports enabling the fail fast mode that way, too:</p>
                        </div>
                        <div id="example-hibernate-validator-specific-option-via-addproperty" class="exampleblock">
                            <div class="title">Example 113. Enabling a Hibernate Validator specific option via <code>addProperty()</code></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
		.configure()
		.addProperty( "hibernate.validator.fail_fast", "true" )
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>Refer to <a href="#section-fail-fast">Section 12.2, &#8220;Fail fast mode&#8221;</a> and <a href="#section-programmatic-api">Section 12.4, &#8220;Programmatic constraint definition and declaration&#8221;</a> to learn more about
                                the fail fast mode and the constraint declaration API.</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-script-evaluator-factory">
                            <a class="anchor" href="#section-script-evaluator-factory"></a>9.2.9. Configuring the <code>ScriptEvaluatorFactory</code></h4>
                        <div class="paragraph">
                            <p>For constraints like <code>@ScriptAssert</code> and <code>@ParameterScriptAssert</code>, it might be useful to configure how the script engines are initialized and how the script evaluators are built. This can be done by setting
                                a custom implementation of <code>ScriptEvaluatorFactory</code>.</p>
                        </div>
                        <div class="paragraph">
                            <p>In particular, this is important for modular environments (e.g. OSGi), where user might face issues with modular class loading and <a href="https://www.jcp.org/en/jsr/detail?id=223">JSR 223</a>. It also allows to use any custom
                                script engine, not necessarily based on the
                                <a href="https://www.jcp.org/en/jsr/detail?id=223">JSR 223</a> (e.g. Spring Expression Language).</p>
                        </div>
                        <div class="sect4">
                            <h5 id="_xml_configuration">
                                <a class="anchor" href="#_xml_configuration"></a>9.2.9.1. XML configuration</h5>
                            <div class="paragraph">
                                <p>To specify the <code>ScriptEvaluatorFactory</code> via XML, you need to define the <code>hibernate.validator.script_evaluator_factory</code> property.
                                </p>
                            </div>
                            <div id="example-script-evaluator-factory-xml" class="exampleblock">
                                <div class="title">Example 114. Defining the <code>ScriptEvaluatorFactory</code> via XML</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;validation-config
        xmlns="https://jakarta.ee/xml/ns/validation/configuration"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="https://jakarta.ee/xml/ns/validation/configuration
            https://jakarta.ee/xml/ns/validation/validation-configuration-3.0.xsd"
        version="3.0"&gt;

    &lt;property name="hibernate.validator.script_evaluator_factory"&gt;
        org.hibernate.validator.referenceguide.chapter09.CustomScriptEvaluatorFactory
    &lt;/property&gt;

&lt;/validation-config&gt;</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>In this case, the specified <code>ScriptEvaluatorFactory</code> must have a no-arg constructor.</p>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_programmatic_configuration">
                                <a class="anchor" href="#_programmatic_configuration"></a>9.2.9.2. Programmatic configuration</h5>
                            <div class="paragraph">
                                <p>To configure it programmatically, you need to pass an instance of <code>ScriptEvaluatorFactory</code> to the <code>ValidatorFactory</code>. This gives more flexibility in the configuration of the <code>ScriptEvaluatorFactory</code>.
                                    <a href="#example-script-evaluator-factory-programmatically">Example 115, &#8220;Defining the <code>ScriptEvaluatorFactory</code> programmatically&#8221;</a> shows how this can be done.</p>
                            </div>
                            <div id="example-script-evaluator-factory-programmatically" class="exampleblock">
                                <div class="title">Example 115. Defining the <code>ScriptEvaluatorFactory</code> programmatically</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
		.configure()
		.scriptEvaluatorFactory( new CustomScriptEvaluatorFactory() )
		.buildValidatorFactory();
Validator validator = validatorFactory.getValidator();</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="_custom_scriptevaluatorfactory_implementation_examples">
                                <a class="anchor" href="#_custom_scriptevaluatorfactory_implementation_examples"></a>9.2.9.3. Custom <code>ScriptEvaluatorFactory</code> implementation examples</h5>
                            <div class="paragraph">
                                <p>This section shows a couple of custom <code>ScriptEvaluatorFactory</code> implementations that can be used in modular environments as well as one using the <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#expressions">Spring Expression Language</a>                                    for writing constraint scripts.</p>
                            </div>
                            <div class="paragraph">
                                <p>Problems with modular environments and <a href="https://www.jcp.org/en/jsr/detail?id=223">JSR 223</a> come from the class loading. The class loader where the script engine is available might be different from the one of
                                    Hibernate Validator. Thus the script engine wouldn&#8217;t be found using the default strategy.</p>
                            </div>
                            <div class="paragraph">
                                <p>To solve this issue, the <code>MultiClassLoaderScriptEvaluatorFactory</code> class below can be introduced:</p>
                            </div>
                            <div class="exampleblock">
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">/*
 * Hibernate Validator, declare and validate application constraints
 *
 * License: Apache License, Version 2.0
 * See the license.txt file in the root directory or &lt;http://www.apache.org/licenses/LICENSE-2.0&gt;.
 */
package org.hibernate.validator.osgi.scripting;

import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;

import org.hibernate.validator.spi.scripting.AbstractCachingScriptEvaluatorFactory;
import org.hibernate.validator.spi.scripting.ScriptEngineScriptEvaluator;
import org.hibernate.validator.spi.scripting.ScriptEvaluationException;
import org.hibernate.validator.spi.scripting.ScriptEvaluator;
import org.hibernate.validator.spi.scripting.ScriptEvaluatorFactory;

/**
 * {@link ScriptEvaluatorFactory} that allows you to pass multiple {@link ClassLoader}s that will be used
 * to search for {@link ScriptEngine}s. Useful in environments similar to OSGi, where script engines can be
 * found only in {@link ClassLoader}s different from default one.
 *
 * @author Marko Bekhta
 */
public class MultiClassLoaderScriptEvaluatorFactory extends AbstractCachingScriptEvaluatorFactory {

	private final ClassLoader[] classLoaders;

	public MultiClassLoaderScriptEvaluatorFactory(ClassLoader... classLoaders) {
		if ( classLoaders.length == 0 ) {
			throw new IllegalArgumentException( "No class loaders were passed" );
		}
		this.classLoaders = classLoaders;
	}

	@Override
	protected ScriptEvaluator createNewScriptEvaluator(String languageName) {
		for ( ClassLoader classLoader : classLoaders ) {
			ScriptEngine engine = new ScriptEngineManager( classLoader ).getEngineByName( languageName );
			if ( engine != null ) {
				return new ScriptEngineScriptEvaluator( engine );
			}
		}
		throw new ScriptEvaluationException( "No JSR 223 script engine found for language " + languageName );
	}
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>and then declared with:</p>
                            </div>
                            <div class="exampleblock">
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Validator validator = Validation.byProvider( HibernateValidator.class )
		.configure()
		.scriptEvaluatorFactory(
				new MultiClassLoaderScriptEvaluatorFactory( GroovyScriptEngineFactory.class.getClassLoader() )
		)
		.buildValidatorFactory()
		.getValidator();</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>This way, it is possible to pass multiple <code>ClassLoader</code> instances: typically the class loaders of the wanted <code>ScriptEngine</code>s.</p>
                            </div>
                            <div class="paragraph">
                                <p>An alternative approach for OSGi environments can be to use the <code>OsgiScriptEvaluatorFactory</code> defined below:</p>
                            </div>
                            <div class="exampleblock">
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">/*
 * Hibernate Validator, declare and validate application constraints
 *
 * License: Apache License, Version 2.0
 * See the license.txt file in the root directory or &lt;http://www.apache.org/licenses/LICENSE-2.0&gt;.
 */
package org.hibernate.validator.osgi.scripting;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.URL;
import java.util.Arrays;
import java.util.Collections;
import java.util.Enumeration;
import java.util.List;
import java.util.Objects;
import java.util.stream.Collectors;
import java.util.stream.Stream;

import javax.script.ScriptEngineFactory;
import javax.script.ScriptEngineManager;
import jakarta.validation.ValidationException;

import org.hibernate.validator.spi.scripting.AbstractCachingScriptEvaluatorFactory;
import org.hibernate.validator.spi.scripting.ScriptEngineScriptEvaluator;
import org.hibernate.validator.spi.scripting.ScriptEvaluator;
import org.hibernate.validator.spi.scripting.ScriptEvaluatorFactory;
import org.hibernate.validator.spi.scripting.ScriptEvaluatorNotFoundException;
import org.osgi.framework.Bundle;
import org.osgi.framework.BundleContext;

/**
 * {@link ScriptEvaluatorFactory} suitable for OSGi environments. It is created
 * based on the {@code BundleContext} which is used to iterate through {@code Bundle}s and find all {@link ScriptEngineFactory}
 * candidates.
 *
 * @author Marko Bekhta
 */
public class OsgiScriptEvaluatorFactory extends AbstractCachingScriptEvaluatorFactory {

	private final List&lt;ScriptEngineManager&gt; scriptEngineManagers;

	public OsgiScriptEvaluatorFactory(BundleContext context) {
		this.scriptEngineManagers = Collections.unmodifiableList( findManagers( context ) );
	}

	@Override
	protected ScriptEvaluator createNewScriptEvaluator(String languageName) throws ScriptEvaluatorNotFoundException {
		return scriptEngineManagers.stream()
				.map( manager -&gt; manager.getEngineByName( languageName ) )
				.filter( Objects::nonNull )
				.map( engine -&gt; new ScriptEngineScriptEvaluator( engine ) )
				.findFirst()
				.orElseThrow( () -&gt; new ValidationException( String.format( "Unable to find script evaluator for '%s'.", languageName ) ) );
	}

	private List&lt;ScriptEngineManager&gt; findManagers(BundleContext context) {
		return findFactoryCandidates( context ).stream()
				.map( className -&gt; {
					try {
						return new ScriptEngineManager( Class.forName( className ).getClassLoader() );
					}
					catch (ClassNotFoundException e) {
						throw new ValidationException( "Unable to instantiate '" + className + "' based engine factory manager.", e );
					}
				} ).collect( Collectors.toList() );
	}

	/**
	 * Iterates through all bundles to get the available {@link ScriptEngineFactory} classes
	 *
	 * @return the names of the available ScriptEngineFactory classes
	 *
	 * @throws IOException
	 */
	private List&lt;String&gt; findFactoryCandidates(BundleContext context) {
		return Arrays.stream( context.getBundles() )
				.filter( Objects::nonNull )
				.filter( bundle -&gt; !"system.bundle".equals( bundle.getSymbolicName() ) )
				.flatMap( this::toStreamOfResourcesURL )
				.filter( Objects::nonNull )
				.flatMap( url -&gt; toListOfFactoryCandidates( url ).stream() )
				.collect( Collectors.toList() );
	}

	private Stream&lt;URL&gt; toStreamOfResourcesURL(Bundle bundle) {
		Enumeration&lt;URL&gt; entries = bundle.findEntries(
				"META-INF/services",
				"javax.script.ScriptEngineFactory",
				false
		);
		return entries != null ? Collections.list( entries ).stream() : Stream.empty();
	}

	private List&lt;String&gt; toListOfFactoryCandidates(URL url) {
		try ( BufferedReader reader = new BufferedReader( new InputStreamReader( url.openStream(), "UTF-8" ) ) ) {
			return reader.lines()
					.map( String::trim )
					.filter( line -&gt; !line.isEmpty() )
					.filter( line -&gt; !line.startsWith( "#" ) )
					.collect( Collectors.toList() );
		}
		catch (IOException e) {
			throw new ValidationException( "Unable to read the ScriptEngineFactory resource file", e );
		}
	}
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>and then declared with:</p>
                            </div>
                            <div class="exampleblock">
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Validator validator = Validation.byProvider( HibernateValidator.class )
		.configure()
		.scriptEvaluatorFactory(
				new OsgiScriptEvaluatorFactory( FrameworkUtil.getBundle( this.getClass() ).getBundleContext() )
		)
		.buildValidatorFactory()
		.getValidator();</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>It is designed specifically for OSGi environments and allows you to pass the <code>BundleContext</code> which will be used to search for <code>ScriptEngineFactory</code> as a parameter.</p>
                            </div>
                            <div class="paragraph">
                                <p>As already mentioned, you can also use script engines that are not based on <a href="https://www.jcp.org/en/jsr/detail?id=223">JSR 223</a>.</p>
                            </div>
                            <div class="paragraph">
                                <p>For instance, to use the <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#expressions">Spring Expression Language</a>, you can define a <code>SpringELScriptEvaluatorFactory</code>                                    as:</p>
                            </div>
                            <div class="exampleblock">
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter09;

public class SpringELScriptEvaluatorFactory extends AbstractCachingScriptEvaluatorFactory {

	@Override
	public ScriptEvaluator createNewScriptEvaluator(String languageName) {
		if ( !"spring".equalsIgnoreCase( languageName ) ) {
			throw new IllegalStateException( "Only Spring EL is supported" );
		}

		return new SpringELScriptEvaluator();
	}

	private static class SpringELScriptEvaluator implements ScriptEvaluator {

		private final ExpressionParser expressionParser = new SpelExpressionParser();

		@Override
		public Object evaluate(String script, Map&lt;String, Object&gt; bindings) throws ScriptEvaluationException {
			try {
				Expression expression = expressionParser.parseExpression( script );
				EvaluationContext context = new StandardEvaluationContext( bindings.values().iterator().next() );
				for ( Entry&lt;String, Object&gt; binding : bindings.entrySet() ) {
					context.setVariable( binding.getKey(), binding.getValue() );
				}
				return expression.getValue( context );
			}
			catch (ParseException | EvaluationException e) {
				throw new ScriptEvaluationException( "Unable to evaluate SpEL script", e );
			}
		}
	}
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>This factory allows to use Spring Expression Language in <code>ScriptAssert</code> and <code>ParameterScriptAssert</code> constraints:
                                </p>
                            </div>
                            <div class="exampleblock">
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">@ScriptAssert(script = "value &gt; 0", lang = "spring")
public class Foo {

	private final int value;

	private Foo(int value) {
		this.value = value;
	}

	public int getValue() {
		return value;
	}
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-configuring-validator">
                        <a class="anchor" href="#section-configuring-validator"></a>9.3. Configuring a Validator</h3>
                    <div class="paragraph">
                        <p>When working with a configured validator factory it can occasionally be required to apply a different configuration to a single <code>Validator</code> instance. <a href="#example-using-context">Example 116, &#8220;Configuring a <code>Validator</code> instance via <code>usingContext()</code>&#8221;</a>                            shows how this can be achieved by calling <code>ValidatorFactory#usingContext()</code>.</p>
                    </div>
                    <div id="example-using-context" class="exampleblock">
                        <div class="title">Example 116. Configuring a <code>Validator</code> instance via <code>usingContext()</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.buildDefaultValidatorFactory();

Validator validator = validatorFactory.usingContext()
		.messageInterpolator( new MyMessageInterpolator() )
		.traversableResolver( new MyTraversableResolver() )
		.getValidator();</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="validator-metadata-api">
                <a class="anchor" href="#validator-metadata-api"></a>10. Using constraint metadata</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>The Jakarta Bean Validation specification provides not only a validation engine, but also an API for retrieving constraint metadata in a uniform way, no matter whether the constraints are declared using annotations or via XML mappings.
                        Read this chapter to learn more about this API and its possibilities. You can find all the metadata API types in the package <code>jakarta.validation.metadata</code>.</p>
                </div>
                <div class="paragraph">
                    <p>The examples presented in this chapter are based on the classes and constraint declarations shown in
                        <a href="#metadata-example-car">Example 117, &#8220;Example classes&#8221;</a>.</p>
                </div>
                <div id="metadata-example-car" class="exampleblock">
                    <div class="title">Example 117. Example classes</div>
                    <div class="content">
                        <div class="listingblock">
                            <div class="content">
                                <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10;

public class Person {

	public interface Basic {
	}

	@NotNull
	private String name;

	//getters and setters ...
}</code></pre>
                            </div>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10;

public interface Vehicle {

	public interface Basic {
	}

	@NotNull(groups = Vehicle.Basic.class)
	String getManufacturer();
}</code></pre>
                            </div>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10;

@ValidCar
public class Car implements Vehicle {

	public interface SeverityInfo extends Payload {
	}

	private String manufacturer;

	@NotNull
	@Size(min = 2, max = 14)
	private String licensePlate;

	private Person driver;

	private String modelName;

	public Car() {
	}

	public Car(
			@NotNull String manufacturer,
			String licencePlate,
			Person driver,
			String modelName) {

		this.manufacturer = manufacturer;
		this.licensePlate = licencePlate;
		this.driver = driver;
		this.modelName = modelName;
	}

	public void driveAway(@Max(75) int speed) {
		//...
	}

	@LuggageCountMatchesPassengerCount(
			piecesOfLuggagePerPassenger = 2,
			validationAppliesTo = ConstraintTarget.PARAMETERS,
			payload = SeverityInfo.class,
			message = "There must not be more than {piecesOfLuggagePerPassenger} pieces " +
					"of luggage per passenger."
	)
	public void load(List&lt;Person&gt; passengers, List&lt;PieceOfLuggage&gt; luggage) {
		//...
	}

	@Override
	@Size(min = 3)
	public String getManufacturer() {
		return manufacturer;
	}

	public void setManufacturer(String manufacturer) {
		this.manufacturer = manufacturer;
	}

	@Valid
	@ConvertGroup(from = Default.class, to = Person.Basic.class)
	public Person getDriver() {
		return driver;
	}

	//further getters and setters...
}</code></pre>
                            </div>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10;

public class Library {

	@NotNull
	private String name;

	private List&lt;@NotNull @Valid Book&gt; books;

	//getters and setters ...
}</code></pre>
                            </div>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter10;

public class Book {

	@NotEmpty
	private String title;

	@NotEmpty
	private String author;

	//getters and setters ...
}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_beandescriptor">
                        <a class="anchor" href="#_beandescriptor"></a>10.1. <code>BeanDescriptor</code></h3>
                    <div class="paragraph">
                        <p>The entry point into the metadata API is the method <code>Validator#getConstraintsForClass()</code>, which returns an instance of the {bvApiDocsUrl}?jakarta/validation/metadata/BeanDescriptor.html[<code>BeanDescriptor</code>] interface.
                            Using this descriptor, you can obtain metadata for constraints declared directly on the bean itself (class- or property-level), but also retrieve metadata descriptors representing single properties, methods and constructors.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p><a href="#metadata-example-using-beandescriptor">Example 118, &#8220;Using <code>BeanDescriptor</code>&#8221;</a> demonstrates how to retrieve a <code>BeanDescriptor</code> for the
                            <code>Car</code> class and how to use this descriptor in form of assertions.</p>
                    </div>
                    <div class="admonitionblock tip">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Tip</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>If a constraint declaration hosted by the requested class is invalid, a <code>ValidationException</code> is thrown.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div id="metadata-example-using-beandescriptor" class="exampleblock">
                        <div class="title">Example 118. Using <code>BeanDescriptor</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">BeanDescriptor carDescriptor = validator.getConstraintsForClass( Car.class );

assertTrue( carDescriptor.isBeanConstrained() );

//one class-level constraint
assertEquals( 1, carDescriptor.getConstraintDescriptors().size() );

//manufacturer, licensePlate, driver
assertEquals( 3, carDescriptor.getConstrainedProperties().size() );

//property has constraint
assertNotNull( carDescriptor.getConstraintsForProperty( "licensePlate" ) );

//property is marked with @Valid
assertNotNull( carDescriptor.getConstraintsForProperty( "driver" ) );

//constraints from getter method in interface and implementation class are returned
assertEquals(
		2,
		carDescriptor.getConstraintsForProperty( "manufacturer" )
				.getConstraintDescriptors()
				.size()
);

//property is not constrained
assertNull( carDescriptor.getConstraintsForProperty( "modelName" ) );

//driveAway(int), load(List&lt;Person&gt;, List&lt;PieceOfLuggage&gt;)
assertEquals( 2, carDescriptor.getConstrainedMethods( MethodType.NON_GETTER ).size() );

//driveAway(int), getManufacturer(), getDriver(), load(List&lt;Person&gt;, List&lt;PieceOfLuggage&gt;)
assertEquals(
		4,
		carDescriptor.getConstrainedMethods( MethodType.NON_GETTER, MethodType.GETTER )
				.size()
);

//driveAway(int)
assertNotNull( carDescriptor.getConstraintsForMethod( "driveAway", int.class ) );

//getManufacturer()
assertNotNull( carDescriptor.getConstraintsForMethod( "getManufacturer" ) );

//setManufacturer() is not constrained
assertNull( carDescriptor.getConstraintsForMethod( "setManufacturer", String.class ) );

//Car(String, String, Person, String)
assertEquals( 1, carDescriptor.getConstrainedConstructors().size() );

//Car(String, String, Person, String)
assertNotNull(
		carDescriptor.getConstraintsForConstructor(
				String.class,
				String.class,
				Person.class,
				String.class
		)
);</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You can determine whether the specified class hosts any class- or property-level constraints via
                            <code>isBeanConstrained()</code>. Method or constructor constraints are not considered by <code>isBeanConstrained()</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p>The method <code>getConstraintDescriptors()</code> is common to all descriptors derived from <code>ElementDescriptor</code> (see <a href="#validator-metadata-api-elementdescriptor">Section 10.4, &#8220;<code>ElementDescriptor</code>&#8221;</a>)
                            and returns a set of descriptors representing the constraints directly declared on the given element. In case of <code>BeanDescriptor</code>, the bean&#8217;s class- level constraints are returned. More details on <code>ConstraintDescriptor</code>                            can be found in
                            <a href="#section-constraint-descriptor">Section 10.7, &#8220;<code>ConstraintDescriptor</code>&#8221;</a>.</p>
                    </div>
                    <div class="paragraph">
                        <p>Via <code>getConstraintsForProperty()</code>, <code>getConstraintsForMethod()</code> and <code>getConstraintsForConstructor()</code> you can obtain a descriptor representing one given property or executable element, identified
                            by its name and, in case of methods and constructors, parameter types. The different descriptor types returned by these methods are described in the following sections.</p>
                    </div>
                    <div class="paragraph">
                        <p>Note that these methods consider constraints declared at super-types according to the rules for constraint inheritance as described in <a href="#section-constraint-inheritance">Section 2.1.5, &#8220;约束继承&#8221;</a>. An example
                            is the descriptor for the <code>manufacturer</code> property, which provides access to all constraints defined on
                            <code>Vehicle#getManufacturer()</code> and the implementing method <code>Car#getManufacturer()</code>. <code>null</code> is returned in case the specified element does not exist or is not constrained.</p>
                    </div>
                    <div class="paragraph">
                        <p>The methods <code>getConstrainedProperties()</code>, <code>getConstrainedMethods()</code> and <code>getConstrainedConstructors()</code> return (potentially empty) sets with all constrained properties, methods and constructors,
                            respectively. An element is considered constrained if it has at least one constraint or is marked for cascaded validation. When invoking <code>getConstrainedMethods()</code>, you can specify the type of the methods to be returned
                            (getters, non-getters or both).</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-property-descriptor">
                        <a class="anchor" href="#section-property-descriptor"></a>10.2. <code>PropertyDescriptor</code></h3>
                    <div class="paragraph">
                        <p>The interface {bvApiDocsUrl}?jakarta/validation/metadata/PropertyDescriptor.html[
                            <code>PropertyDescriptor</code>] represents one given property of a class. It is transparent whether constraints are declared on a field or a property getter, provided the JavaBeans naming conventions are respected. <a href="#metadata-example-using-propertydescriptor">Example 119, &#8220;Using <code>PropertyDescriptor</code>&#8221;</a>                            shows how to use the <code>PropertyDescriptor</code> interface.</p>
                    </div>
                    <div id="metadata-example-using-propertydescriptor" class="exampleblock">
                        <div class="title">Example 119. Using <code>PropertyDescriptor</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">PropertyDescriptor licensePlateDescriptor = carDescriptor.getConstraintsForProperty(
		"licensePlate"
);

//"licensePlate" has two constraints, is not marked with @Valid and defines no group conversions
assertEquals( "licensePlate", licensePlateDescriptor.getPropertyName() );
assertEquals( 2, licensePlateDescriptor.getConstraintDescriptors().size() );
assertTrue( licensePlateDescriptor.hasConstraints() );
assertFalse( licensePlateDescriptor.isCascaded() );
assertTrue( licensePlateDescriptor.getGroupConversions().isEmpty() );

PropertyDescriptor driverDescriptor = carDescriptor.getConstraintsForProperty( "driver" );

//"driver" has no constraints, is marked with @Valid and defines one group conversion
assertEquals( "driver", driverDescriptor.getPropertyName() );
assertTrue( driverDescriptor.getConstraintDescriptors().isEmpty() );
assertFalse( driverDescriptor.hasConstraints() );
assertTrue( driverDescriptor.isCascaded() );
assertEquals( 1, driverDescriptor.getGroupConversions().size() );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Using <code>getConstraintDescriptors()</code>, you can retrieve a set of <code>ConstraintDescriptors</code> providing more information on the individual constraints of a given property. The method <code>isCascaded()</code> returns
                            <code>true</code> if the property is marked for cascaded validation (either using the <code>@Valid</code> annotation or via XML), <code>false</code> otherwise. Any configured group conversions are returned by <code>getGroupConversions()</code>.
                            See
                            <a href="#section-group-conversion-descriptor">Section 10.6, &#8220;<code>GroupConversionDescriptor</code>&#8221;</a> for more details on <code>GroupConversionDescriptor</code>.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_methoddescriptor_and_constructordescriptor">
                        <a class="anchor" href="#_methoddescriptor_and_constructordescriptor"></a>10.3. <code>MethodDescriptor</code> and <code>ConstructorDescriptor</code></h3>
                    <div class="paragraph">
                        <p>Constrained methods and constructors are represented by the interfaces {bvApiDocsUrl}?jakarta/validation/metadata/MethodDescriptor.html[
                            <code>MethodDescriptor</code>] {bvApiDocsUrl}?jakarta/validation/metadata/ConstructorDescriptor.html[
                            <code>ConstructorDescriptor</code>], respectively.
                            <a href="#metadata-example-using-methodandconstructordescriptor">Example 120, &#8220;Using <code>MethodDescriptor</code> and <code>ConstructorDescriptor</code>&#8221;</a> demonstrates how to work with these descriptors.
                        </p>
                    </div>
                    <div id="metadata-example-using-methodandconstructordescriptor" class="exampleblock">
                        <div class="title">Example 120. Using <code>MethodDescriptor</code> and <code>ConstructorDescriptor</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">//driveAway(int) has a constrained parameter and an unconstrained return value
MethodDescriptor driveAwayDescriptor = carDescriptor.getConstraintsForMethod(
		"driveAway",
		int.class
);
assertEquals( "driveAway", driveAwayDescriptor.getName() );
assertTrue( driveAwayDescriptor.hasConstrainedParameters() );
assertFalse( driveAwayDescriptor.hasConstrainedReturnValue() );

//always returns an empty set; constraints are retrievable by navigating to
//one of the sub-descriptors, e.g. for the return value
assertTrue( driveAwayDescriptor.getConstraintDescriptors().isEmpty() );

ParameterDescriptor speedDescriptor = driveAwayDescriptor.getParameterDescriptors()
		.get( 0 );

//The "speed" parameter is located at index 0, has one constraint and is not cascaded
//nor does it define group conversions
assertEquals( "speed", speedDescriptor.getName() );
assertEquals( 0, speedDescriptor.getIndex() );
assertEquals( 1, speedDescriptor.getConstraintDescriptors().size() );
assertFalse( speedDescriptor.isCascaded() );
assert speedDescriptor.getGroupConversions().isEmpty();

//getDriver() has no constrained parameters but its return value is marked for cascaded
//validation and declares one group conversion
MethodDescriptor getDriverDescriptor = carDescriptor.getConstraintsForMethod(
		"getDriver"
);
assertFalse( getDriverDescriptor.hasConstrainedParameters() );
assertTrue( getDriverDescriptor.hasConstrainedReturnValue() );

ReturnValueDescriptor returnValueDescriptor = getDriverDescriptor.getReturnValueDescriptor();
assertTrue( returnValueDescriptor.getConstraintDescriptors().isEmpty() );
assertTrue( returnValueDescriptor.isCascaded() );
assertEquals( 1, returnValueDescriptor.getGroupConversions().size() );

//load(List&lt;Person&gt;, List&lt;PieceOfLuggage&gt;) has one cross-parameter constraint
MethodDescriptor loadDescriptor = carDescriptor.getConstraintsForMethod(
		"load",
		List.class,
		List.class
);
assertTrue( loadDescriptor.hasConstrainedParameters() );
assertFalse( loadDescriptor.hasConstrainedReturnValue() );
assertEquals(
		1,
		loadDescriptor.getCrossParameterDescriptor().getConstraintDescriptors().size()
);

//Car(String, String, Person, String) has one constrained parameter
ConstructorDescriptor constructorDescriptor = carDescriptor.getConstraintsForConstructor(
		String.class,
		String.class,
		Person.class,
		String.class
);

assertEquals( "Car", constructorDescriptor.getName() );
assertFalse( constructorDescriptor.hasConstrainedReturnValue() );
assertTrue( constructorDescriptor.hasConstrainedParameters() );
assertEquals(
		1,
		constructorDescriptor.getParameterDescriptors()
				.get( 0 )
				.getConstraintDescriptors()
				.size()
);</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p><code>getName()</code> returns the name of the given method or constructor. The methods
                            <code>hasConstrainedParameters()</code> and <code>hasConstrainedReturnValue()</code> can be used to perform a quick check whether an executable element has any parameter constraints (either constraints on single parameters
                            or cross-parameter constraints) or return value constraints.</p>
                    </div>
                    <div class="paragraph">
                        <p>Note that constraints are not directly exposed on <code>MethodDescriptor</code> and <code>ConstructorDescriptor</code>, but rather on dedicated descriptors representing an executable&#8217;s parameters, its return value and its
                            cross-parameter constraints. To get hold of one of these descriptors, invoke
                            <code>getParameterDescriptors()</code>, <code>getReturnValueDescriptor()</code> or <code>getCrossParameterDescriptor()</code>, respectively.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>These descriptors provide access to the element&#8217;s constraints (<code>getConstraintDescriptors()</code>) and, in the case of parameters and return value, to its configuration for cascaded validation (<code>isValid()</code>                            and
                            <code>getGroupConversions()</code>). For parameters, you also can retrieve the index and the name, as returned by the currently used parameter name provider (see <a href="#section-parameter-name-provider">Section 9.2.4, &#8220;<code>ParameterNameProvider</code>&#8221;</a>)
                            via <code>getName()</code> and <code>getIndex()</code>.</p>
                    </div>
                    <div class="admonitionblock tip">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Tip</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>Getter methods following the JavaBeans naming conventions are considered as bean properties but also as constrained methods.</p>
                                    </div>
                                    <div class="paragraph">
                                        <p>That means you can retrieve the related metadata either by obtaining a <code>PropertyDescriptor</code> (e.g.
                                            <code>BeanDescriptor.getConstraintsForProperty("foo")</code>) or by examining the return value descriptor of the getter&#8217;s <code>MethodDescriptor</code> (e.g.
                                            <code>BeanDescriptor.getConstraintsForMethod("getFoo").getReturnValueDescriptor())</code>.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="validator-metadata-api-elementdescriptor">
                        <a class="anchor" href="#validator-metadata-api-elementdescriptor"></a>10.4. <code>ElementDescriptor</code></h3>
                    <div class="paragraph">
                        <p>The {bvApiDocsUrl}?jakarta/validation/metadata/ElementDescriptor.html[<code>ElementDescriptor</code>] interface is the common base class for the individual descriptor types such as <code>BeanDescriptor</code>, <code>PropertyDescriptor</code>                            etc. Besides
                            <code>getConstraintDescriptors()</code> it provides some more methods common to all descriptors.</p>
                    </div>
                    <div class="paragraph">
                        <p><code>hasConstraints()</code> allows for a quick check whether an element has any direct constraints (e.g. class- level constraints in case of <code>BeanDescriptor</code>).</p>
                    </div>
                    <div class="paragraph">
                        <p><code>getElementClass()</code> returns the Java type of the element represented by a given descriptor. More specifically, the method returns</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>the object type when invoked on <code>BeanDescriptor</code>,</p>
                            </li>
                            <li>
                                <p>the type of a property or parameter when invoked on <code>PropertyDescriptor</code> or <code>ParameterDescriptor</code> respectively,
                                </p>
                            </li>
                            <li>
                                <p><code>Object[].class</code> when invoked on <code>CrossParameterDescriptor</code>,</p>
                            </li>
                            <li>
                                <p>the return type when invoked on <code>ConstructorDescriptor</code>, <code>MethodDescriptor</code> or <code>ReturnValueDescriptor</code>.
                                    <code>void.class</code> will be returned for methods which don&#8217;t have a return value.</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p><a href="#metadata-example-using-elementdescriptor">Example 121, &#8220;Using <code>ElementDescriptor methods</code>&#8221;</a> shows how these methods are used.</p>
                    </div>
                    <div id="metadata-example-using-elementdescriptor" class="exampleblock">
                        <div class="title">Example 121. Using <code>ElementDescriptor methods</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">PropertyDescriptor manufacturerDescriptor = carDescriptor.getConstraintsForProperty(
		"manufacturer"
);

assertTrue( manufacturerDescriptor.hasConstraints() );
assertEquals( String.class, manufacturerDescriptor.getElementClass() );

CrossParameterDescriptor loadCrossParameterDescriptor = carDescriptor.getConstraintsForMethod(
		"load",
		List.class,
		List.class
).getCrossParameterDescriptor();

assertTrue( loadCrossParameterDescriptor.hasConstraints() );
assertEquals( Object[].class, loadCrossParameterDescriptor.getElementClass() );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Finally, <code>ElementDescriptor</code> offers access to the <code>ConstraintFinder</code> API which allows you to query for constraint metadata in a fine grained way. <a href="#example-constraint-finder">Example 122, &#8220;Usage of <code>ConstraintFinder</code>&#8221;</a>                            shows how to retrieve a
                            <code>ConstraintFinder</code> instance via <code>findConstraints()</code> and use the API to query for constraint metadata.</p>
                    </div>
                    <div id="example-constraint-finder" class="exampleblock">
                        <div class="title">Example 122. Usage of <code>ConstraintFinder</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">PropertyDescriptor manufacturerDescriptor = carDescriptor.getConstraintsForProperty(
		"manufacturer"
);

//"manufacturer" constraints are declared on the getter, not the field
assertTrue(
		manufacturerDescriptor.findConstraints()
				.declaredOn( ElementType.FIELD )
				.getConstraintDescriptors()
				.isEmpty()
);

//@NotNull on Vehicle#getManufacturer() is part of another group
assertEquals(
		1,
		manufacturerDescriptor.findConstraints()
				.unorderedAndMatchingGroups( Default.class )
				.getConstraintDescriptors()
				.size()
);

//@Size on Car#getManufacturer()
assertEquals(
		1,
		manufacturerDescriptor.findConstraints()
				.lookingAt( Scope.LOCAL_ELEMENT )
				.getConstraintDescriptors()
				.size()
);

//@Size on Car#getManufacturer() and @NotNull on Vehicle#getManufacturer()
assertEquals(
		2,
		manufacturerDescriptor.findConstraints()
				.lookingAt( Scope.HIERARCHY )
				.getConstraintDescriptors()
				.size()
);

//Combining several filter options
assertEquals(
		1,
		manufacturerDescriptor.findConstraints()
				.declaredOn( ElementType.METHOD )
				.lookingAt( Scope.HIERARCHY )
				.unorderedAndMatchingGroups( Vehicle.Basic.class )
				.getConstraintDescriptors()
				.size()
);</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Via <code>declaredOn()</code> you can search for <code>ConstraintDescriptors</code> declared on certain element types. This is useful to find property constraints declared on either fields or getter methods.</p>
                    </div>
                    <div class="paragraph">
                        <p><code>unorderedAndMatchingGroups()</code> restricts the resulting constraints to those matching the given validation group(s).</p>
                    </div>
                    <div class="paragraph">
                        <p><code>lookingAt()</code> allows to distinguish between constraints directly specified on the element (
                            <code>Scope.LOCAL_ELEMENT</code>) or constraints belonging to the element but hosted anywhere in the class hierarchy (<code>Scope.HIERARCHY</code>).</p>
                    </div>
                    <div class="paragraph">
                        <p>You can also combine the different options as shown in the last example.</p>
                    </div>
                    <div class="admonitionblock warning">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Warning</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>Order is not respected by <code>unorderedAndMatchingGroups()</code>, but group inheritance and inheritance via sequence are.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_containerdescriptor_and_containerelementtypedescriptor">
                        <a class="anchor" href="#_containerdescriptor_and_containerelementtypedescriptor"></a>10.5. <code>ContainerDescriptor</code> and <code>ContainerElementTypeDescriptor</code></h3>
                    <div class="paragraph">
                        <p>The {bvApiDocsUrl}?jakarta/validation/metadata/ContainerDescriptor.html[<code>ContainerDescriptor</code>] interface is the common interface for all the elements that support container element constraints and cascading validation
                            (<code>PropertyDescriptor</code>, <code>ParameterDescriptor</code>, <code>ReturnValueDescriptor</code>).</p>
                    </div>
                    <div class="paragraph">
                        <p>It has a single method <code>getConstrainedContainerElementTypes()</code> that returns a set of <code>ContainerElementTypeDescriptor</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p><code>ContainerElementTypeDescriptor</code> extends <code>ContainerDescriptor</code> to support nested container element constraints.</p>
                    </div>
                    <div class="paragraph">
                        <p><code>ContainerElementTypeDescriptor</code> contains the information about the container, the constraints and the cascading validation.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p><a href="#metadata-example-using-containerelementtypedescriptor">Example 123, &#8220;Using <code>ContainerElementTypeDescriptor</code>&#8221;</a> shows how to use <code>getConstrainedContainerElementTypes()</code> to retrieve the
                            set of <code>ContainerElementTypeDescriptor</code>.</p>
                    </div>
                    <div id="metadata-example-using-containerelementtypedescriptor" class="exampleblock">
                        <div class="title">Example 123. Using <code>ContainerElementTypeDescriptor</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">PropertyDescriptor booksDescriptor = libraryDescriptor.getConstraintsForProperty(
		"books"
);

Set&lt;ContainerElementTypeDescriptor&gt; booksContainerElementTypeDescriptors =
		booksDescriptor.getConstrainedContainerElementTypes();
ContainerElementTypeDescriptor booksContainerElementTypeDescriptor =
		booksContainerElementTypeDescriptors.iterator().next();

assertTrue( booksContainerElementTypeDescriptor.hasConstraints() );
assertTrue( booksContainerElementTypeDescriptor.isCascaded() );
assertEquals(
		0,
		booksContainerElementTypeDescriptor.getTypeArgumentIndex().intValue()
);
assertEquals(
		List.class,
		booksContainerElementTypeDescriptor.getContainerClass()
);

Set&lt;ConstraintDescriptor&lt;?&gt;&gt; constraintDescriptors =
		booksContainerElementTypeDescriptor.getConstraintDescriptors();
ConstraintDescriptor&lt;?&gt; constraintDescriptor =
		constraintDescriptors.iterator().next();

assertEquals(
		NotNull.class,
		constraintDescriptor.getAnnotation().annotationType()
);</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-group-conversion-descriptor">
                        <a class="anchor" href="#section-group-conversion-descriptor"></a>10.6. <code>GroupConversionDescriptor</code></h3>
                    <div class="paragraph">
                        <p>All those descriptor types that represent elements which can be subject of cascaded validation (i.e., <code>PropertyDescriptor</code>, <code>ParameterDescriptor</code> and <code>ReturnValueDescriptor</code>) provide access to the
                            element&#8217;s group conversions via <code>getGroupConversions()</code>. The returned set contains a {bvApiDocsUrl}?jakarta/validation//metadata/GroupConversionDescriptor.html[
                            <code>GroupConversionDescriptor</code>] for each configured conversion, allowing to retrieve source and target groups of the conversion. <a href="#metadata-example-using-groupconversiondescriptor">Example 124, &#8220;Using <code>GroupConversionDescriptor</code>&#8221;</a>                            shows an example.</p>
                    </div>
                    <div id="metadata-example-using-groupconversiondescriptor" class="exampleblock">
                        <div class="title">Example 124. Using <code>GroupConversionDescriptor</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">PropertyDescriptor driverDescriptor = carDescriptor.getConstraintsForProperty( "driver" );

Set&lt;GroupConversionDescriptor&gt; groupConversions = driverDescriptor.getGroupConversions();
assertEquals( 1, groupConversions.size() );

GroupConversionDescriptor groupConversionDescriptor = groupConversions.iterator()
		.next();
assertEquals( Default.class, groupConversionDescriptor.getFrom() );
assertEquals( Person.Basic.class, groupConversionDescriptor.getTo() );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-constraint-descriptor">
                        <a class="anchor" href="#section-constraint-descriptor"></a>10.7. <code>ConstraintDescriptor</code></h3>
                    <div class="paragraph">
                        <p>Last but not least, the {bvApiDocsUrl}?jakarta/validation/metadata/ConstraintDescriptor.html[
                            <code>ConstraintDescriptor</code>] interface describes a single constraint together with its composing constraints. Via an instance of this interface you get access to the constraint annotation and its parameters.</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="#metadata-example-using-constraintdescriptor">Example 125, &#8220;Using <code>ConstraintDescriptor</code>&#8221;</a> shows how to retrieve default constraint attributes (such as message template, groups etc.) as well as
                            custom constraint attributes (<code>piecesOfLuggagePerPassenger</code>) and other metadata such as the constraint&#8217;s annotation type and its validators from a <code>ConstraintDescriptor</code>.</p>
                    </div>
                    <div id="metadata-example-using-constraintdescriptor" class="exampleblock">
                        <div class="title">Example 125. Using <code>ConstraintDescriptor</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">//descriptor for the @LuggageCountMatchesPassengerCount constraint on the
//load(List&lt;Person&gt;, List&lt;PieceOfLuggage&gt;) method
ConstraintDescriptor&lt;?&gt; constraintDescriptor = carDescriptor.getConstraintsForMethod(
		"load",
		List.class,
		List.class
).getCrossParameterDescriptor().getConstraintDescriptors().iterator().next();

//constraint type
assertEquals(
		LuggageCountMatchesPassengerCount.class,
		constraintDescriptor.getAnnotation().annotationType()
);

//standard constraint attributes
assertEquals( SeverityInfo.class, constraintDescriptor.getPayload().iterator().next() );
assertEquals(
		ConstraintTarget.PARAMETERS,
		constraintDescriptor.getValidationAppliesTo()
);
assertEquals( Default.class, constraintDescriptor.getGroups().iterator().next() );
assertEquals(
		"There must not be more than {piecesOfLuggagePerPassenger} pieces of luggage per " +
		"passenger.",
		constraintDescriptor.getMessageTemplate()
);

//custom constraint attribute
assertEquals(
		2,
		constraintDescriptor.getAttributes().get( "piecesOfLuggagePerPassenger" )
);

//no composing constraints
assertTrue( constraintDescriptor.getComposingConstraints().isEmpty() );

//validator class
assertEquals(
		Arrays.&lt;Class&lt;?&gt;&gt;asList( LuggageCountMatchesPassengerCount.Validator.class ),
		constraintDescriptor.getConstraintValidatorClasses()
);</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="validator-integration">
                <a class="anchor" href="#validator-integration"></a>11. Integrating with other frameworks</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>Hibernate Validator is intended to be used to implement multi-layered data validation, where constraints are expressed in a single place (the annotated domain model) and checked in various different layers of the application. For this
                        reason there are multiple integration points with other technologies.</p>
                </div>
                <div class="sect2">
                    <h3 id="validator-checkconstraints-orm">
                        <a class="anchor" href="#validator-checkconstraints-orm"></a>11.1. ORM integration</h3>
                    <div class="paragraph">
                        <p>Hibernate Validator integrates with both Hibernate ORM and all pure Java Persistence providers.</p>
                    </div>
                    <div class="admonitionblock tip">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Tip</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>When lazy loaded associations are supposed to be validated it is recommended to place the constraint on the getter of the association. Hibernate ORM replaces lazy loaded associations with proxy instances which get
                                            initialized/loaded when requested via the getter. If, in such a case, the constraint is placed on field level, the actual proxy instance is used which will lead to validation errors.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="sect3">
                        <h4 id="validator-checkconstraints-db">
                            <a class="anchor" href="#validator-checkconstraints-db"></a>11.1.1. Database schema-level validation</h4>
                        <div class="paragraph">
                            <p>Out of the box, Hibernate ORM will translate the constraints you have defined for your entities into mapping metadata. For example, if a property of your entity is annotated
                                <code>@NotNull</code>, its columns will be declared as <code>not null</code> in the DDL schema generated by Hibernate ORM.</p>
                        </div>
                        <div class="paragraph">
                            <p>If, for some reason, the feature needs to be disabled, set <code>hibernate.validator.apply_to_ddl</code> to
                                <code>false</code>. See also <a href="#validator-defineconstraints-spec">Section 2.3.1, &#8220;Jakarta Bean Validation 约束&#8221;</a> and <a href="#validator-defineconstraints-hv-constraints">Section 2.3.2, &#8220;附加约束&#8221;</a>.</p>
                        </div>
                        <div class="paragraph">
                            <p>You can also limit the DDL constraint generation to a subset of the defined constraints by setting the property <code>org.hibernate.validator.group.ddl</code>. The property specifies the comma-separated, fully specified class
                                names of the groups a constraint has to be part of in order to be considered for DDL schema generation.</p>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="validator-checkconstraints-orm-hibernateevent">
                            <a class="anchor" href="#validator-checkconstraints-orm-hibernateevent"></a>11.1.2. Hibernate ORM event-based validation</h4>
                        <div class="paragraph">
                            <p>Hibernate Validator has a built-in Hibernate event listener -
                                <a href="https://github.com/hibernate/hibernate-orm/blob/master/hibernate-core/src/main/java/org/hibernate/cfg/beanvalidation/BeanValidationEventListener.java"><code>org.hibernate.cfg.beanvalidation.BeanValidationEventListener</code></a>                                - which is part of Hibernate ORM. Whenever a <code>PreInsertEvent</code>,
                                <code>PreUpdateEvent</code> or <code>PreDeleteEvent</code> occurs, the listener will verify all constraints of the entity instance and throw an exception if any constraint is violated. Per default, objects will be checked
                                before any inserts or updates are made by Hibernate ORM. Pre deletion events will per default not trigger a validation. You can configure the groups to be validated per event type using the properties <code>jakarta.persistence.validation.group.pre-persist</code>,
                                <code>jakarta.persistence.validation.group.pre-update</code> and <code>jakarta.persistence.validation.group.pre-remove</code>. The values of these properties are the comma-separated fully specified class names of the groups
                                to validate. <a href="#example-beanvalidationeventlistener-config">Example 126, &#8220;Manual configuration of <code>BeanValidationEvenListener</code>&#8221;</a> shows the default values for these properties. In this case
                                they could also be omitted.</p>
                        </div>
                        <div class="paragraph">
                            <p>On constraint violation, the event will raise a runtime <code>ConstraintViolationException</code> which contains a set of <code>ConstraintViolation</code> instances describing each failure.</p>
                        </div>
                        <div class="paragraph">
                            <p>If Hibernate Validator is present in the classpath, Hibernate ORM will use it transparently. To avoid validation even though Hibernate Validator is in the classpath, set
                                <code>jakarta.persistence.validation.mode</code> to none.</p>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>If the beans are not annotated with validation annotations, there is no runtime performance cost.</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="paragraph">
                            <p>In case you need to manually set the event listeners for Hibernate ORM, use the following configuration in <em>hibernate.cfg.xml</em>:</p>
                        </div>
                        <div id="example-beanvalidationeventlistener-config" class="exampleblock">
                            <div class="title">Example 126. Manual configuration of <code>BeanValidationEvenListener</code></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;hibernate-configuration&gt;
    &lt;session-factory&gt;
        ...
        &lt;property name="jakarta.persistence.validation.group.pre-persist"&gt;
            jakarta.validation.groups.Default
        &lt;/property&gt;
        &lt;property name="jakarta.persistence.validation.group.pre-update"&gt;
            jakarta.validation.groups.Default
        &lt;/property&gt;
        &lt;property name="jakarta.persistence.validation.group.pre-remove"&gt;&lt;/property&gt;
        ...
        &lt;event type="pre-update"&gt;
            &lt;listener class="org.hibernate.cfg.beanvalidation.BeanValidationEventListener"/&gt;
        &lt;/event&gt;
        &lt;event type="pre-insert"&gt;
            &lt;listener class="org.hibernate.cfg.beanvalidation.BeanValidationEventListener"/&gt;
        &lt;/event&gt;
        &lt;event type="pre-delete"&gt;
            &lt;listener class="org.hibernate.cfg.beanvalidation.BeanValidationEventListener"/&gt;
        &lt;/event&gt;
    &lt;/session-factory&gt;
&lt;/hibernate-configuration&gt;</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_jpa">
                            <a class="anchor" href="#_jpa"></a>11.1.3. JPA</h4>
                        <div class="paragraph">
                            <p>If you are using JPA 2 and Hibernate Validator is in the classpath, the JPA2 specification requires that Jakarta Bean Validation gets enabled. The properties <code>jakarta.persistence.validation.group.pre-persist</code>,
                                <code>jakarta.persistence.validation.group.pre-update</code> and <code>jakarta.persistence.validation.group.pre-remove</code> as described in <a href="#validator-checkconstraints-orm-hibernateevent">Section 11.1.2, &#8220;Hibernate ORM event-based validation&#8221;</a>                                can in this case be configured in
                                <em>persistence.xml</em>. <em>persistence.xml</em> also defines a node validation-mode which can be set to <code>AUTO</code>,
                                <code>CALLBACK</code> or <code>NONE</code>. The default is <code>AUTO</code>.</p>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-presentation-layer">
                        <a class="anchor" href="#section-presentation-layer"></a>11.2. JSF &amp; Seam</h3>
                    <div class="paragraph">
                        <p>When working with JSF2 or JBoss Seam and Hibernate Validator (Jakarta Bean Validation) is present in the runtime environment, validation is triggered for every field in the application. <a href="#example-jsf2">Example 127, &#8220;Usage of Jakarta Bean Validation within JSF2&#8221;</a>                            shows an example of the <code>f:validateBean</code> tag in a JSF page. The <code>validationGroups</code> attribute is optional and can be used to specify a comma separated list of validation groups. The default is
                            <code>jakarta.validation.groups.Default</code>. For more information refer to the Seam documentation or the JSF 2 specification.
                        </p>
                    </div>
                    <div id="example-jsf2" class="exampleblock">
                        <div class="title">Example 127. Usage of Jakarta Bean Validation within JSF2</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;h:form&gt;

  &lt;f:validateBean validationGroups="jakarta.validation.groups.Default"&gt;

    &lt;h:inputText value=#{model.property}/&gt;
    &lt;h:selectOneRadio value=#{model.radioProperty}&gt; ... &lt;/h:selectOneRadio&gt;
    &lt;!-- other input components here --&gt;

  &lt;/f:validateBean&gt;

&lt;/h:form&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="admonitionblock tip">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Tip</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>The integration between JSF 2 and Jakarta Bean Validation is described in the "Jakarta Bean Validation Integration" chapter of <a href="http://jcp.org/en/jsr/detail?id=314">JSR-314</a>. It is interesting to know
                                            that JSF 2 implements a custom <code>MessageInterpolator</code> to ensure proper localization. To encourage the use of the Jakarta Bean Validation message facility, JSF 2 will per default only display the generated
                                            Bean Validation message. This can, however, be configured via the application resource bundle by providing the following configuration (<code>{0}</code> is replaced with the Jakarta Bean Validation message and
                                            <code>{1}</code> is replaced with the JSF component label):</p>
                                    </div>
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre>jakarta.faces.validator.BeanValidator.MESSAGE={1}: {0}</pre>
                                        </div>
                                    </div>
                                    <div class="paragraph">
                                        <p>The default is:</p>
                                    </div>
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre>jakarta.faces.validator.BeanValidator.MESSAGE={0}</pre>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-integration-with-cdi">
                        <a class="anchor" href="#section-integration-with-cdi"></a>11.3. CDI</h3>
                    <div class="paragraph">
                        <p>As of version 1.1, Bean Validation (and therefore Jakarta Bean Validation) is integrated with CDI (Contexts and Dependency Injection for Jakarta EE).</p>
                    </div>
                    <div class="paragraph">
                        <p>This integration provides CDI managed beans for <code>Validator</code> and <code>ValidatorFactory</code> and enables dependency injection in constraint validators as well as custom message interpolators, traversable resolvers,
                            constraint validator factories, parameter name providers, clock providers and value extractors.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>Furthermore, parameter and return value constraints on the methods and constructors of CDI managed beans will automatically be validated upon invocation.</p>
                    </div>
                    <div class="paragraph">
                        <p>When your application runs on a Java EE container, this integration is enabled by default. When working with CDI in a Servlet container or in a pure Java SE environment, you can use the CDI portable extension provided by Hibernate
                            Validator. To do so, add the portable extension to your class path as described in <a href="#section-getting-started-cdi">Section 1.1.2, &#8220;CDI&#8221;</a>.</p>
                    </div>
                    <div class="sect3">
                        <h4 id="_dependency_injection">
                            <a class="anchor" href="#_dependency_injection"></a>11.3.1. Dependency injection</h4>
                        <div class="paragraph">
                            <p>CDI&#8217;s dependency injection mechanism makes it very easy to retrieve <code>ValidatorFactory</code> and <code>Validator</code> instances and use them in your managed beans. Just annotate instance fields of your bean with
                                <code>@jakarta.inject.Inject</code> as shown in <a href="#example-dependency-injection">Example 128, &#8220;Retrieving validator factory and validator via <code>@Inject</code>&#8221;</a>.</p>
                        </div>
                        <div id="example-dependency-injection" class="exampleblock">
                            <div class="title">Example 128. Retrieving validator factory and validator via <code>@Inject</code></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.cdi.validator;

@ApplicationScoped
public class RentalStation {

	@Inject
	private ValidatorFactory validatorFactory;

	@Inject
	private Validator validator;

	//...
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>The injected beans are the default validator factory and validator instances. In order to configure them - e.g. to use a custom message interpolator - you can use the Jakarta Bean Validation XML descriptors as discussed in
                                <a href="#chapter-xml-configuration">Chapter 8, <em>Configuring via XML</em></a>.</p>
                        </div>
                        <div class="paragraph">
                            <p>If you are working with several Jakarta Bean Validation providers, you can make sure that factory and validator from Hibernate Validator are injected by annotating the injection points with the
                                <code>@HibernateValidator</code> qualifier which is demonstrated in <a href="#example-dependency-injection-using-hv">Example 129, &#8220;Using the <code>@HibernateValidator</code> qualifier annotation&#8221;</a>.</p>
                        </div>
                        <div id="example-dependency-injection-using-hv" class="exampleblock">
                            <div class="title">Example 129. Using the <code>@HibernateValidator</code> qualifier annotation</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.cdi.validator.qualifier;

@ApplicationScoped
public class RentalStation {

	@Inject
	@HibernateValidator
	private ValidatorFactory validatorFactory;

	@Inject
	@HibernateValidator
	private Validator validator;

	//...
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="admonitionblock tip">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Tip</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>The fully-qualified name of the qualifier annotation is
                                                <code>org.hibernate.validator.cdi.HibernateValidator</code>. Be sure to not import
                                                <code>org.hibernate.validator.HibernateValidator</code> instead which is the <code>ValidationProvider</code> implementation used for selecting Hibernate Validator when working with the bootstrapping API
                                                (see
                                                <a href="#section-retrieving-validator-factory-validator">Section 9.1, &#8220;Retrieving <code>ValidatorFactory</code> and <code>Validator</code>&#8221;</a>).</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="paragraph">
                            <p>Via <code>@Inject</code> you also can inject dependencies into constraint validators and other Jakarta Bean Validation objects such as <code>MessageInterpolator</code> implementations etc.</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="#example-constraint-validator-injected-bean">Example 130, &#8220;Constraint validator with injected bean&#8221;</a> demonstrates how an injected CDI bean is used in a <code>ConstraintValidator</code> implementation
                                to determine whether the given constraint is valid or not. As the example shows, you also can work with the
                                <code>@PostConstruct</code> and <code>@PreDestroy</code> callbacks to implement any required construction and destruction logic.
                            </p>
                        </div>
                        <div id="example-constraint-validator-injected-bean" class="exampleblock">
                            <div class="title">Example 130. Constraint validator with injected bean</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.cdi.injection;

public class ValidLicensePlateValidator
		implements ConstraintValidator&lt;ValidLicensePlate, String&gt; {

	@Inject
	private VehicleRegistry vehicleRegistry;

	@PostConstruct
	public void postConstruct() {
		//do initialization logic...
	}

	@PreDestroy
	public void preDestroy() {
		//do destruction logic...
	}

	@Override
	public void initialize(ValidLicensePlate constraintAnnotation) {
	}

	@Override
	public boolean isValid(String licensePlate, ConstraintValidatorContext constraintContext) {
		return vehicleRegistry.isValidLicensePlate( licensePlate );
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_method_validation">
                            <a class="anchor" href="#_method_validation"></a>11.3.2. Method validation</h4>
                        <div class="paragraph">
                            <p>The method interception facilities of CDI allow for a very tight integration with Jakarta Bean Validation&#8217;s method validation functionality. Just put constraint annotations to the parameters and return values of the executables
                                of your CDI beans and they will be validated automatically before (parameter constraints) and after (return value constraints) a method or constructor is invoked.</p>
                        </div>
                        <div class="paragraph">
                            <p>Note that no explicit interceptor binding is required, instead the required method validation interceptor will automatically be registered for all managed beans with constrained methods and constructors.
                            </p>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>The interceptor <code>org.hibernate.validator.cdi.internal.interceptor.ValidationInterceptor</code> is registered by <code>org.hibernate.validator.cdi.internal.ValidationExtension</code>. This happens implicitly
                                                within a Java EE runtime environment or explicitly by adding the <em>hibernate-validator-cdi</em> artifact - see <a href="#section-getting-started-cdi">Section 1.1.2, &#8220;CDI&#8221;</a></p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="paragraph">
                            <p>You can see an example in <a href="#example-cdi-method-validation">Example 131, &#8220;CDI managed beans with method-level constraints&#8221;</a>.</p>
                        </div>
                        <div id="example-cdi-method-validation" class="exampleblock">
                            <div class="title">Example 131. CDI managed beans with method-level constraints</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.cdi.methodvalidation;

@ApplicationScoped
public class RentalStation {

	@Valid
	public RentalStation() {
		//...
	}

	@NotNull
	@Valid
	public Car rentCar(
			@NotNull Customer customer,
			@NotNull @Future Date startDate,
			@Min(1) int durationInDays) {
		//...
		return null;
	}

	@NotNull
	List&lt;Car&gt; getAvailableCars() {
		//...
		return null;
	}
}</code></pre>
                                    </div>
                                </div>
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.cdi.methodvalidation;

@RequestScoped
public class RentCarRequest {

	@Inject
	private RentalStation rentalStation;

	public void rentCar(String customerId, Date startDate, int duration) {
		//causes ConstraintViolationException
		rentalStation.rentCar( null, null, -1 );
	}
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>Here the <code>RentalStation</code> bean hosts several method constraints. When invoking one of the <code>RentalStation</code> methods from another bean such as <code>RentCarRequest</code>, the constraints of the invoked method
                                are automatically validated. If any illegal parameter values are passed as in the example, a
                                <code>ConstraintViolationException</code> will be thrown by the method interceptor, providing detailed information on the violated constraints. The same is the case if the method&#8217;s return value violates any return
                                value constraints.</p>
                        </div>
                        <div class="paragraph">
                            <p>Similarly, constructor constraints are validated automatically upon invocation. In the example the
                                <code>RentalStation</code> object returned by the constructor will be validated since the constructor return value is marked with <code>@Valid</code>.</p>
                        </div>
                        <div class="sect4">
                            <h5 id="_validated_executable_types">
                                <a class="anchor" href="#_validated_executable_types"></a>11.3.2.1. Validated executable types</h5>
                            <div class="paragraph">
                                <p>Jakarta Bean Validation allows for a fine-grained control of the executable types which are automatically validated. By default, constraints on constructors and non-getter methods are validated. Therefore the <code>@NotNull</code>                                    constraint on the method <code>RentalStation#getAvailableCars()</code> in
                                    <a href="#example-cdi-method-validation">Example 131, &#8220;CDI managed beans with method-level constraints&#8221;</a> does not get validated when the method is invoked.</p>
                            </div>
                            <div class="paragraph">
                                <p>You have the following options to configure which types of executables are validated upon invocation:
                                </p>
                            </div>
                            <div class="ulist">
                                <ul>
                                    <li>
                                        <p>Configure the executable types globally via the XML descriptor <em>META-INF/validation.xml</em>; see <a href="#section-configuration-validation-xml">Section 8.1, &#8220;Configuring the validator factory in <em>validation.xml</em>&#8221;</a>                                            for an example</p>
                                    </li>
                                    <li>
                                        <p>Use the <code>@ValidateOnExecution</code> annotation on the executable or type level</p>
                                    </li>
                                </ul>
                            </div>
                            <div class="paragraph">
                                <p>If several sources of configuration are specified for a given executable, <code>@ValidateOnExecution</code> on the executable level takes precedence over <code>@ValidateOnExecution</code> on the type level and
                                    <code>@ValidateOnExecution</code> generally takes precedence over the globally configured types in <em>META-
INF/validation.xml</em>.</p>
                            </div>
                            <div class="paragraph">
                                <p><a href="#example-using-validateonexecution">Example 132, &#8220;Using <code>@ValidateOnExecution</code>&#8221;</a> shows how to use the <code>@ValidateOnExecution</code> annotation:</p>
                            </div>
                            <div id="example-using-validateonexecution" class="exampleblock">
                                <div class="title">Example 132. Using <code>@ValidateOnExecution</code></div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.cdi.methodvalidation.configuration;

@ApplicationScoped
@ValidateOnExecution(type = ExecutableType.ALL)
public class RentalStation {

	@Valid
	public RentalStation() {
		//...
	}

	@NotNull
	@Valid
	@ValidateOnExecution(type = ExecutableType.NONE)
	public Car rentCar(
			@NotNull Customer customer,
			@NotNull @Future Date startDate,
			@Min(1) int durationInDays) {
		//...
		return null;
	}

	@NotNull
	public List&lt;Car&gt; getAvailableCars() {
		//...
		return null;
	}
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="paragraph">
                                <p>Here the method <code>rentCar()</code> won&#8217;t be validated upon invocation because it is annotated with
                                    <code>@ValidateOnExecution(type = ExecutableType.NONE)</code>. In contrast, the constructor and the method <code>getAvailableCars()</code> will be validated due to <code>@ValidateOnExecution(type =
ExecutableType.ALL)</code> being given on the type level. <code>ExecutableType.ALL</code> is a more compact form for explicitly specifying all the types <code>CONSTRUCTORS</code>, <code>GETTER_METHODS</code> and <code>NON_GETTER_METHODS</code>.</p>
                            </div>
                            <div class="admonitionblock tip">
                                <table>
                                    <tr>
                                        <td class="icon">
                                            <div class="title">Tip</div>
                                        </td>
                                        <td class="content">
                                            <div class="paragraph">
                                                <p>Executable validation can be turned off globally by specifying
                                                    <code>&lt;executable-validation enabled="false"/&gt;</code> in <em>META-INF/validation.xml</em>. In this case, all the
                                                    <code>@ValidateOnExecution</code> annotations are ignored.</p>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="paragraph">
                                <p>Note that when a method overrides or implements a super-type method, the configuration will be taken from that overridden or implemented method (as given via <code>@ValidateOnExecution</code> on the method itself or on
                                    the super-type). This protects a client of the super-type method from an unexpected alteration of the configuration, e.g. disabling validation of an overridden executable in a sub-type.</p>
                            </div>
                            <div class="paragraph">
                                <p>In case a CDI managed bean overrides or implements a super-type method and this super-type method hosts any constraints, it can happen that the validation interceptor is not properly registered with the bean, resulting
                                    in the bean&#8217;s methods not being validated upon invocation. In this case you can specify the executable type <code>IMPLICIT</code> on the sub-class as shown in
                                    <a href="#example-using-executabletype-implicit">Example 133, &#8220;Using <code>ExecutableType.IMPLICIT</code>&#8221;</a>, which makes sure that all required metadata is discovered and the validation interceptor kicks
                                    in when the methods on <code>ExpressRentalStation</code> are invoked.</p>
                            </div>
                            <div id="example-using-executabletype-implicit" class="exampleblock">
                                <div class="title">Example 133. Using <code>ExecutableType.IMPLICIT</code></div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.cdi.methodvalidation.implicit;

@ValidateOnExecution(type = ExecutableType.ALL)
public interface RentalStation {

	@NotNull
	@Valid
	Car rentCar(
			@NotNull Customer customer,
			@NotNull @Future Date startDate,
			@Min(1) int durationInDays);

	@NotNull
	List&lt;Car&gt; getAvailableCars();
}</code></pre>
                                        </div>
                                    </div>
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.cdi.methodvalidation.implicit;

@ApplicationScoped
@ValidateOnExecution(type = ExecutableType.IMPLICIT)
public class ExpressRentalStation implements RentalStation {

	@Override
	public Car rentCar(Customer customer, Date startDate, @Min(1) int durationInDays) {
		//...
		return null;
	}

	@Override
	public List&lt;Car&gt; getAvailableCars() {
		//...
		return null;
	}
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_java_ee">
                        <a class="anchor" href="#_java_ee"></a>11.4. Java EE</h3>
                    <div class="paragraph">
                        <p>When your application runs on a Java EE application server such as <a href="http://wildfly.org/">WildFly</a>, you also can obtain <code>Validator</code> and <code>ValidatorFactory</code> instances via <code>@Resource</code> injection
                            in managed objects such as EJBs etc., as shown in <a href="#example-validator-resource-injection">Example 134, &#8220;Retrieving <code>Validator</code> and <code>ValidatorFactory</code> via <code>@Resource</code> injection&#8221;</a>.</p>
                    </div>
                    <div id="example-validator-resource-injection" class="exampleblock">
                        <div class="title">Example 134. Retrieving <code>Validator</code> and <code>ValidatorFactory</code> via <code>@Resource</code> injection</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter11.javaee;

public class RentalStationBean {

	@Resource
	private ValidatorFactory validatorFactory;

	@Resource
	private Validator validator;

	//...
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Alternatively you can obtain a validator and a validator factory from JNDI under the names "
                            <em>java:comp/Validator</em>" and "<em>java:comp/ValidatorFactory</em>", respectively.</p>
                    </div>
                    <div class="paragraph">
                        <p>Similar to CDI-based injection via <code>@Inject</code>, these objects represent default validator and validator factory and thus can be configured using the XML descriptor <em>META-INF/validation.xml</em> (see
                            <a href="#chapter-xml-configuration">Chapter 8, <em>Configuring via XML</em></a>).</p>
                    </div>
                    <div class="paragraph">
                        <p>When your application is CDI-enabled, the injected objects are CDI-aware as well and e.g. support dependency injection in constraint validators.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_javafx">
                        <a class="anchor" href="#_javafx"></a>11.5. JavaFX</h3>
                    <div class="paragraph">
                        <p>Hibernate Validator also provides support for the unwrapping of JavaFX properties. If JavaFX is present on the classpath, <code>ValueExtractor</code>s for JavaFX properties are automatically registered. See <a href="#section-valueextraction-javafx">Section 7.4, &#8220;JavaFX value extractors&#8221;</a>                            for examples and further discussion.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="validator-specifics">
                <a class="anchor" href="#validator-specifics"></a>12. Hibernate Validator Specifics</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>In this chapter you will learn how to make use of several features provided by Hibernate Validator in addition to the functionality defined by the Jakarta Bean Validation specification. This includes the fail fast mode, the API for
                        programmatic constraint configuration and the boolean composition of constraints.
                    </p>
                </div>
                <div class="paragraph">
                    <p>New APIs or SPIs are tagged with the <code>org.hibernate.validator.Incubating</code> annotation as long as they are under development. This means that such elements (e.g. packages, types, methods, constants etc.) may be incompatibly
                        altered - or removed - in subsequent releases. Usage of incubating API/SPI members is encouraged (so the development team can get feedback on these new features) but you should be prepared for updating code which is using them
                        as needed when upgrading to a new version of Hibernate Validator.
                    </p>
                </div>
                <div class="admonitionblock note">
                    <table>
                        <tr>
                            <td class="icon">
                                <div class="title">Note</div>
                            </td>
                            <td class="content">
                                <div class="paragraph">
                                    <p>Using the features described in the following sections may result in application code which is not portable between Jakarta Bean Validation providers.</p>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="sect2">
                    <h3 id="_public_api">
                        <a class="anchor" href="#_public_api"></a>12.1. Public API</h3>
                    <div class="paragraph">
                        <p>Let&#8217;s start, however, with a look at the public API of Hibernate Validator. Below you can find a list of all packages belonging to this API and their purpose. Note that when a package is part of the public API this is not
                            necessarily true for its sub-packages.</p>
                    </div>
                    <div class="dlist">
                        <dl>
                            <dt class="hdlist1"><code>org.hibernate.validator</code></dt>
                            <dd>
                                <p>Classes used by the Jakarta Bean Validation bootstrap mechanism (eg. validation provider, configuration class); for more details see <a href="#chapter-bootstrapping">Chapter 9, <em>Bootstrapping</em></a>.</p>
                            </dd>
                            <dt class="hdlist1"><code>org.hibernate.validator.cfg</code>, <code>org.hibernate.validator.cfg.context</code>, <code>org.hibernate.validator.cfg.defs</code>, <code>org.hibernate.validator.spi.cfg</code></dt>
                            <dd>
                                <p>Hibernate Validator&#8217;s fluent API for constraint declaration; in <code>org.hibernate.validator.cfg</code> you will find the <code>ConstraintMapping</code> interface, in <code>org.hibernate.validator.cfg.defs</code>                                    all constraint definitions and in <code>org.hibernate.validator.spi.cfg</code> a callback for using the API for configuring the default validator factory. Refer to <a href="#section-programmatic-api">Section 12.4, &#8220;Programmatic constraint definition and declaration&#8221;</a>                                    for the details.</p>
                            </dd>
                            <dt class="hdlist1"><code>org.hibernate.validator.constraints</code>, <code>org.hibernate.validator.constraints.br</code>, <code>org.hibernate.validator.constraints.pl</code></dt>
                            <dd>
                                <p>Some useful custom constraints provided by Hibernate Validator in addition to the built-in constraints defined by the Jakarta Bean Validation specification; the constraints are described in detail in <a href="#validator-defineconstraints-hv-constraints">Section 2.3.2, &#8220;附加约束&#8221;</a>.</p>
                            </dd>
                            <dt class="hdlist1"><code>org.hibernate.validator.constraintvalidation</code></dt>
                            <dd>
                                <p>Extended constraint validator context which allows to set custom attributes for message interpolation. <a href="#section-hibernateconstraintvalidatorcontext">Section 12.13.1, &#8220;<code>HibernateConstraintValidatorContext</code>&#8221;</a>                                    describes how to make use of that feature.</p>
                            </dd>
                            <dt class="hdlist1"><code>org.hibernate.validator.group</code>, <code>org.hibernate.validator.spi.group</code></dt>
                            <dd>
                                <p>The group sequence provider feature which allows you to define dynamic default group sequences in function of the validated object state; the specifics can be found in <a href="#section-default-group-class">Section 5.4, &#8220;重新定义默认组序列&#8221;</a>.</p>
                            </dd>
                            <dt class="hdlist1"><code>org.hibernate.validator.messageinterpolation</code>, <code>org.hibernate.validator.resourceloading</code>, <code>org.hibernate.validator.spi.resourceloading</code></dt>
                            <dd>
                                <p>Classes related to constraint message interpolation; the first package contains Hibernate Validator&#8217;s default message interpolator, <code>ResourceBundleMessageInterpolator</code>. The latter two packages provide the
                                    <code>ResourceBundleLocator</code> SPI for the loading of resource bundles (see <a href="#section-resource-bundle-locator">Section 4.2.1, &#8220;<code>ResourceBundleLocator</code>&#8221;</a>) and its default implementation.</p>
                            </dd>
                            <dt class="hdlist1"><code>org.hibernate.validator.parameternameprovider</code></dt>
                            <dd>
                                <p>A <code>ParameterNameProvider</code> based on the Paranamer library, see <a href="#section-paranamer-parameternameprovider">Section 12.14, &#8220;Paranamer based <code>ParameterNameProvider</code>&#8221;</a>.</p>
                            </dd>
                            <dt class="hdlist1"><code>org.hibernate.validator.propertypath</code></dt>
                            <dd>
                                <p>Extensions to the <code>jakarta.validation.Path</code> API, see <a href="#section-extensions-path-api">Section 12.7, &#8220;Extensions of the Path API&#8221;</a>.</p>
                            </dd>
                            <dt class="hdlist1"><code>org.hibernate.validator.spi.constraintdefinition</code></dt>
                            <dd>
                                <p>An SPI for registering additional constraint validators programmatically, see <a href="#section-constraint-definition-contribution">Section 12.15, &#8220;Providing constraint definitions&#8221;</a>.</p>
                            </dd>
                            <dt class="hdlist1"><code>org.hibernate.validator.spi.messageinterpolation</code></dt>
                            <dd>
                                <p>An SPI that can be used to tweak the resolution of the locale when interpolating the constraint violation messages. See <a href="#section-locale-resolver">Section 12.12, &#8220;Customizing the locale resolution&#8221;</a>.</p>
                            </dd>
                            <dt class="hdlist1"><code>org.hibernate.validator.spi.nodenameprovider</code></dt>
                            <dd>
                                <p>An SPI that can be used to alter how the names of properties will be resolved when the property path is constructed. See <a href="#section-property-node-name-provider">Section 12.18, &#8220;Customizing the property name resolution for constraint violations&#8221;</a>.</p>
                            </dd>
                        </dl>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>The public packages of Hibernate Validator fall into two categories: while the actual API parts are intended to be <em>invoked</em> or <em>used</em> by clients (e.g. the API for programmatic constraint declaration
                                            or the custom constraints), the SPI (service provider interface) packages contain interfaces which are intended to be <em>implemented</em> by clients (e.g. <code>ResourceBundleLocator</code>).</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>Any packages not listed in that table are internal packages of Hibernate Validator and are not intended to be accessed by clients. The contents of these internal packages can change from release to release without notice, thus
                            possibly breaking any client code relying on it.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-fail-fast">
                        <a class="anchor" href="#section-fail-fast"></a>12.2. Fail fast mode</h3>
                    <div class="paragraph">
                        <p>Using the fail fast mode, Hibernate Validator allows to return from the current validation as soon as the first constraint violation occurs. This can be useful for the validation of large object graphs where you are only interested
                            in a quick check whether there is any constraint violation at all.
                        </p>
                    </div>
                    <div class="paragraph">
                        <p><a href="#example-using-fail-fast">Example 135, &#8220;Using the fail fast validation mode&#8221;</a> shows how to bootstrap and use a fail fast enabled validator.</p>
                    </div>
                    <div id="example-using-fail-fast" class="exampleblock">
                        <div class="title">Example 135. Using the fail fast validation mode</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter12.failfast;

public class Car {

	@NotNull
	private String manufacturer;

	@AssertTrue
	private boolean isRegistered;

	public Car(String manufacturer, boolean isRegistered) {
		this.manufacturer = manufacturer;
		this.isRegistered = isRegistered;
	}

	//getters and setters...
}</code></pre>
                                </div>
                            </div>
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Validator validator = Validation.byProvider( HibernateValidator.class )
		.configure()
		.failFast( true )
		.buildValidatorFactory()
		.getValidator();

Car car = new Car( null, false );

Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Here the validated object actually fails to satisfy both the constraints declared on the <code>Car</code> class, yet the validation call yields only one <code>ConstraintViolation</code> since the fail fast mode is enabled.</p>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>There is no guarantee in which order the constraints are evaluated, i.e. it is not deterministic whether the returned violation originates from the <code>@NotNull</code> or the <code>@AssertTrue</code> constraint.
                                            If required, a deterministic evaluation order can be enforced using group sequences as described in
                                            <a href="#section-defining-group-sequences">Section 5.3, &#8220;定义分组序列&#8221;</a>.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>Refer to <a href="#section-provider-specific-settings">Section 9.2.8, &#8220;Provider-specific settings&#8221;</a> to learn about the different ways of enabling the fail fast mode when bootstrapping a validator.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-method-validation-prerequisite-relaxation">
                        <a class="anchor" href="#section-method-validation-prerequisite-relaxation"></a>12.3. Relaxation of requirements for method validation in class hierarchies</h3>
                    <div class="paragraph">
                        <p>The Jakarta Bean Validation specification defines a set of preconditions which apply when defining constraints on methods within class hierarchies. These preconditions are defined in {bvSpecUrl}#constraintdeclarationvalidationprocess-methodlevelconstraints-inheritance[section
                            5.6.5] of the Jakarta Bean Validation 2.0 specification. See also <a href="#section-method-constraints-inheritance-hierarchies">Section 3.1.4, &#8220;继承层次中的方法约束&#8221;</a> in this guide.</p>
                    </div>
                    <div class="paragraph">
                        <p>As per specification, a Jakarta Bean Validation provider is allowed to relax these preconditions. With Hibernate Validator you can do this in one of two ways.</p>
                    </div>
                    <div class="paragraph">
                        <p>First you can use the configuration properties <em>hibernate.validator.allow_parameter_constraint_override</em>,
                            <em>hibernate.validator.allow_multiple_cascaded_validation_on_result</em> and
                            <em>hibernate.validator.allow_parallel_method_parameter_constraint</em> in <em>validation.xml</em>. See example
                            <a href="#example-relaxing-method-validation-xml">Example 136, &#8220;Configuring method validation behaviour in class hierarchies via properties&#8221;</a>.</p>
                    </div>
                    <div id="example-relaxing-method-validation-xml" class="exampleblock">
                        <div class="title">Example 136. Configuring method validation behaviour in class hierarchies via properties</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;validation-config
        xmlns="https://jakarta.ee/xml/ns/validation/configuration"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="https://jakarta.ee/xml/ns/validation/configuration https://jakarta.ee/xml/ns/validation/validation-configuration-3.0.xsd"
        version="3.0"&gt;
    &lt;default-provider&gt;org.hibernate.validator.HibernateValidator&lt;/default-provider&gt;

    &lt;property name="hibernate.validator.allow_parameter_constraint_override"&gt;true&lt;/property&gt;
    &lt;property name="hibernate.validator.allow_multiple_cascaded_validation_on_result"&gt;true&lt;/property&gt;
    &lt;property name="hibernate.validator.allow_parallel_method_parameter_constraint"&gt;true&lt;/property&gt;
&lt;/validation-config&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Alternatively these settings can be applied during programmatic bootstrapping.</p>
                    </div>
                    <div id="example-relaxing-method-validation" class="exampleblock">
                        <div class="title">Example 137. Configuring method validation behaviour in class hierarchies</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">HibernateValidatorConfiguration configuration = Validation.byProvider( HibernateValidator.class ).configure();

configuration.allowMultipleCascadedValidationOnReturnValues( true )
		.allowOverridingMethodAlterParameterConstraint( true )
		.allowParallelMethodsDefineParameterConstraints( true );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>By default, all of these properties are false, implementing the default behavior as defined in the Jakarta Bean Validation specification.</p>
                    </div>
                    <div class="admonitionblock warning">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Warning</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>Changing the default behaviour for method validation will result in non specification-conforming and non portable application. Make sure to understand what you are doing and that your use case really requires changes
                                            to the default behaviour.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-programmatic-api">
                        <a class="anchor" href="#section-programmatic-api"></a>12.4. Programmatic constraint definition and declaration</h3>
                    <div class="paragraph">
                        <p>As per the Jakarta Bean Validation specification, you can define and declare constraints using Java annotations and XML based constraint mappings.</p>
                    </div>
                    <div class="paragraph">
                        <p>In addition, Hibernate Validator provides a fluent API which allows for the programmatic configuration of constraints. Use cases include the dynamic addition of constraints at runtime depending on some application state or tests
                            where you need entities with different constraints in different scenarios but don&#8217;t want to implement actual Java classes for each test case.</p>
                    </div>
                    <div class="paragraph">
                        <p>By default, constraints added via the fluent API are additive to constraints configured via the standard configuration capabilities. But it is also possible to ignore annotation and XML configured constraints where required.</p>
                    </div>
                    <div class="paragraph">
                        <p>The API is centered around the <code>ConstraintMapping</code> interface. You obtain a new mapping via
                            <code>HibernateValidatorConfiguration#createConstraintMapping()</code> which you then can configure in a fluent manner as shown in <a href="#example-constraint-mapping">Example 138, &#8220;Programmatic constraint declaration&#8221;</a>.</p>
                    </div>
                    <div id="example-constraint-mapping" class="exampleblock">
                        <div class="title">Example 138. Programmatic constraint declaration</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">HibernateValidatorConfiguration configuration = Validation
		.byProvider( HibernateValidator.class )
		.configure();

ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
	.type( Car.class )
		.field( "manufacturer" )
			.constraint( new NotNullDef() )
		.field( "licensePlate" )
			.ignoreAnnotations( true )
			.constraint( new NotNullDef() )
			.constraint( new SizeDef().min( 2 ).max( 14 ) )
	.type( RentalCar.class )
		.getter( "rentalStation" )
			.constraint( new NotNullDef() );

Validator validator = configuration.addMapping( constraintMapping )
		.buildValidatorFactory()
		.getValidator();</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Constraints can be configured on multiple classes and properties using method chaining. The constraint definition classes <code>NotNullDef</code> and <code>SizeDef</code> are helper classes which allow to configure constraint parameters
                            in a type-safe fashion. Definition classes exist for all built-in constraints in the <code>org.hibernate.validator.cfg.defs</code> package. By calling <code>ignoreAnnotations()</code> any constraints configured via annotations
                            or XML are ignored for the given element.</p>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>Each element (type, property, method etc.) may only be configured once within all the constraint mappings used to set up one validator factory. Otherwise a <code>ValidationException</code> is raised.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>It is not supported to add constraints to non-overridden supertype properties and methods by configuring a subtype. Instead you need to configure the supertype in this case.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>Having configured the mapping, you must add it back to the configuration object from which you then can obtain a validator factory.</p>
                    </div>
                    <div class="paragraph">
                        <p>For custom constraints, you can either create your own definition classes extending <code>ConstraintDef</code> or you can use <code>GenericConstraintDef</code> as seen in <a href="#example-generic-constraint-mapping">Example 139, &#8220;Programmatic declaration of a custom constraint&#8221;</a>.</p>
                    </div>
                    <div id="example-generic-constraint-mapping" class="exampleblock">
                        <div class="title">Example 139. Programmatic declaration of a custom constraint</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
	.type( Car.class )
		.field( "licensePlate" )
			.constraint( new GenericConstraintDef&lt;&gt;( CheckCase.class )
				.param( "value", CaseMode.UPPER )
			);</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Container element constraints are supported by the programmatic API, using <code>containerElementType()</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p><a href="#example-nested-container-element-constraints">Example 140, &#8220;Programmatic declaration of a nested container element constraint&#8221;</a> show an example where constraints are declared on nested container elements.</p>
                    </div>
                    <div id="example-nested-container-element-constraints" class="exampleblock">
                        <div class="title">Example 140. Programmatic declaration of a nested container element constraint</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
	.type( Car.class )
		.field( "manufacturer" )
			.constraint( new NotNullDef() )
		.field( "licensePlate" )
			.ignoreAnnotations( true )
			.constraint( new NotNullDef() )
			.constraint( new SizeDef().min( 2 ).max( 14 ) )
		.field( "partManufacturers" )
			.containerElementType( 0 )
				.constraint( new NotNullDef() )
			.containerElementType( 1, 0 )
				.constraint( new NotNullDef() )
	.type( RentalCar.class )
		.getter( "rentalStation" )
			.constraint( new NotNullDef() );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>As demonstrated, the parameters passed to <code>containerElementType()</code> are the path of type argument indexes used to obtain the desired nested container element type.</p>
                    </div>
                    <div class="paragraph">
                        <p>By invoking <code>valid()</code> you can mark a member for cascaded validation which is equivalent to annotating it with <code>@Valid</code>. Configure any group conversions to be applied during cascaded validation using the
                            <code>convertGroup()</code> method (equivalent to <code>@ConvertGroup</code>). An example can be seen in
                            <a href="#example-cascading-constraints">Example 141, &#8220;Marking a property for cascaded validation&#8221;</a>.</p>
                    </div>
                    <div id="example-cascading-constraints" class="exampleblock">
                        <div class="title">Example 141. Marking a property for cascaded validation</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
	.type( Car.class )
		.field( "driver" )
			.constraint( new NotNullDef() )
			.valid()
			.convertGroup( Default.class ).to( PersonDefault.class )
		.field( "partManufacturers" )
			.containerElementType( 0 )
				.valid()
			.containerElementType( 1, 0 )
				.valid()
	.type( Person.class )
		.field( "name" )
			.constraint( new NotNullDef().groups( PersonDefault.class ) );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You can not only configure bean constraints using the fluent API but also method and constructor constraints. As shown in <a href="#example-method-constraint-mapping">Example 142, &#8220;Programmatic declaration of method and constructor constraints&#8221;</a>                            constructors are identified by their parameter types and methods by their name and parameter types. Having selected a method or constructor, you can mark its parameters and/or return value for cascaded validation and add constraints
                            as well as cross-parameter constraints.</p>
                    </div>
                    <div class="paragraph">
                        <p>As shown in the example, <code>valid()</code> can be also invoked on a container element type.</p>
                    </div>
                    <div id="example-method-constraint-mapping" class="exampleblock">
                        <div class="title">Example 142. Programmatic declaration of method and constructor constraints</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
	.type( Car.class )
		.constructor( String.class )
			.parameter( 0 )
				.constraint( new SizeDef().min( 3 ).max( 50 ) )
			.returnValue()
				.valid()
		.method( "drive", int.class )
			.parameter( 0 )
				.constraint( new MaxDef().value( 75 ) )
		.method( "load", List.class, List.class )
			.crossParameter()
				.constraint( new GenericConstraintDef&lt;&gt;(
						LuggageCountMatchesPassengerCount.class ).param(
							"piecesOfLuggagePerPassenger", 2
						)
				)
		.method( "getDriver" )
			.returnValue()
				.constraint( new NotNullDef() )
				.valid();</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Last but not least you can configure the default group sequence or the default group sequence provider of a type as shown in the following example.</p>
                    </div>
                    <div id="example-sequences" class="exampleblock">
                        <div class="title">Example 143. Configuration of default group sequence and default group sequence provider</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
	.type( Car.class )
		.defaultGroupSequence( Car.class, CarChecks.class )
	.type( RentalCar.class )
		.defaultGroupSequenceProviderClass( RentalCarGroupSequenceProvider.class );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-programmatic-api-contributor">
                        <a class="anchor" href="#section-programmatic-api-contributor"></a>12.5. Applying programmatic constraint declarations to the default validator factory</h3>
                    <div class="paragraph">
                        <p>If you are not bootstrapping a validator factory manually but work with the default factory as configured via <em>META-INF/validation.xml</em> (see <a href="#chapter-xml-configuration">Chapter 8, <em>Configuring via XML</em></a>),
                            you can add one or more constraint mappings by creating one or several constraint mapping contributors. To do so, implement the <code>ConstraintMappingContributor</code> contract:</p>
                    </div>
                    <div id="example-constraint-mapping-contributor" class="exampleblock">
                        <div class="title">Example 144. Custom <code>ConstraintMappingContributor</code> implementation</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter12.constraintapi;

public class MyConstraintMappingContributor implements ConstraintMappingContributor {

	@Override
	public void createConstraintMappings(ConstraintMappingBuilder builder) {
		builder.addConstraintMapping()
			.type( Marathon.class )
				.getter( "name" )
					.constraint( new NotNullDef() )
				.field( "numberOfHelpers" )
					.constraint( new MinDef().value( 1 ) );

		builder.addConstraintMapping()
			.type( Runner.class )
				.field( "paidEntryFee" )
					.constraint( new AssertTrueDef() );
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>You then need to specify the fully-qualified class name of the contributor implementation in <em>META-INF/validation.xml</em>, using the property key <code>hibernate.validator.constraint_mapping_contributors</code>. You can specify
                            several contributors by separating them with a comma.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-advanced-constraint-composition">
                        <a class="anchor" href="#section-advanced-constraint-composition"></a>12.6. Advanced constraint composition features</h3>
                    <div class="sect3">
                        <h4 id="_validation_target_specification_for_purely_composed_constraints">
                            <a class="anchor" href="#_validation_target_specification_for_purely_composed_constraints"></a>12.6.1. Validation target specification for purely composed constraints</h4>
                        <div class="paragraph">
                            <p>In case you specify a purely composed constraint - i.e. a constraint which has no validator itself but is solely made up from other, composing constraints - on a method declaration, the validation engine cannot determine whether
                                that constraint is to be applied as a return value constraint or as a cross-parameter constraint.</p>
                        </div>
                        <div class="paragraph">
                            <p>Hibernate Validator allows to resolve such ambiguities by specifying the <code>@SupportedValidationTarget</code> annotation on the declaration of the composed constraint type as shown in <a href="#example-purely-composed-constraint-validation-target">Example 145, &#8220;Specifying the validation target of a purely composed constraint&#8221;</a>.
                                The <code>@ValidInvoiceAmount</code> does not declare any validator, but it is solely composed by the <code>@Min</code> and <code>@NotNull</code> constraints. The <code>@SupportedValidationTarget</code> ensures that the
                                constraint is applied to the method return value when given on a method declaration.</p>
                        </div>
                        <div id="example-purely-composed-constraint-validation-target" class="exampleblock">
                            <div class="title">Example 145. Specifying the validation target of a purely composed constraint</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter12.purelycomposed;

@Min(value = 0)
@NotNull
@Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER })
@Retention(RUNTIME)
@Documented
@Constraint(validatedBy = {})
@SupportedValidationTarget(ValidationTarget.ANNOTATED_ELEMENT)
@ReportAsSingleViolation
public @interface ValidInvoiceAmount {

	String message() default "{org.hibernate.validator.referenceguide.chapter11.purelycomposed."
			+ "ValidInvoiceAmount.message}";

	Class&lt;?&gt;[] groups() default {};

	Class&lt;? extends Payload&gt;[] payload() default {};

	@OverridesAttribute(constraint = Min.class, name = "value")
	long value();
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-boolean-constraint-composition">
                            <a class="anchor" href="#section-boolean-constraint-composition"></a>12.6.2. Boolean composition of constraints</h4>
                        <div class="paragraph">
                            <p>Jakarta Bean Validation specifies that the constraints of a composed constraint (see
                                <a href="#section-constraint-composition">Section 6.4, &#8220;Constraint composition&#8221;</a>) are all combined via a logical <em>AND</em>. This means all of the composing constraints need to return true to obtain an
                                overall successful validation.</p>
                        </div>
                        <div class="paragraph">
                            <p>Hibernate Validator offers an extension to this and allows you to compose constraints via a logical
                                <em>OR</em> or <em>NOT</em>. To do so, you have to use the ConstraintComposition annotation and the enum CompositionType with its values <em>AND</em>, <em>OR</em> and <em>ALL_FALSE</em>.</p>
                        </div>
                        <div class="paragraph">
                            <p><a href="#example-boolean-constraint-composition">Example 146, &#8220;OR composition of constraints&#8221;</a> shows how to build a composed constraint <code>@PatternOrSize</code> where only one of the composing constraints
                                needs to be valid in order to pass the validation. Either the validated string is all lower-cased or it is between two and three characters long.</p>
                        </div>
                        <div id="example-boolean-constraint-composition" class="exampleblock">
                            <div class="title">Example 146. OR composition of constraints</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter12.booleancomposition;

@ConstraintComposition(OR)
@Pattern(regexp = "[a-z]")
@Size(min = 2, max = 3)
@ReportAsSingleViolation
@Target({ METHOD, FIELD })
@Retention(RUNTIME)
@Constraint(validatedBy = { })
public @interface PatternOrSize {
	String message() default "{org.hibernate.validator.referenceguide.chapter11." +
			"booleancomposition.PatternOrSize.message}";

	Class&lt;?&gt;[] groups() default { };

	Class&lt;? extends Payload&gt;[] payload() default { };
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="admonitionblock tip">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Tip</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>Using <em>ALL_FALSE</em> as composition type implicitly enforces that only a single violation will get reported in case validation of the constraint composition fails.</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-extensions-path-api">
                        <a class="anchor" href="#section-extensions-path-api"></a>12.7. Extensions of the Path API</h3>
                    <div class="paragraph">
                        <p>Hibernate Validator provides an extension to the <code>jakarta.validation.Path</code> API. For nodes of <code>ElementKind.PROPERTY</code> and <code>ElementKind.CONTAINER_ELEMENT</code> it allows to obtain the value of the represented
                            property. To do so, narrow down a given node to the type <code>org.hibernate.validator.path.PropertyNode</code> or
                            <code>org.hibernate.validator.path.ContainerElementNode</code> respectively using <code>Node#as()</code>, as shown in the following example:</p>
                    </div>
                    <div id="example-property-node-get-value" class="exampleblock">
                        <div class="title">Example 147. Getting the value from property nodes</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Building building = new Building();

// Assume the name of the person violates a @Size constraint
Person bob = new Person( "Bob" );
Apartment bobsApartment = new Apartment( bob );
building.getApartments().add( bobsApartment );

Set&lt;ConstraintViolation&lt;Building&gt;&gt; constraintViolations = validator.validate( building );

Path path = constraintViolations.iterator().next().getPropertyPath();
Iterator&lt;Path.Node&gt; nodeIterator = path.iterator();

Path.Node node = nodeIterator.next();
assertEquals( node.getName(), "apartments" );
assertSame( node.as( PropertyNode.class ).getValue(), bobsApartment );

node = nodeIterator.next();
assertEquals( node.getName(), "resident" );
assertSame( node.as( PropertyNode.class ).getValue(), bob );

node = nodeIterator.next();
assertEquals( node.getName(), "name" );
assertEquals( node.as( PropertyNode.class ).getValue(), "Bob" );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This is also very useful to obtain the element of <code>Set</code> properties on the property path (e.g. <code>apartments</code> in the example) which otherwise could not be identified (unlike for <code>Map</code> and <code>List</code>,
                            there is no key nor index in this case).</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-dynamic-payload">
                        <a class="anchor" href="#section-dynamic-payload"></a>12.8. Dynamic payload as part of <code>ConstraintViolation</code></h3>
                    <div class="paragraph">
                        <p>In some cases automatic processing of violations can be aided, if the constraint violation provides additional data - a so called dynamic payload. This dynamic payload could for example contain hints to the user on how to resolve
                            the violation.</p>
                    </div>
                    <div class="paragraph">
                        <p>Dynamic payloads can be set in <a href="#validator-customconstraints">custom constraints</a> using <code>HibernateConstraintValidatorContext</code>. This is shown in example <a href="#example-constraint-validator-setting-dynamic-payload">Example 148, &#8220;<code>ConstraintValidator</code> implementation setting a dynamic payload&#8221;</a>                            where the
                            <code>jakarta.validation.ConstraintValidatorContext</code> is unwrapped to <code>HibernateConstraintValidatorContext</code> in order to call
                            <code>withDynamicPayload</code>.</p>
                    </div>
                    <div id="example-constraint-validator-setting-dynamic-payload" class="exampleblock">
                        <div class="title">Example 148. <code>ConstraintValidator</code> implementation setting a dynamic payload</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter12.dynamicpayload;

import static org.hibernate.validator.internal.util.CollectionHelper.newHashMap;

public class ValidPassengerCountValidator implements ConstraintValidator&lt;ValidPassengerCount, Car&gt; {

	private static final Map&lt;Integer, String&gt; suggestedCars = newHashMap();

	static {
		suggestedCars.put( 2, "Chevrolet Corvette" );
		suggestedCars.put( 3, "Toyota Volta" );
		suggestedCars.put( 4, "Maserati GranCabrio" );
		suggestedCars.put( 5, " Mercedes-Benz E-Class" );
	}

	@Override
	public void initialize(ValidPassengerCount constraintAnnotation) {
	}

	@Override
	public boolean isValid(Car car, ConstraintValidatorContext context) {
		if ( car == null ) {
			return true;
		}

		int passengerCount = car.getPassengers().size();
		if ( car.getSeatCount() &gt;= passengerCount ) {
			return true;
		}
		else {

			if ( suggestedCars.containsKey( passengerCount ) ) {
				HibernateConstraintValidatorContext hibernateContext = context.unwrap(
						HibernateConstraintValidatorContext.class
				);
				hibernateContext.withDynamicPayload( suggestedCars.get( passengerCount ) );
			}
			return false;
		}
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>On the constraint violation processing side, a <code>jakarta.validation.ConstraintViolation</code> can then in turn be unwrapped to <code>HibernateConstraintViolation</code> in order to retrieve the dynamic payload for further
                            processing.</p>
                    </div>
                    <div id="example-retrieving-dynamic-payload" class="exampleblock">
                        <div class="title">Example 149. Retrieval of a <code>ConstraintViolation</code>'s dynamic payload</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Car car = new Car( 2 );
car.addPassenger( new Person() );
car.addPassenger( new Person() );
car.addPassenger( new Person() );
Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );

assertEquals( 1, constraintViolations.size() );

ConstraintViolation&lt;Car&gt; constraintViolation = constraintViolations.iterator().next();
@SuppressWarnings("unchecked")
HibernateConstraintViolation&lt;Car&gt; hibernateConstraintViolation = constraintViolation.unwrap(
		HibernateConstraintViolation.class
);
String suggestedCar = hibernateConstraintViolation.getDynamicPayload( String.class );
assertEquals( "Toyota Volta", suggestedCar );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="el-features">
                        <a class="anchor" href="#el-features"></a>12.9. Enabling Expression Language features</h3>
                    <div class="paragraph">
                        <p>Hibernate Validator restricts the Expression Language features exposed by default.</p>
                    </div>
                    <div class="paragraph">
                        <p>For this purpose, we define several feature levels in <code>ExpressionLanguageFeatureLevel</code>:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p><code>NONE</code>: Expression Language interpolation is fully disabled.</p>
                            </li>
                            <li>
                                <p><code>VARIABLES</code>: Allow interpolation of the variables injected via <code>addExpressionVariable()</code>, resources bundles and usage of the <code>formatter</code> object.</p>
                            </li>
                            <li>
                                <p><code>BEAN_PROPERTIES</code>: Allow everything <code>VARIABLES</code> allows plus the interpolation of bean properties.</p>
                            </li>
                            <li>
                                <p><code>BEAN_METHODS</code>: Also allow execution of bean methods. This can lead to serious security issues, including arbitrary code execution if not carefully handled.</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>Depending on the context, the features we expose are different:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>For constraints, the default level is <code>BEAN_PROPERTIES</code>. For all the built-in constraint messages to be correctly interpolated, you need at least the <code>VARIABLES</code> level.</p>
                            </li>
                            <li>
                                <p>For custom violations, created via the <code>ConstraintValidatorContext</code>, Expression Language is disabled by default. You can enable it for specific custom violations and, when enabled, it will default to <code>VARIABLES</code>.</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>Hibernate Validator provides ways to override these defaults when boostrapping the <code>ValidatorFactory</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p>To change the Expression Language feature level for constraints, use the following:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
		.configure()
		.constraintExpressionLanguageFeatureLevel( ExpressionLanguageFeatureLevel.VARIABLES )
		.buildValidatorFactory();</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>To change the Expression Language feature level for custom violations, use the following:</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
                            <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
		.configure()
		.customViolationExpressionLanguageFeatureLevel( ExpressionLanguageFeatureLevel.VARIABLES )
		.buildValidatorFactory();</code></pre>
                        </div>
                    </div>
                    <div class="admonitionblock caution">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Caution</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>Doing this will automatically enable Expression Language for all the custom violations in your application.</p>
                                    </div>
                                    <div class="paragraph">
                                        <p>It should only be used for compatibility and to ease the migration from older Hibernate Validator versions.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>These levels can also be defined using the following properties:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p><code>hibernate.validator.constraint_expression_language_feature_level</code></p>
                            </li>
                            <li>
                                <p><code>hibernate.validator.custom_violation_expression_language_feature_level</code></p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>Accepted values for these properties are: <code>none</code>, <code>variables</code>, <code>bean-properties</code> and <code>bean-methods</code>.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="non-el-message-interpolator">
                        <a class="anchor" href="#non-el-message-interpolator"></a>12.10. <code>ParameterMessageInterpolator</code></h3>
                    <div class="paragraph">
                        <p>Hibernate Validator requires per default an implementation of the Unified EL (see
                            <a href="#validator-gettingstarted-uel">Section 1.1.1, &#8220;统一的EL表达式&#8221;</a>) to be available. This is needed to allow the interpolation of constraint error messages using EL expressions as defined by the Jakarta Bean
                            Validation specification.</p>
                    </div>
                    <div class="paragraph">
                        <p>For environments where you cannot or do not want to provide an EL implementation, Hibernate Validator offers a non EL based message interpolator - <code>org.hibernate.validator.messageinterpolation.ParameterMessageInterpolator</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p>Refer to <a href="#section-custom-message-interpolation">Section 4.2, &#8220;自定义消息插值&#8221;</a> to see how to plug in custom message interpolator implementations.
                        </p>
                    </div>
                    <div class="admonitionblock warning">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Warning</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>Constraint messages containing EL expressions will be returned un-interpolated by
                                            <code>org.hibernate.validator.messageinterpolation.ParameterMessageInterpolator</code>. This also affects built-in default constraint messages which use EL expressions. At the moment, <code>DecimalMin</code>                                            and <code>DecimalMax</code> are affected.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_resourcebundlelocator">
                        <a class="anchor" href="#_resourcebundlelocator"></a>12.11. <code>ResourceBundleLocator</code></h3>
                    <div class="paragraph">
                        <p>With <code>ResourceBundleLocator</code>, Hibernate Validator provides an additional SPI which allows to retrieve error messages from other resource bundles than <em>ValidationMessages</em> while still using the actual interpolation
                            algorithm as defined by the specification. Refer to
                            <a href="#section-resource-bundle-locator">Section 4.2.1, &#8220;<code>ResourceBundleLocator</code>&#8221;</a> to learn how to make use of that SPI.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-locale-resolver">
                        <a class="anchor" href="#section-locale-resolver"></a>12.12. Customizing the locale resolution</h3>
                    <div class="admonitionblock warning">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Warning</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>These contracts are marked as <code>@Incubating</code> so they might be subject to change in the future.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>Hibernate Validator provides several extension points to build a custom locale resolution strategy. The resolved locale is used when interpolating the constraint violation messages.</p>
                    </div>
                    <div class="paragraph">
                        <p>The default behavior of Hibernate Validator is to always use the system default locale (as obtained via <code>Locale.getDefault()</code>). This might not be the desired behavior if, for example, you usually set your system locale
                            to <code>en-US</code> but want your application to provide messages in French.</p>
                    </div>
                    <div class="paragraph">
                        <p>The following example shows how to set the Hibernate Validator default locale to <code>fr-FR</code>:</p>
                    </div>
                    <div id="example-configure-default-locale" class="exampleblock">
                        <div class="title">Example 150. Configure the default locale</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Validator validator = Validation.byProvider( HibernateValidator.class )
		.configure()
		.defaultLocale( Locale.FRANCE )
		.buildValidatorFactory()
		.getValidator();

Set&lt;ConstraintViolation&lt;Bean&gt;&gt; violations = validator.validate( new Bean() );
assertEquals( "doit avoir la valeur vrai", violations.iterator().next().getMessage() );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>While this is already a nice improvement, in a fully internationalized application, this is not sufficient: you need Hibernate Validator to select the locale depending on the user context.</p>
                    </div>
                    <div class="paragraph">
                        <p>Hibernate Validator provides the <code>org.hibernate.validator.spi.messageinterpolation.LocaleResolver</code> SPI which allows to fine-tune the resolution of the locale. Typically, in a JAX-RS environment, you can resolve the locale
                            to use from the <code>Accept-Language</code> HTTP header.</p>
                    </div>
                    <div class="paragraph">
                        <p>In the following example, we use a hardcoded value but, for instance, in the case of a RESTEasy application, you could extract the header from the <code>ResteasyContext</code>.</p>
                    </div>
                    <div id="example-locale-resolver" class="exampleblock">
                        <div class="title">Example 151. Fine tune the locale used to interpolate the messages via a <code>LocaleResolver</code></div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">LocaleResolver localeResolver = new LocaleResolver() {

	@Override
	public Locale resolve(LocaleResolverContext context) {
		// get the locales supported by the client from the Accept-Language header
		String acceptLanguageHeader = "it-IT;q=0.9,en-US;q=0.7";

		List&lt;LanguageRange&gt; acceptedLanguages = LanguageRange.parse( acceptLanguageHeader );
		List&lt;Locale&gt; resolvedLocales = Locale.filter( acceptedLanguages, context.getSupportedLocales() );

		if ( resolvedLocales.size() &gt; 0 ) {
			return resolvedLocales.get( 0 );
		}

		return context.getDefaultLocale();
	}
};

Validator validator = Validation.byProvider( HibernateValidator.class )
		.configure()
		.defaultLocale( Locale.FRANCE )
		.locales( Locale.FRANCE, Locale.ITALY, Locale.US )
		.localeResolver( localeResolver )
		.buildValidatorFactory()
		.getValidator();

Set&lt;ConstraintViolation&lt;Bean&gt;&gt; violations = validator.validate( new Bean() );
assertEquals( "deve essere true", violations.iterator().next().getMessage() );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>When using the <code>LocaleResolver</code>, you have to define the list of supported locales via the <code>locales()</code> method.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="_custom_contexts">
                        <a class="anchor" href="#_custom_contexts"></a>12.13. Custom contexts</h3>
                    <div class="paragraph">
                        <p>The Jakarta Bean Validation specification offers at several points in its API the possibility to unwrap a given interface to an implementor specific subtype. In the case of constraint violation creation in
                            <code>ConstraintValidator</code> implementations as well as message interpolation in <code>MessageInterpolator</code> instances, there exist <code>unwrap()</code> methods for the provided context instances -
                            <code>ConstraintValidatorContext</code> respectively <code>MessageInterpolatorContext</code>. Hibernate Validator provides custom extensions for both of these interfaces.</p>
                    </div>
                    <div class="sect3">
                        <h4 id="section-hibernateconstraintvalidatorcontext">
                            <a class="anchor" href="#section-hibernateconstraintvalidatorcontext"></a>12.13.1. <code>HibernateConstraintValidatorContext</code></h4>
                        <div id="section-custom-constraint-validator-context" class="paragraph">
                            <p><code>HibernateConstraintValidatorContext</code> is a subtype of <code>ConstraintValidatorContext</code> which allows you to:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p>enable Expression Language interpolation for a particular custom violation - see below</p>
                                </li>
                                <li>
                                    <p>set arbitrary parameters for interpolation via the Expression Language message interpolation facility using <code>HibernateConstraintValidatorContext#addExpressionVariable(String, Object)</code> or <code>HibernateConstraintValidatorContext#addMessageParameter(String, Object)</code>.</p>
                                    <div id="example-custom-expression-variable" class="exampleblock">
                                        <div class="title">Example 152. Custom <code>@Future</code> validator injecting an expression variable</div>
                                        <div class="content">
                                            <div class="listingblock">
                                                <div class="content">
                                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter12.context;

import java.time.Instant;

import jakarta.validation.ConstraintValidator;
import jakarta.validation.ConstraintValidatorContext;
import jakarta.validation.constraints.Future;

import org.hibernate.validator.constraintvalidation.HibernateConstraintValidatorContext;

public class MyFutureValidator implements ConstraintValidator&lt;Future, Instant&gt; {

	@Override
	public void initialize(Future constraintAnnotation) {
	}

	@Override
	public boolean isValid(Instant value, ConstraintValidatorContext context) {
		if ( value == null ) {
			return true;
		}

		HibernateConstraintValidatorContext hibernateContext = context.unwrap(
				HibernateConstraintValidatorContext.class
		);

		Instant now = Instant.now( context.getClockProvider().getClock() );

		if ( !value.isAfter( now ) ) {
			hibernateContext.disableDefaultConstraintViolation();
			hibernateContext
					.addExpressionVariable( "now", now )
					.buildConstraintViolationWithTemplate( "Must be after ${now}" )
					.addConstraintViolation();

			return false;
		}

		return true;
	}
}</code></pre>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="example-custom-message-parameter" class="exampleblock">
                                        <div class="title">Example 153. Custom <code>@Future</code> validator injecting a message parameter</div>
                                        <div class="content">
                                            <div class="listingblock">
                                                <div class="content">
                                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter12.context;

import java.time.Instant;

import jakarta.validation.ConstraintValidator;
import jakarta.validation.ConstraintValidatorContext;
import jakarta.validation.constraints.Future;

import org.hibernate.validator.constraintvalidation.HibernateConstraintValidatorContext;

public class MyFutureValidatorMessageParameter implements ConstraintValidator&lt;Future, Instant&gt; {

	@Override
	public void initialize(Future constraintAnnotation) {
	}

	@Override
	public boolean isValid(Instant value, ConstraintValidatorContext context) {
		if ( value == null ) {
			return true;
		}

		HibernateConstraintValidatorContext hibernateContext = context.unwrap(
				HibernateConstraintValidatorContext.class
		);

		Instant now = Instant.now( context.getClockProvider().getClock() );

		if ( !value.isAfter( now ) ) {
			hibernateContext.disableDefaultConstraintViolation();
			hibernateContext
					.addMessageParameter( "now", now )
					.buildConstraintViolationWithTemplate( "Must be after {now}" )
					.addConstraintViolation();

			return false;
		}

		return true;
	}
}</code></pre>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="admonitionblock note">
                                        <table>
                                            <tr>
                                                <td class="icon">
                                                    <div class="title">Note</div>
                                                </td>
                                                <td class="content">
                                                    <div class="paragraph">
                                                        <p>Apart from the syntax, the main difference between message parameters and expression variables is that message parameters are simply interpolated whereas expression variables are interpreted using
                                                            the Expression Language engine. In practice, use message parameters if you do not need the advanced features of an Expression Language.</p>
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="admonitionblock note">
                                        <table>
                                            <tr>
                                                <td class="icon">
                                                    <div class="title">Note</div>
                                                </td>
                                                <td class="content">
                                                    <div class="paragraph">
                                                        <p>Note that the parameters specified via <code>addExpressionVariable(String, Object)</code> and
                                                            <code>addMessageParameter(String, Object)</code> are global and apply to all constraint violations created by this <code>isValid()</code> invocation. This includes the default constraint violation,
                                                            but also all violations created by the <code>ConstraintViolationBuilder</code>. You can, however, update the parameters between invocations of
                                                            <code>ConstraintViolationBuilder#addConstraintViolation()</code>.</p>
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </li>
                                <li>
                                    <p>set an arbitrary dynamic payload - see <a href="#section-dynamic-payload">Section 12.8, &#8220;Dynamic payload as part of <code>ConstraintViolation</code>&#8221;</a></p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p>By default, Expression Language interpolation is <strong>disabled</strong> for custom violations, this to avoid arbitrary code execution or sensitive data leak if message templates are built from improperly escaped user input.</p>
                        </div>
                        <div class="paragraph">
                            <p>It is possible to enable Expression Language for a given custom violation by using <code>enableExpressionLanguage()</code> as shown in the example below:</p>
                        </div>
                        <div class="listingblock">
                            <div class="content">
                                <pre class="highlightjs highlight"><code class="language-none hljs">public class SafeValidator implements ConstraintValidator&lt;ZipCode, String&gt; {

	@Override
	public boolean isValid(String value, ConstraintValidatorContext context) {
		if ( value == null ) {
			return true;
		}

		HibernateConstraintValidatorContext hibernateContext = context.unwrap(
				HibernateConstraintValidatorContext.class );
		hibernateContext.disableDefaultConstraintViolation();

		if ( isInvalid( value ) ) {
			hibernateContext
					.addExpressionVariable( "validatedValue", value )
					.buildConstraintViolationWithTemplate( "${validatedValue} is not a valid ZIP code" )
					.enableExpressionLanguage()
					.addConstraintViolation();

			return false;
		}

		return true;
	}

	private boolean isInvalid(String value) {
		// ...
		return false;
	}
}</code></pre>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>In this case, the message template will be interpolated by the Expression Language engine.</p>
                        </div>
                        <div class="paragraph">
                            <p>By default, only variables interpolation is enabled when enabling Expression Language.</p>
                        </div>
                        <div class="paragraph">
                            <p>You can enable more features by using <code>HibernateConstraintViolationBuilder#enableExpressionLanguage(ExpressionLanguageFeatureLevel level)</code>.</p>
                        </div>
                        <div class="paragraph">
                            <p>We define several levels of features for Expression Language interpolation:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p><code>NONE</code>: Expression Language interpolation is fully disabled - this is the default for custom violations.</p>
                                </li>
                                <li>
                                    <p><code>VARIABLES</code>: Allow interpolation of the variables injected via <code>addExpressionVariable()</code>, resources bundles and usage of the <code>formatter</code> object.</p>
                                </li>
                                <li>
                                    <p><code>BEAN_PROPERTIES</code>: Allow everything <code>VARIABLES</code> allows plus the interpolation of bean properties.</p>
                                </li>
                                <li>
                                    <p><code>BEAN_METHODS</code>: Also allow execution of bean methods. This can lead to serious security issues, including arbitrary code execution if not carefully handled.</p>
                                </li>
                            </ul>
                        </div>
                        <div class="admonitionblock caution">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Caution</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>Using <code>addExpressionVariable()</code> is the only safe way to inject a variable into an expression and it&#8217;s especially important if you use the <code>BEAN_PROPERTIES</code> or <code>BEAN_METHODS</code>                                                feature levels.</p>
                                        </div>
                                        <div class="paragraph">
                                            <p>If you inject user input by simply concatenating the user input in the message, you will allow potential arbitrary code execution and sensitive data leak: if the user input contains valid expressions, they will
                                                be executed by the Expression Language engine.</p>
                                        </div>
                                        <div class="paragraph">
                                            <p>Here is an example of something you should <strong>ABSOLUTELY NOT</strong> do:</p>
                                        </div>
                                        <div class="listingblock">
                                            <div class="content">
                                                <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">public class UnsafeValidator implements ConstraintValidator&lt;ZipCode, String&gt; {

	@Override
	public boolean isValid(String value, ConstraintValidatorContext context) {
		if ( value == null ) {
			return true;
		}

		context.disableDefaultConstraintViolation();

		HibernateConstraintValidatorContext hibernateContext = context.unwrap(
				HibernateConstraintValidatorContext.class );
		hibernateContext.disableDefaultConstraintViolation();

		if ( isInvalid( value ) ) {
			hibernateContext
					// THIS IS UNSAFE, DO NOT COPY THIS EXAMPLE
					.buildConstraintViolationWithTemplate( value + " is not a valid ZIP code" )
					.enableExpressionLanguage()
					.addConstraintViolation();

			return false;
		}

		return true;
	}

	private boolean isInvalid(String value) {
		// ...
		return false;
	}
}</code></pre>
                                            </div>
                                        </div>
                                        <div class="paragraph">
                                            <p>In the example above, if <code>value</code>, which might be user input, contains a valid expression, it will be interpolated by the Expression Language engine, potentially leading to unsafe behaviors.</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="_hibernatemessageinterpolatorcontext">
                            <a class="anchor" href="#_hibernatemessageinterpolatorcontext"></a>12.13.2. <code>HibernateMessageInterpolatorContext</code></h4>
                        <div class="paragraph">
                            <p>Hibernate Validator also offers a custom extension of <code>MessageInterpolatorContext</code>, namely
                                <code>HibernateMessageInterpolatorContext</code> (see <a href="#example-custom-message-interpolator-context">Example 154, &#8220;<code>HibernateMessageInterpolatorContext</code>&#8221;</a>). This subtype was introduced
                                to allow a better integration of Hibernate Validator into Glassfish. The root bean type was in this case needed to determine the right class loader for the message resource bundle. If you have any other use cases, let us
                                know.</p>
                        </div>
                        <div id="example-custom-message-interpolator-context" class="exampleblock">
                            <div class="title">Example 154. <code>HibernateMessageInterpolatorContext</code></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Unresolved directive in ch12.asciidoc - include::{engine-sourcedir}/org/hibernate/validator/messageinterpolation/HibernateMessageInterpolatorContext.java[lines=22..58]</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-paranamer-parameternameprovider">
                        <a class="anchor" href="#section-paranamer-parameternameprovider"></a>12.14. Paranamer based <code>ParameterNameProvider</code></h3>
                    <div class="paragraph">
                        <p>Hibernate Validator comes with a <code>ParameterNameProvider</code> implementation which leverages the
                            <a href="http://paranamer.codehaus.org/">Paranamer</a> library.</p>
                    </div>
                    <div class="paragraph">
                        <p>This library provides several ways for obtaining parameter names at runtime, e.g. based on debug symbols created by the Java compiler, constants with the parameter names woven into the bytecode in a post-compile step or annotations
                            such as the <code>@Named</code> annotation from JSR 330.</p>
                    </div>
                    <div class="paragraph">
                        <p>In order to use <code>ParanamerParameterNameProvider</code>, either pass an instance when bootstrapping a validator as shown in <a href="#example-using-custom-parameter-name-provider">Example 107, &#8220;Using a custom <code>ParameterNameProvider</code>&#8221;</a>                            or specify
                            <code>org.hibernate.validator.parameternameprovider.ParanamerParameterNameProvider</code> as value for the
                            <code>&lt;parameter-name-provider&gt;</code> element in the <em>META-INF/validation.xml</em> file.</p>
                    </div>
                    <div class="admonitionblock tip">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Tip</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>When using this parameter name provider, you need to add the Paranamer library to your classpath. It is available in the Maven Central repository with the group id <code>com.thoughtworks.paranamer</code> and the
                                            artifact id <code>paranamer</code>.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="paragraph">
                        <p>By default <code>ParanamerParameterNameProvider</code> retrieves parameter names from constants added to the byte code at build time (via <code>DefaultParanamer</code>) and debug symbols (via <code>BytecodeReadingParanamer</code>).
                            Alternatively you can specify a <code>Paranamer</code> implementation of your choice when creating a
                            <code>ParanamerParameterNameProvider</code> instance.</p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-constraint-definition-contribution">
                        <a class="anchor" href="#section-constraint-definition-contribution"></a>12.15. Providing constraint definitions</h3>
                    <div class="paragraph">
                        <p>Jakarta Bean Validation allows to (re-)define constraint definitions via XML in its constraint mapping files. See <a href="#section-mapping-xml-constraints">Section 8.2, &#8220;Mapping constraints via <code>constraint-mappings</code>&#8221;</a>                            for more information and <a href="#example-constraints-car">Example 96, &#8220;Bean constraints configured via XML&#8221;</a> for an example. While this approach is sufficient for many use cases, it has its shortcomings in
                            others. Imagine for example a constraint library wanting to contribute constraint definitions for custom types. This library could provide a mapping file with their library, but this file still would need to be referenced by
                            the user of the library. Luckily there are better ways.</p>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>The following concepts are considered experimental at this time. Let us know whether you find them useful and whether they meet your needs.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="sect3">
                        <h4 id="_constraint_definitions_via_serviceloader">
                            <a class="anchor" href="#_constraint_definitions_via_serviceloader"></a>12.15.1. Constraint definitions via <code>ServiceLoader</code></h4>
                        <div class="paragraph">
                            <p>Hibernate Validator allows to utilize Java&#8217;s {javaApiDocsUrl}?java/util/ServiceLoader.html[ServiceLoader] mechanism to register additional constraint definitions. All you have to do is to add the file
                                <em>jakarta.validation.ConstraintValidator</em> to <em>META-INF/services</em>. In this service file you list the fully qualified classnames of your constraint validator classes (one per line). Hibernate Validator will automatically
                                infer the constraint types they apply to. See <a href="#example-using-service-file-for-constraint-definitions">Constraint definition via service file</a> for an example.</p>
                        </div>
                        <div id="example-using-service-file-for-constraint-definitions" class="exampleblock">
                            <div class="title">Example 155. <em>META-INF/services/jakarta.validation.ConstraintValidator</em></div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-none hljs"># Assuming a custom constraint annotation @org.mycompany.CheckCase
org.mycompany.CheckCaseValidator</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>To contribute default messages for your custom constraints, place a file <em>ContributorValidationMessages.properties</em> and/or its locale-specific specializations at the root of your JAR. Hibernate Validator will consider
                                the entries from all the bundles with this name found on the classpath in addition to those given in <em>ValidationMessages.properties</em>.</p>
                        </div>
                        <div class="paragraph">
                            <p>This mechanism is also helpful when creating large multi-module applications: instead of putting all the constraint messages into one single bundle, you can have one resource bundle per module containing only those messages
                                of that module.</p>
                        </div>
                        <div class="admonitionblock note">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Note</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>We highly recommend the reading of
                                                <a href="http://in.relation.to/2017/03/02/adding-custom-constraint-definitions-via-the-java-service-loader/">this blog post by Marko Bekhta</a>, guiding you step by step through the process of creating an
                                                independent JAR that contains your custom constraints and declares them via the <code>ServiceLoader</code>.</p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="section-programmatic-constraint-definition">
                            <a class="anchor" href="#section-programmatic-constraint-definition"></a>12.15.2. Adding constraint definitions programmatically</h4>
                        <div class="paragraph">
                            <p>While the service loader approach works in many scenarios, but not in all (think for example OSGi where service files are not visible), there is yet another way of contributing constraint definitions. You can use the programmatic
                                constraint declaration API - see
                                <a href="#example-using-constraint-definition-api">Example 156, &#8220;Adding constraint definitions through the programmatic API&#8221;</a>.</p>
                        </div>
                        <div id="example-using-constraint-definition-api" class="exampleblock">
                            <div class="title">Example 156. Adding constraint definitions through the programmatic API</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
		.constraintDefinition( ValidPassengerCount.class )
		.validatedBy( ValidPassengerCountValidator.class );</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>If your validator implementation is rather simple (i.e. no initialization from the annotation is needed, and <code>ConstraintValidatorContext</code> is not used), you also can use this alternative API to specify the constraint
                                logic using a Lambda expression or method reference:</p>
                        </div>
                        <div id="example-using-constraint-definition-api-lambda" class="exampleblock">
                            <div class="title">Example 157. Adding constraint definition with a Lambda expression</div>
                            <div class="content">
                                <div class="listingblock">
                                    <div class="content">
                                        <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
		.constraintDefinition( ValidPassengerCount.class )
			.validateType( Bus.class )
				.with( b -&gt; b.getSeatCount() &gt;= b.getPassengers().size() );</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="paragraph">
                            <p>Instead of directly adding a constraint mapping to the configuration object, you may use a <code>ConstraintMappingContributor</code> as detailed in <a href="#section-programmatic-api-contributor">Section 12.5, &#8220;Applying programmatic constraint declarations to the default validator factory&#8221;</a>.
                                This can be useful when configuring the default validator factory using <em>META-INF/validation.xml</em> (see
                                <a href="#chapter-xml-configuration">Chapter 8, <em>Configuring via XML</em></a>).</p>
                        </div>
                        <div class="admonitionblock tip">
                            <table>
                                <tr>
                                    <td class="icon">
                                        <div class="title">Tip</div>
                                    </td>
                                    <td class="content">
                                        <div class="paragraph">
                                            <p>One use case for registering constraint definitions through the programmatic API is the ability to specify an alternative constraint validator for the <code>@URL</code> constraint. Historically, Hibernate Validator&#8217;s
                                                default constraint validator for this constraint uses the <code>java.net.URL</code> constructor to validate an URL. However, there is also a purely regular expression based version available which can be
                                                configured using a <code>ConstraintDefinitionContributor</code>:</p>
                                        </div>
                                        <div class="listingblock">
                                            <div class="title">Using the programmatic constraint declaration API to register a regular expression based constraint definition for <code>@URL</code></div>
                                            <div class="content">
                                                <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">ConstraintMapping constraintMapping = configuration.createConstraintMapping();

constraintMapping
		.constraintDefinition( URL.class )
		.includeExistingValidators( false )
		.validatedBy( RegexpURLValidator.class );</code></pre>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-constraint-customizing-class-loading">
                        <a class="anchor" href="#section-constraint-customizing-class-loading"></a>12.16. Customizing class-loading</h3>
                    <div class="paragraph">
                        <p>There are several cases in which Hibernate Validator needs to load resources or classes given by name:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>XML descriptors (<em>META-INF/validation.xml</em> as well as XML constraint mappings)</p>
                            </li>
                            <li>
                                <p>classes specified by name in XML descriptors (e.g. custom message interpolators etc.)</p>
                            </li>
                            <li>
                                <p>the <em>ValidationMessages</em> resource bundle</p>
                            </li>
                            <li>
                                <p>the <code>ExpressionFactory</code> implementation used for expression based message interpolation</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>By default, Hibernate Validator tries to load these resources via the current thread context class loader. If that&#8217;s not successful, Hibernate Validator&#8217;s own class loader will be tried as a fallback.</p>
                    </div>
                    <div class="paragraph">
                        <p>For cases where this strategy is not appropriate (e.g. modularized environments such as OSGi), you may provide a specific class loader for loading these resources when bootstrapping the validator factory:</p>
                    </div>
                    <div id="example-using-external-class-loader" class="exampleblock">
                        <div class="title">Example 158. Providing a class loader for loading external resources and classes</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Validator validator = Validation.byProvider( HibernateValidator.class )
		.configure()
		.externalClassLoader( classLoader )
		.buildValidatorFactory()
		.getValidator();</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>In the case of OSGi, you could e.g. pass the loader of a class from the bundle bootstrapping Hibernate Validator or a custom class loader implementation which delegates to <code>Bundle#loadClass()</code> etc.</p>
                    </div>
                    <div class="admonitionblock note">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Note</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>Call <code>ValidatorFactory#close()</code> if a given validator factory instance is not needed any longer. Failure to do so may result in a class loader leak in cases where applications/bundles are re-deployed and
                                            a non-closed validator factory still is referenced by application code.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-getter-property-selection-strategy">
                        <a class="anchor" href="#section-getter-property-selection-strategy"></a>12.17. Customizing the getter property selection strategy</h3>
                    <div class="paragraph">
                        <p>When a bean is validated by Hibernate Validator, its properties get validated. A property can either be a field or a getter. By default, Hibernate Validator respects the JavaBeans specification and considers a method as a getter
                            as soon as one of the conditions below is true:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>the method name starts with <code>get</code>, it has a non-void return type and has no parameters;</p>
                            </li>
                            <li>
                                <p>the method name starts with <code>is</code>, has a return type of <code>boolean</code> and has no parameters;</p>
                            </li>
                            <li>
                                <p>the method name starts with <code>has</code>, has a return type of <code>boolean</code> and has no parameters (this rule is specific to Hibernate Validator and is not mandated by the JavaBeans specification)</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>While these rules are usually appropriate when following the classic JavaBeans convention, it might happen, especially with code generators, that the JavaBeans naming convention is not followed and that the getters' names are following
                            a different convention.</p>
                    </div>
                    <div class="paragraph">
                        <p>In this case, the strategy for detecting getters should be redefined in order to fully validate the object.</p>
                    </div>
                    <div class="paragraph">
                        <p>A classic example of this requirement is when the classes follow a fluent naming convention, as illustrated in <a href="#example-using-fluent-api-pattern">Example 159, &#8220;A class that uses non-standard getters&#8221;</a>.</p>
                    </div>
                    <div id="example-using-fluent-api-pattern" class="exampleblock">
                        <div class="title">Example 159. A class that uses non-standard getters</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter12.getterselectionstrategy;

public class User {

	private String firstName;
	private String lastName;
	private String email;

	// [...]

	@NotEmpty
	public String firstName() {
		return firstName;
	}

	@NotEmpty
	public String lastName() {
		return lastName;
	}

	@Email
	public String email() {
		return email;
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>If such object gets validated, no validation will be performed on the getters as they are not detected by the standard strategy.</p>
                    </div>
                    <div class="exampleblock">
                        <div class="title">Example 160. Validating a class with non-standard getters using the default getter property selection strategy</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Validator validator = Validation.byProvider( HibernateValidator.class )
		.configure()
		.buildValidatorFactory()
		.getValidator();

User user = new User( "", "", "not an email" );

Set&lt;ConstraintViolation&lt;User&gt;&gt; constraintViolations = validator.validate( user );

// as User has non-standard getters no violations are triggered
assertEquals( 0, constraintViolations.size() );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>To make Hibernate Validator treat such methods as properties, a custom <code>GetterPropertySelectionStrategy</code> should be configured. In this particular case, a possible implementation of the strategy would be:</p>
                    </div>
                    <div class="exampleblock">
                        <div class="title">Example 161. Custom <code>GetterPropertySelectionStrategy</code> implementation</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">package org.hibernate.validator.referenceguide.chapter12.getterselectionstrategy;

public class FluentGetterPropertySelectionStrategy implements GetterPropertySelectionStrategy {

	private final Set&lt;String&gt; methodNamesToIgnore;

	public FluentGetterPropertySelectionStrategy() {
		// we will ignore all the method names coming from Object
		this.methodNamesToIgnore = Arrays.stream( Object.class.getDeclaredMethods() )
				.map( Method::getName )
				.collect( Collectors.toSet() );
	}

	@Override
	public Optional&lt;String&gt; getProperty(ConstrainableExecutable executable) {
		if ( methodNamesToIgnore.contains( executable.getName() )
				|| executable.getReturnType() == void.class
				|| executable.getParameterTypes().length &gt; 0 ) {
			return Optional.empty();
		}

		return Optional.of( executable.getName() );
	}

	@Override
	public Set&lt;String&gt; getGetterMethodNameCandidates(String propertyName) {
		// As method name == property name, there always is just one possible name for a method
		return Collections.singleton( propertyName );
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>There are multiple ways to configure Hibernate Validator to use this strategy. It can either be done programmatically (see <a href="#custom-getter-strategy-programmatically">Example 162, &#8220;Configuring a custom <code>GetterPropertySelectionStrategy</code> programmatically&#8221;</a>)
                            or by using the
                            <code>hibernate.validator.getter_property_selection_strategy</code> property in the XML configuration (see <a href="#custom-getter-strategy-xml">Example 163, &#8220;Configuring a custom <code>GetterPropertySelectionStrategy</code> using an XML property&#8221;</a>).</p>
                    </div>
                    <div id="custom-getter-strategy-programmatically" class="exampleblock">
                        <div class="title">Example 162. Configuring a custom <code>GetterPropertySelectionStrategy</code> programmatically</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">Validator validator = Validation.byProvider( HibernateValidator.class )
		.configure()
		// Setting a custom getter property selection strategy
		.getterPropertySelectionStrategy( new FluentGetterPropertySelectionStrategy() )
		.buildValidatorFactory()
		.getValidator();

User user = new User( "", "", "not an email" );

Set&lt;ConstraintViolation&lt;User&gt;&gt; constraintViolations = validator.validate( user );

assertEquals( 3, constraintViolations.size() );</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="custom-getter-strategy-xml" class="exampleblock">
                        <div class="title">Example 163. Configuring a custom <code>GetterPropertySelectionStrategy</code> using an XML property</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;validation-config
        xmlns="https://jakarta.ee/xml/ns/validation/configuration"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="https://jakarta.ee/xml/ns/validation/configuration
            https://jakarta.ee/xml/ns/validation/validation-configuration-3.0.xsd"
        version="3.0"&gt;

    &lt;property name="hibernate.validator.getter_property_selection_strategy"&gt;
        org.hibernate.validator.referenceguide.chapter12.getterselectionstrategy.NoPrefixGetterPropertySelectionStrategy
    &lt;/property&gt;

&lt;/validation-config&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="admonitionblock warning">
                        <table>
                            <tr>
                                <td class="icon">
                                    <div class="title">Warning</div>
                                </td>
                                <td class="content">
                                    <div class="paragraph">
                                        <p>It is important to mention that in cases where programmatic constraints are added using
                                            <code>HibernateValidatorConfiguration#addMapping(ConstraintMapping)</code>, adding mappings should always be done after the required getter property selection strategy is configured. Otherwise, the default strategy
                                            will be used for the mappings added before defining the strategy.</p>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="section-property-node-name-provider">
                        <a class="anchor" href="#section-property-node-name-provider"></a>12.18. Customizing the property name resolution for constraint violations</h3>
                    <div class="paragraph">
                        <p>Imagine that we have a simple data class that has <code>@NotNull</code> constraints on some fields:</p>
                    </div>
                    <div id="example-person-class" class="exampleblock">
                        <div class="title">Example 164. Person data class</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">public class Person {
	@NotNull
	@JsonProperty("first_name")
	private final String firstName;

	@JsonProperty("last_name")
	private final String lastName;

	public Person(String firstName, String lastName) {
		this.firstName = firstName;
		this.lastName = lastName;
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This class can be serialized to JSON by using the <a href="https://github.com/FasterXML/jackson">Jackson</a> library:</p>
                    </div>
                    <div id="example-person-object-to-json" class="exampleblock">
                        <div class="title">Example 165. Serializing Person object to JSON</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">public class PersonSerializationTest {
	private final ObjectMapper objectMapper = new ObjectMapper();

	@Test
	public void personIsSerialized() throws JsonProcessingException {
		Person person = new Person( "Clark", "Kent" );

		String serializedPerson = objectMapper.writeValueAsString( person );

		assertEquals( "{\"first_name\":\"Clark\",\"last_name\":\"Kent\"}", serializedPerson );
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>As we can see, the object is serialized to:</p>
                    </div>
                    <div id="example-person-json" class="exampleblock">
                        <div class="title">Example 166. Person as json</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-none hljs">{
  "first_name": "Clark",
  "last_name": "Kent"
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Notice how the names of the properties differ. In the Java object, we have <code>firstName</code> and <code>lastName</code>, whereas in the JSON output, we have
                            <code>first_name</code> and <code>last_name</code>. We customized this behavior through <code>@JsonProperty</code> annotations.</p>
                    </div>
                    <div class="paragraph">
                        <p>Now imagine that we use this class in a REST environment, where a user can send <a href="#example-person-json">a <code>Person</code> instance as JSON</a> in the request body. It would be nice, when indicating on which field the
                            validation failed, to indicate the name they use in their JSON request, <code>first_name</code>, and not the name we use internally in our Java code, <code>firstName</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p>The <code>org.hibernate.validator.spi.nodenameprovider.PropertyNodeNameProvider</code> contract allows us to do this. By implementing it, we can define how the name of a property will be resolved during validation. In our case,
                            we want to read the value from the Jackson configuration.</p>
                    </div>
                    <div class="paragraph">
                        <p>One example of how to do this is to leverage the Jackson API:</p>
                    </div>
                    <div id="example-jackson-property-node-name-provider" class="exampleblock">
                        <div class="title">Example 167. JacksonPropertyNodeNameProvider implementation</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">import org.hibernate.validator.spi.nodenameprovider.JavaBeanProperty;
import org.hibernate.validator.spi.nodenameprovider.Property;
import org.hibernate.validator.spi.nodenameprovider.PropertyNodeNameProvider;

import com.fasterxml.jackson.databind.BeanDescription;
import com.fasterxml.jackson.databind.JavaType;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.introspect.BeanPropertyDefinition;

public class JacksonPropertyNodeNameProvider implements PropertyNodeNameProvider {
	private final ObjectMapper objectMapper = new ObjectMapper();

	@Override
	public String getName(Property property) {
		if ( property instanceof JavaBeanProperty ) {
			return getJavaBeanPropertyName( (JavaBeanProperty) property );
		}

		return getDefaultName( property );
	}

	private String getJavaBeanPropertyName(JavaBeanProperty property) {
		JavaType type = objectMapper.constructType( property.getDeclaringClass() );
		BeanDescription desc = objectMapper.getSerializationConfig().introspect( type );

		return desc.findProperties()
				.stream()
				.filter( prop -&gt; prop.getInternalName().equals( property.getName() ) )
				.map( BeanPropertyDefinition::getName )
				.findFirst()
				.orElse( property.getName() );
	}

	private String getDefaultName(Property property) {
		return property.getName();
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>And when doing the validation:</p>
                    </div>
                    <div id="example-jackson-property-node-name-provider-field" class="exampleblock">
                        <div class="title">Example 168. JacksonPropertyNodeNameProvider usage</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">public class JacksonPropertyNodeNameProviderTest {
	@Test
	public void nameIsReadFromJacksonAnnotationOnField() {
		ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
				.configure()
				.propertyNodeNameProvider( new JacksonPropertyNodeNameProvider() )
				.buildValidatorFactory();

		Validator validator = validatorFactory.getValidator();

		Person clarkKent = new Person( null, "Kent" );

		Set&lt;ConstraintViolation&lt;Person&gt;&gt; violations = validator.validate( clarkKent );
		ConstraintViolation&lt;Person&gt; violation = violations.iterator().next();

		assertEquals( violation.getPropertyPath().toString(), "first_name" );
	}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>We can see that the property path now returns <code>first_name</code>.</p>
                    </div>
                    <div class="paragraph">
                        <p>Note that this also works when the annotations are on a getter:</p>
                    </div>
                    <div id="example-jackson-property-node-name-provider-getter" class="exampleblock">
                        <div class="title">Example 169. Annotation on a getter</div>
                        <div class="content">
                            <div class="listingblock">
                                <div class="content">
                                    <pre class="highlightjs highlight"><code class="language-JAVA hljs" data-lang="JAVA">@Test
public void nameIsReadFromJacksonAnnotationOnGetter() {
	ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
			.configure()
			.propertyNodeNameProvider( new JacksonPropertyNodeNameProvider() )
			.buildValidatorFactory();

	Validator validator = validatorFactory.getValidator();

	Person clarkKent = new Person( null, "Kent" );

	Set&lt;ConstraintViolation&lt;Person&gt;&gt; violations = validator.validate( clarkKent );
	ConstraintViolation&lt;Person&gt; violation = violations.iterator().next();

	assertEquals( violation.getPropertyPath().toString(), "first_name" );
}

public class Person {
	private final String firstName;

	@JsonProperty("last_name")
	private final String lastName;

	public Person(String firstName, String lastName) {
		this.firstName = firstName;
		this.lastName = lastName;
	}

	@NotNull
	@JsonProperty("first_name")
	public String getFirstName() {
		return firstName;
	}
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>This is just one use case of why we would like to change how the property names are resolved.</p>
                    </div>
                    <div class="paragraph">
                        <p><code>org.hibernate.validator.spi.nodenameprovider.PropertyNodeNameProvider</code> can be implemented to provide a property name in whatever way you see fit (reading from annotations, for instance).</p>
                    </div>
                    <div class="paragraph">
                        <p>There are two more interfaces that are worth mentioning:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p><code>org.hibernate.validator.spi.nodenameprovider.Property</code> is a base interface that holds metadata about a property. It has a single <code>String getName()</code> method that can be used to get the "original" name
                                    of a property. This interface should be used as a default way of resolving the name (see how it is used in <a href="#example-jackson-property-node-name-provider">Example 167, &#8220;JacksonPropertyNodeNameProvider implementation&#8221;</a>).</p>
                            </li>
                            <li>
                                <p><code>org.hibernate.validator.spi.nodenameprovider.JavaBeanProperty</code> is an interface that holds metadata about a bean property. It extends <code>org.hibernate.validator.spi.nodenameprovider.Property</code> and provide
                                    some additional methods like <code>Class&lt;?&gt; getDeclaringClass()</code> which returns the class that is the owner of the property.</p>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="validator-annotation-processor">
                <a class="anchor" href="#validator-annotation-processor"></a>13. Annotation Processor</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>Have you ever caught yourself by unintentionally doing things like</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p>specifying constraint annotations at unsupported data types (e.g. by annotating a String with <code>@Past</code>)</p>
                        </li>
                        <li>
                            <p>annotating the setter of a JavaBeans property (instead of the getter method)</p>
                        </li>
                        <li>
                            <p>annotating static fields/methods with constraint annotations (which is not supported)?</p>
                        </li>
                    </ul>
                </div>
                <div class="paragraph">
                    <p>Then the Hibernate Validator Annotation Processor is the right thing for you. It helps preventing such mistakes by plugging into the build process and raising compilation errors whenever constraint annotations are incorrectly used.</p>
                </div>
                <div class="admonitionblock tip">
                    <table>
                        <tr>
                            <td class="icon">
                                <div class="title">Tip</div>
                            </td>
                            <td class="content">
                                <div class="paragraph">
                                    <p>You can find the Hibernate Validator Annotation Processor as part of the distribution bundle on
                                        <a href="http://sourceforge.net/projects/hibernate/files/hibernate-validator">Sourceforge</a> or in the usual Maven repositories such as Maven Central under the GAV
                                        <code>org.hibernate.validator:hibernate-validator-annotation-processor:{hvVersion}</code>.</p>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="sect2">
                    <h3 id="validator-annotationprocessor-prerequisites">
                        <a class="anchor" href="#validator-annotationprocessor-prerequisites"></a>13.1. Prerequisites</h3>
                    <div class="paragraph">
                        <p>The Hibernate Validator Annotation Processor is based on the "Pluggable Annotation Processing API" as defined by <a href="http://jcp.org/en/jsr/detail?id=269">JSR 269</a> which is part of the Java Platform.
                        </p>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="validator-annotationprocessor-features">
                        <a class="anchor" href="#validator-annotationprocessor-features"></a>13.2. Features</h3>
                    <div class="paragraph">
                        <p>As of Hibernate Validator {hvVersion} the Hibernate Validator Annotation Processor checks that:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>constraint annotations are allowed for the type of the annotated element</p>
                            </li>
                            <li>
                                <p>only non-static fields or methods are annotated with constraint annotations</p>
                            </li>
                            <li>
                                <p>only non-primitive fields or methods are annotated with <code>@Valid</code></p>
                            </li>
                            <li>
                                <p>only such methods are annotated with constraint annotations which are valid JavaBeans getter methods (optionally, see below)</p>
                            </li>
                            <li>
                                <p>only such annotation types are annotated with constraint annotations which are constraint annotations themselves</p>
                            </li>
                            <li>
                                <p>definition of dynamic default group sequence with <code>@GroupSequenceProvider</code> is valid</p>
                            </li>
                            <li>
                                <p>annotation parameter values are meaningful and valid</p>
                            </li>
                            <li>
                                <p>method parameter constraints in inheritance hierarchies respect the inheritance rules</p>
                            </li>
                            <li>
                                <p>method return value constraints in inheritance hierarchies respect the inheritance rules</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="validator-annotationprocessor-options">
                        <a class="anchor" href="#validator-annotationprocessor-options"></a>13.3. Options</h3>
                    <div class="paragraph">
                        <p>The behavior of the Hibernate Validator Annotation Processor can be controlled using the following {javaTechnotesBaseUrl}/tools/windows/javac.html#BHCHACIB[processor options]:</p>
                    </div>
                    <div class="dlist">
                        <dl>
                            <dt class="hdlist1"><code>diagnosticKind</code></dt>
                            <dd>
                                <p>Controls how constraint problems are reported. Must be the string representation of one of the values from the enum <code>javax.tools.Diagnostic.Kind</code>, e.g. <code>WARNING</code>. A value of <code>ERROR</code> will
                                    cause compilation to halt whenever the AP detects a constraint problem. Defaults to <code>ERROR</code>.</p>
                            </dd>
                            <dt class="hdlist1"><code>methodConstraintsSupported</code></dt>
                            <dd>
                                <p>Controls whether constraints are allowed at methods of any kind. Must be set to <code>true</code> when working with method level constraints as supported by Hibernate Validator. Can be set to <code>false</code> to allow
                                    constraints only at JavaBeans getter methods as defined by the Jakarta Bean Validation API. Defaults to <code>true</code>.</p>
                            </dd>
                            <dt class="hdlist1"><code>verbose</code></dt>
                            <dd>
                                <p>Controls whether detailed processing information shall be displayed or not, useful for debugging purposes. Must be either
                                    <code>true</code> or <code>false</code>. Defaults to <code>false</code>.</p>
                            </dd>
                        </dl>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="validator-annotationprocessor-usage">
                        <a class="anchor" href="#validator-annotationprocessor-usage"></a>13.4. Using the Annotation Processor</h3>
                    <div class="paragraph">
                        <p>This section shows in detail how to integrate the Hibernate Validator Annotation Processor into command line builds (Maven, Ant, javac) as well as IDE-based builds (Eclipse, IntelliJ IDEA, NetBeans).
                        </p>
                    </div>
                    <div class="sect3">
                        <h4 id="validator-annotationprocessor-commandline">
                            <a class="anchor" href="#validator-annotationprocessor-commandline"></a>13.4.1. Command line builds</h4>
                        <div class="sect4">
                            <h5 id="validator-annotationprocessor-maven">
                                <a class="anchor" href="#validator-annotationprocessor-maven"></a>13.4.1.1. Maven</h5>
                            <div class="paragraph">
                                <p>For using the Hibernate Validator annotation processor with Maven, set it up via the <code>annotationProcessorPaths</code> option like this:</p>
                            </div>
                            <div class="exampleblock">
                                <div class="title">Example 170. Using the HV Annotation Processor with Maven</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;project&gt;
    [...]
    &lt;build&gt;
        [...]
        &lt;plugins&gt;
            [...]
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.6.1&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;source&gt;1.8&lt;/source&gt;
                    &lt;target&gt;1.8&lt;/target&gt;
                    &lt;annotationProcessorPaths&gt;
                        &lt;path&gt;
                            &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;
                            &lt;artifactId&gt;hibernate-validator-annotation-processor&lt;/artifactId&gt;
                            &lt;version&gt;{hvVersion}&lt;/version&gt;
                        &lt;/path&gt;
                    &lt;/annotationProcessorPaths&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            [...]
        &lt;/plugins&gt;
        [...]
    &lt;/build&gt;
    [...]
&lt;/project&gt;</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="validator-annotationprocessor-gradle">
                                <a class="anchor" href="#validator-annotationprocessor-gradle"></a>13.4.1.2. Gradle</h5>
                            <div class="paragraph">
                                <p>When using <a href="https://gradle.org">Gradle</a> it is enough to reference the annotation processor as an <code>annotationProcessor</code> dependency.</p>
                            </div>
                            <div class="exampleblock">
                                <div class="title">Example 171. Using the annotation processor with Gradle</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
	annotationProcessor group: 'org.hibernate.validator', name: 'hibernate-validator-annotation-processor', version: '{hvVersion}'

	// any other dependencies ...
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="validator-annotationprocessor-ant">
                                <a class="anchor" href="#validator-annotationprocessor-ant"></a>13.4.1.3. Apache Ant</h5>
                            <div class="paragraph">
                                <p>Similar to directly working with javac, the annotation processor can be added as as compiler argument when invoking the <a href="http://ant.apache.org/manual/CoreTasks/javac.html">javac task</a> for <a href="http://ant.apache.org/">Apache Ant</a>:</p>
                            </div>
                            <div class="exampleblock">
                                <div class="title">Example 172. Using the annotation processor with Ant</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">&lt;javac srcdir="src/main"
       destdir="build/classes"
       classpath="/path/to/validation-api-{bvVersion}.jar"&gt;
       &lt;compilerarg value="-processorpath" /&gt;
       &lt;compilerarg value="/path/to/hibernate-validator-annotation-processor-{hvVersion}.jar"/&gt;
&lt;/javac&gt;</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="validator-annotationprocessor-javac">
                                <a class="anchor" href="#validator-annotationprocessor-javac"></a>13.4.1.4. javac</h5>
                            <div class="paragraph">
                                <p>When compiling on the command line using {javaTechnotesBaseUrl}/guides/javac/index.html[javac], specify the JAR
                                    <em>hibernate-validator-annotation-processor-{hvVersion}.jar</em> using the "processorpath" option as shown in the following listing. The processor will be detected automatically by the compiler and invoked during compilation.</p>
                            </div>
                            <div class="exampleblock">
                                <div class="title">Example 173. Using the annotation processor with javac</div>
                                <div class="content">
                                    <div class="listingblock">
                                        <div class="content">
                                            <pre>javac src/main/java/org/hibernate/validator/ap/demo/Car.java \
   -cp /path/to/validation-api-{bvVersion}.jar \
   -processorpath /path/to/hibernate-validator-annotation-processor-{hvVersion}.jar</pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sect3">
                        <h4 id="validator-annotationprocessor-ide">
                            <a class="anchor" href="#validator-annotationprocessor-ide"></a>13.4.2. IDE builds</h4>
                        <div class="sect4">
                            <h5 id="_eclipse">
                                <a class="anchor" href="#_eclipse"></a>13.4.2.1. Eclipse</h5>
                            <div class="paragraph">
                                <p>The annotation processor will automatically be set up for Maven projects configured as described above, provided you have the <a href="https://www.eclipse.org/m2e/">M2E Eclipse plug-in</a> installed.</p>
                            </div>
                            <div class="paragraph">
                                <p>For plain Eclipse projects follow these steps to set up the annotation processor:</p>
                            </div>
                            <div class="ulist">
                                <ul>
                                    <li>
                                        <p>Right-click your project, choose "Properties"</p>
                                    </li>
                                    <li>
                                        <p>Go to "Java Compiler" and make sure, that "Compiler compliance level" is set to "1.8". Otherwise the processor won&#8217;t be activated</p>
                                    </li>
                                    <li>
                                        <p>Go to "Java Compiler - Annotation Processing" and choose "Enable annotation processing"</p>
                                    </li>
                                    <li>
                                        <p>Go to "Java Compiler - Annotation Processing - Factory Path" and add the JAR hibernate-validator-annotation-processor-{hvVersion}.jar
                                        </p>
                                    </li>
                                    <li>
                                        <p>Confirm the workspace rebuild</p>
                                    </li>
                                </ul>
                            </div>
                            <div class="paragraph">
                                <p>You now should see any annotation problems as regular error markers within the editor and in the "Problem" view:</p>
                            </div>
                            <div class="imageblock">
                                <div class="content">
                                    <img src="annotation_processor_eclipse.png" alt="annotation processor eclipse">
                                </div>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="validator-annotationprocessor-idea">
                                <a class="anchor" href="#validator-annotationprocessor-idea"></a>13.4.2.2. IntelliJ IDEA</h5>
                            <div class="paragraph">
                                <p>The following steps must be followed to use the annotation processor within
                                    <a href="http://www.jetbrains.com/idea/">IntelliJ IDEA</a> (version 9 and above):</p>
                            </div>
                            <div class="ulist">
                                <ul>
                                    <li>
                                        <p>Go to "File", then "Settings",</p>
                                    </li>
                                    <li>
                                        <p>Expand the node "Compiler", then "Annotation Processors"</p>
                                    </li>
                                    <li>
                                        <p>Choose "Enable annotation processing" and enter the following as "Processor path": /path/to/hibernate-validator-annotation-processor-{hvVersion}.jar
                                        </p>
                                    </li>
                                    <li>
                                        <p>Add the processor&#8217;s fully qualified name org.hibernate.validator.ap.ConstraintValidationProcessor to the "Annotation Processors" list</p>
                                    </li>
                                    <li>
                                        <p>If applicable add you module to the "Processed Modules" list</p>
                                    </li>
                                </ul>
                            </div>
                            <div class="paragraph">
                                <p>Rebuilding your project then should show any erroneous constraint annotations:</p>
                            </div>
                            <div class="imageblock">
                                <div class="content">
                                    <img src="annotation_processor_intellij.png" alt="annotation processor intellij">
                                </div>
                            </div>
                        </div>
                        <div class="sect4">
                            <h5 id="validator-annotationprocessor-netbeans">
                                <a class="anchor" href="#validator-annotationprocessor-netbeans"></a>13.4.2.3. NetBeans</h5>
                            <div class="paragraph">
                                <p>The <a href="http://www.netbeans.org/">NetBeans</a> IDE supports using annotation processors within the IDE build. To do so, do the following:</p>
                            </div>
                            <div class="ulist">
                                <ul>
                                    <li>
                                        <p>Right-click your project, choose "Properties"</p>
                                    </li>
                                    <li>
                                        <p>Go to "Libraries", tab "Processor", and add the JAR hibernate-validator-annotation-processor-{hvVersion}.jar</p>
                                    </li>
                                    <li>
                                        <p>Go to "Build - Compiling", select "Enable Annotation Processing" and "Enable Annotation Processing in Editor". Add the annotation processor by specifying its fully qualified name org.hibernate.validator.ap.ConstraintValidationProcessor
                                        </p>
                                    </li>
                                </ul>
                            </div>
                            <div class="paragraph">
                                <p>Any constraint annotation problems will then be marked directly within the editor:</p>
                            </div>
                            <div class="imageblock">
                                <div class="content">
                                    <img src="annotation_processor_netbeans.png" alt="annotation processor netbeans">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sect2">
                    <h3 id="validator-annotationprocessor-known-issues">
                        <a class="anchor" href="#validator-annotationprocessor-known-issues"></a>13.5. Known issues</h3>
                    <div class="paragraph">
                        <p>The following known issues exist as of July 2017:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>Container element constraints are not supported for now.</p>
                            </li>
                            <li>
                                <p>Constraints applied to a container but in reality applied to the container elements (be it via the <code>Unwrapping.Unwrap</code> payload or via a value extractor marked with <code>@UnwrapByDefault</code>) are not supported
                                    correctly.
                                </p>
                            </li>
                            <li>
                                <p><a href="https://hibernate.atlassian.net/browse/HV-308">HV-308</a>: Additional validators registered for a constraint
                                    <a href="http://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/#chapter-xml-configuration">using XML</a> are not evaluated by the annotation processor.</p>
                            </li>
                            <li>
                                <p>Sometimes custom constraints can&#8217;t be
                                    <a href="https://hibernate.atlassian.net/browse/HV-293">properly evaluated</a> when using the processor within Eclipse. Cleaning the project can help in these situations. This seems to be an issue with the Eclipse JSR
                                    269 API implementation, but further investigation is required here.</p>
                            </li>
                            <li>
                                <p>When using the processor within Eclipse, the check of dynamic default group sequence definitions doesn&#8217;t work. After further investigation, it seems to be an issue with the Eclipse JSR 269 API implementation.
                                </p>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="sect1">
            <h2 id="validator-further-reading">
                <a class="anchor" href="#validator-further-reading"></a>14. Further reading</h2>
            <div class="sectionbody">
                <div class="paragraph">
                    <p>Last but not least, a few pointers to further information.</p>
                </div>
                <div class="paragraph">
                    <p>A great source for examples is the Jakarta Bean Validation TCK which is available for anonymous access on
                        <a href="https://github.com/beanvalidation/beanvalidation-tck/">GitHub</a>. In particular the TCK&#8217;s
                        <a href="https://github.com/beanvalidation/beanvalidation-tck/tree/master/tests">tests</a> might be of interest. {bvSpecUrl}[The Jakarta Bean Validation] specification itself is also a great way to deepen your understanding of
                        Jakarta Bean Validation and Hibernate Validator.</p>
                </div>
                <div class="paragraph">
                    <p>If you have any further questions about Hibernate Validator or want to share some of your use cases, have a look at the <a href="http://community.jboss.org/en/hibernate/validator">Hibernate Validator
Wiki</a>, the <a href="https://discourse.hibernate.org/c/hibernate-validator">Hibernate Validator Forum</a> and the
                        <a href="https://stackoverflow.com/questions/tagged/hibernate-validator">Hibernate Validator tag on Stack Overflow</a>.</p>
                </div>
                <div class="paragraph">
                    <p>In case you would like to report a bug use
                        <a href="https://hibernate.atlassian.net/projects/HV/">Hibernate&#8217;s Jira</a> instance. Feedback is always welcome!</p>
                </div>
            </div>
        </div>
    </div>
    <div id="footer">
        <div id="footer-text">
            Last updated 2021-03-21 19:28:33 +0800
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/highlight.min.js"></script>
    <script>
        if (!hljs.initHighlighting.called) {
            hljs.initHighlighting.called = true;
            [].slice.call(document.querySelectorAll('pre.highlight > code')).forEach(function(el) {
                hljs.highlightBlock(el)
            })
        }
    </script>
</body>

</html>