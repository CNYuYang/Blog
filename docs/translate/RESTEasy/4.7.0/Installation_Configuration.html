<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">第 3 章 安装/配置</title><link rel="stylesheet" href="css/jbossorg.css" type="text/css"/><meta xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL-NS Stylesheets V1.74.0"/><meta xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" http-equiv="Content-Type" content="text/html; charset=UTF-8"/><link rel="home" href="index.html" title="RESTEasy JAX-RS"/><link rel="up" href="index.html" title="RESTEasy JAX-RS"/><link rel="prev" href="license.html" title="第 2 章 开源许可"/><link rel="next" href="Using_Path.html" title="第 4 章 使用 @Path 和 @GET, @POST 等注解"/></head><body><p xmlns:d="http://docbook.org/ns/docbook" id="title"><a href="http://www.jboss.org" class="site_href"><strong>JBoss.org</strong></a><a href="http://docs.jboss.org/" class="doc_href"><strong>Community Documentation</strong></a></p><ul xmlns:d="http://docbook.org/ns/docbook" class="docnav"><li class="previous"><a accesskey="p" href="license.html"><strong>上一页</strong></a></li><li class="next"><a accesskey="n" href="Using_Path.html"><strong>下一页</strong></a></li></ul><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="Installation_Configuration"/>第 3 章 安装/配置</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="Installation_Configuration.html#resteasy_modules_in_wildfly">3.1.  WildFly 中的 RESTEasy 模块</a></span></dt><dd><dl><dt><span class="section"><a href="Installation_Configuration.html#other_resteasy_modules">3.1.1. 其他 RESTEasy 模块</a></span></dt><dt><span class="section"><a href="Installation_Configuration.html#upgrading-wildfly">3.1.2. 升级 WildFly 中的 RESTEasy</a></span></dt></dl></dd><dt><span class="section"><a href="Installation_Configuration.html#d4e123">3.2. 将 RESTEasy 应用程序部署到 WildFly</a></span></dt><dt><span class="section"><a href="Installation_Configuration.html#standalone_resteasy">3.3. 部署到其他 servlet 容器</a></span></dt><dd><dl><dt><span class="section"><a href="Installation_Configuration.html#d4e155">3.3.1. Servlet 3.0 容器</a></span></dt><dt><span class="section"><a href="Installation_Configuration.html#d4e161">3.3.2. 老的 servlet 容器</a></span></dt></dl></dd><dt><span class="section"><a href="Installation_Configuration.html#microprofile_config">3.4. 配置</a></span></dt><dd><dl><dt><span class="section"><a href="Installation_Configuration.html#resteasy_microprofile_config">3.4.1. RESTEasy with MicroProfile Config</a></span></dt><dt><span class="section"><a href="Installation_Configuration.html#d4e241">3.4.2. 完全使用 MicroProfile Config</a></span></dt><dt><span class="section"><a href="Installation_Configuration.html#d4e260">3.4.3. 使用 RESTEasy 的 MicroProfile Config扩展</a></span></dt><dt><span class="section"><a href="Installation_Configuration.html#configuring_mp_config">3.4.4. 配置 MicroProfile Config</a></span></dt><dt><span class="section"><a href="Installation_Configuration.html#classic_config">3.4.5. RESTEasy 的经典配置机制 </a></span></dt><dt><span class="section"><a href="Installation_Configuration.html#overriding_config">3.4.6. 覆盖 RESTEasy 的配置机制</a></span></dt></dl></dd><dt><span class="section"><a href="Installation_Configuration.html#configuration_switches">3.5. 配置开关</a></span></dt><dt><span class="section"><a href="Installation_Configuration.html#javax.ws.rs.core.Application">3.6. javax.ws.rs.core.Application</a></span></dt><dt><span class="section"><a href="Installation_Configuration.html#listener">3.7. RESTEasy 作为 ServletContextListener</a></span></dt><dt><span class="section"><a href="Installation_Configuration.html#filter">3.8. RESTEasy 作为 Servlet Filter</a></span></dt><dt><span class="section"><a href="Installation_Configuration.html#d4e446">3.9. 客户端</a></span></dt></dl></div>
    

    <p>
        RESTEasy 可以根据你的运行环境，采取不同的安装和配置方式。如果你正在使用 WildFly，RESTEasy 已经被完全集成和捆绑进去，所以你只需要做很少的事情。如果您在其他的环境中运行，则必须手动进行一些安装和配置。
    </p>

    <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="resteasy_modules_in_wildfly"/>3.1.  WildFly 中的 RESTEasy 模块</h2></div></div></div>
        
        <p>
            在 WildFly 中，只有在部署 JAX-RS 应用程序时(由 JAX-RS 注解的存在决定) ，RESTEasy 和 JAX-RS API 才会自动加载到部署的类路径中。但是，只有一些 RESTEasy 特性是自动加载的。见表3.1。如果您需要那些未自动加载的库中的任何一个，那么您必须使用 WAR 文件的 WEB-INF 目录中的 jboss-deployment-structure.xml 文件引入它们。下面是一个例子:
        </p>
        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;jboss-deployment-structure&gt;
    &lt;deployment&gt;
        &lt;dependencies&gt;
            &lt;module name="org.jboss.resteasy.resteasy-jackson-provider" services="import"/&gt;
        &lt;/dependencies&gt;
    &lt;/deployment&gt;
&lt;/jboss-deployment-structure&gt;</pre>
        <p>对于在 META-INF/services/javax.ws.rs.ext.Providers 文件中具有默认提供程序的模块，必须将 <code class="literal">services</code> 属性设置为"import"。 </p>
        <p>
            要了解在部署 JAX-RS 服务时默认加载了哪些 RESTEasy 模块，请参阅下表，该表是指使用当前RESTEasy发行版修补的最新WildFly发行版。显然，未来的 WildFly 发行版和未修补的 WildFly 发行版在默认启用的模块方面可能有所不同，因为容器实际上也控制着它们。
        </p>
        <p>
            </p><div class="table"><a id="d4e30"/><p class="title"><b>表 3.1. </b></p><div class="table-contents">
            <table border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th>
                        模块名称
                    </th><th>
                        默认是否加载
                    </th><th>
                        模块介绍
                    </th></tr></thead><tbody><tr><td>
                        org.jboss.resteasy.resteasy-atom-provider
                    </td><td>
                        yes
                    </td><td>
                        RESTEasy's atom library
                    </td></tr><tr><td>
                        org.jboss.resteasy.resteasy-cdi
                    </td><td>
                        yes
                    </td><td>
                        RESTEasy CDI integration
                    </td></tr><tr><td>
                        org.jboss.resteasy.resteasy-crypto
                    </td><td>
                        yes
                    </td><td>
                        S/MIME, DKIM, and support for other security formats.
                    </td></tr><tr><td>
                        org.jboss.resteasy.resteasy-jackson-provider
                    </td><td>
                        no
                    </td><td>
                        Integration with the JSON parser and object mapper Jackson (deprecated)
                    </td></tr><tr><td>
                        org.jboss.resteasy.resteasy-jackson2-provider
                    </td><td>
                        yes
                    </td><td>
                        Integration with the JSON parser and object mapper Jackson 2
                    </td></tr><tr><td>
                        org.jboss.resteasy.resteasy-jaxb-provider
                    </td><td>
                        yes
                    </td><td>
                        XML JAXB integration.
                    </td></tr><tr><td>
                        org.jboss.resteasy.resteasy-jaxrs
                    </td><td>
                        yes
                    </td><td>
                        Core RESTEasy libraries for server and client.  You will need to include this in your deployment
                        if you are only using JAX-RS client.
                    </td></tr><tr><td>
                        org.jboss.resteasy.jose-jwt
                    </td><td>
                        no
                    </td><td>
                        JSON Web Token support.
                    </td></tr><tr><td>
                        org.jboss.resteasy.resteasy-jsapi
                    </td><td>
                        yes
                    </td><td>
                        RESTEasy's Javascript API
                    </td></tr><tr><td>
                        org.jboss.resteasy.resteasy-json-p-provider
                    </td><td>
                        yes
                    </td><td>
                        JSON parsing API
                    </td></tr><tr><td>
                        org.jboss.resteasy.resteasy-json-binding-provider
                    </td><td>
                        yes
                    </td><td>
                        JSON binding API
                    </td></tr><tr><td>
                        javax.json.bind-api
                    </td><td>
                        yes
                    </td><td>
                        JSON binding API
                    </td></tr><tr><td>
                        org.eclipse.yasson
                    </td><td>
                        yes
                    </td><td>
                        RI implementation of JSON binding API
                    </td></tr><tr><td>
                        org.jboss.resteasy.resteasy-multipart-provider
                    </td><td>
                        yes
                    </td><td>
                        Support for multipart formats
                    </td></tr><tr><td>
                        org.jboss.resteasy.resteasy-spring
                    </td><td>
                        no
                    </td><td>
                        Spring provider
                    </td></tr><tr><td>
                        org.jboss.resteasy.resteasy-validator-provider
                    </td><td>
                        yes
                    </td><td>
                        RESTEasy's interface to Hibernate Bean Validation
                    </td></tr></tbody></table>
            </div></div><p><br class="table-break"/>
        </p>

        <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="other_resteasy_modules"/>3.1.1. 其他 RESTEasy 模块</h3></div></div></div>
        
            <p>
                并非所有 RESTEasy 模块都与 WildFly 绑定。例如， <code class="code">resteasy-fastinfoset-provider</code> 和 <code class="code">resteasy-wadl</code> 没有包含在 <a class="xref" href="Installation_Configuration.html#resteasy_modules_in_wildfly" title="3.1.  WildFly 中的 RESTEasy 模块">第 3.1 节 “ WildFly 中的 RESTEasy 模块”</a> 中列出的模块中。如果希望在应用程序中使用它们，可以将它们包含在 WAR 包中，就像在 WildFly 之外部署它们一样。有关更多信息，请参见 <a class="xref" href="Installation_Configuration.html#standalone_resteasy" title="3.3. 部署到其他 servlet 容器">第 3.3 节 “部署到其他 servlet 容器”</a>。
        </p>
        </div>
	    <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="upgrading-wildfly"/>3.1.2. 升级 WildFly 中的 RESTEasy</h3></div></div></div>
	        
	        <p>
                RESTEasy 与 WildFly 捆绑在一起，但您可能希望将 WildFly 中的 RESTEasy 升级到最新版本。RESTEasy 发行版附带一个名为 <code class="code">resteasy-jboss-modules-4.7.0-SNAPSHOT.zip</code> 的压缩文件。将此文件解压缩到 WildFly 发行版的 modules/system/layers/base/ 目录中。这将配置 WildFly 使用 <a class="xref" href="Installation_Configuration.html#resteasy_modules_in_wildfly" title="3.1.  WildFly 中的 RESTEasy 模块">第 3.1 节 “ WildFly 中的 RESTEasy 模块”</a> 中列出的模块的新版本。
	        </p>
            <p>
                要构建 <code class="code">resteasy-jboss-modules-4.7.0-SNAPSHOT.zip</code> ，请进入项目的 <code class="code">jboss-modules</code> 目录，并运行以下 Maven 命令:
                </p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">$ mvn install</pre><p>
                它将开始构建模块，最后将在 "target" 目录中生成 zip 文件:
                </p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">$ pwd
resteasy/jboss-modules
$ ls target/*.zip
target/resteasy-jboss-modules-4.7.0-SNAPSHOT-mavenized.zip
target/resteasy-jboss-modules-4.7.0-SNAPSHOT.zip
</pre><p>
            </p>
            <p>
                要使用这个 zip 文件，你需要将它复制到 Wildfly 的 "modules" 目录中:
                </p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">$ pwd
wildfly
$ ls
LICENSE.txt       bin               domain            standalone
README.txt        copyright.txt     jboss-modules.jar welcome-content
appclient         docs              modules

</pre><p>
            </p>
            <p>
                使用以下步骤将模块的 zip 文件复制并解压缩到 Wildfly 的 modules 目录中:
                </p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
$ cp ~/works/resteasy/jboss-modules/target/resteasy-jboss-modules-4.7.0-SNAPSHOT.zip \
modules/system/layers/base/
$ cd modules/system/layers/base
$ unzip resteasy-jboss-modules-4.7.0-SNAPSHOT.zip
...</pre><p>
                通过上述过程，RESTEasy 模块在 Wildfly 中得到升级。
            </p>
	    </div>
    </div>
    <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d4e123"/>3.2. 将 RESTEasy 应用程序部署到 WildFly</h2></div></div></div>
        
        <p>
            RESTEasy 与 WildFly 捆绑在一起，并根据 Java EE 的要求完全集成。您可以将其与 EJB 和 CDI 一起使用，并且可以完全依赖 WildFly 来扫描和部署 JAX-RS 服务和提供者。您需要提供的只是打包在 WAR 中的 JAX-RS 服务和提供者类，它们可以是 POJOs、 CDI beans 或 EJBs。配置应用程序的一种简单方法是提供一个空的 web.xml 文件。当然，你可以在 web.xml 中部署任何你想要的定制 servlet、过滤器或者安全约束，但是这些都不是必需的:
        </p>
        <p>
            </p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"&gt;
&lt;/web-app&gt;</pre><p>
        </p>
        <p>
            另外，如果您想调整或打开/关闭 RESTEasy 的任何特定功能，web.xml 可以提供 init-params 和 context-params 配置选项 (参见 <a class="xref" href="Installation_Configuration.html#configuration_switches" title="3.5. 配置开关">第 3.5 节 “配置开关”</a> )。
        </p>
        <p>
            因为我们没有使用 &lt;servlet-mapping&gt; 元素，所以我们必须定义一个 <code class="classname">javax.ws.rs.core.Application</code> 类(见 <a class="xref" href="Installation_Configuration.html#javax.ws.rs.core.Application" title="3.6. javax.ws.rs.core.Application">第 3.6 节 “javax.ws.rs.core.Application”</a> ) 并带有 <code class="classname">javax.ws.rs.ApplicationPath</code> 注解。如果扫描返回类或单例是空集(这是从 <code class="classname">Application</code> 继承而来的行为) ，那么将根据 JAX-RS 注解的存在情况，对 WAR 进行资源和提供程序类的扫描。
        </p>
        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
import javax.ws.rs.ApplicationPath;
import javax.ws.rs.core.Application;

@ApplicationPath("/root-path")
public class MyApplication extends Application
{
}       </pre>

        <p>
            <span class="bold"><strong>Note.</strong></span> 实际上，如果应用的 jar 包包含一个带有 <code class="classname">ApplicationPath</code> 注解的 <code class="classname">Application</code> 类(或其子类) ，则根本不需要 web.xml 文件。当然，即使在这种情况下，它也可以用于指定其他信息，如上下文参数。如果有一个 <code class="classname">Application</code> 类，但是它没有 <code class="classname">@ApplicationPath</code> 注解，那么需要一个 web.xml 文件，其中至少有一个 &lt;servlet-mapping&gt; 元素。
        </p>

        <p>
            <span class="bold"><strong>Note.</strong></span> 正如在 <a class="xref" href="Installation_Configuration.html#other_resteasy_modules" title="3.1.1. 其他 RESTEasy 模块">第 3.1.1 节 “其他 RESTEasy 模块”</a> 中所提到的，并非所有 RESTEasy 模块都与 WildFly 捆绑在一起。例如，resteasy-fastinfoset-provider 和 resteasy-wadl 没有包含在 <a class="xref" href="Installation_Configuration.html#resteasy_modules_in_wildfly" title="3.1.  WildFly 中的 RESTEasy 模块">第 3.1 节 “ WildFly 中的 RESTEasy 模块”</a> 中列出的模块中。如果希望在应用程序中使用它们，可以将它们包含在 WAR 中，就像在 WildFly 之外部署它们一样。有关更多信息，请参见 <a class="xref" href="Installation_Configuration.html#standalone_resteasy" title="3.3. 部署到其他 servlet 容器">第 3.3 节 “部署到其他 servlet 容器”</a>。
        </p>

</div>
    <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="standalone_resteasy"/>3.3. 部署到其他 servlet 容器</h2></div></div></div>
        
        <p>
            如果你在使用 WildFly 之外的独立 servlet 容器(如 Tomcat 或 Jetty )中使用 RESTEasy，则需要在 WAR 文件中包含适当的 RESTEasy 的jar包。您将需要 resteasy-jaxrs 模块中的核心类，并且可能需要 resteasy-jaxb-provider 模块之类的附加设施。我们强烈建议您使用 Maven 来构建您的 WAR 文件，因为 RESTEasy 被分成了一系列不同的模块:
        </p>
        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;dependency&gt;
    &lt;groupId&gt;org.jboss.resteasy&lt;/groupId&gt;
    &lt;artifactId&gt;resteasy-core&lt;/artifactId&gt;
    &lt;version&gt;4.7.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.jboss.resteasy&lt;/groupId&gt;
    &lt;artifactId&gt;resteasy-jaxb-provider&lt;/artifactId&gt;
    &lt;version&gt;4.7.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;
</pre>
        <p>
            你可以在  <a class="ulink" href="https://github.com/resteasy/resteasy-examples">https://github.com/resteasy/resteasy-examples</a> 中看到 Maven 项目的示例。
        </p>
        <p>
            如果您没有使用 Maven 构建项目，您可以手动引入所需的jar包。如果您下载 RESTEasy (例如从 <a class="ulink" href="http://resteasy.jboss.org/downloads.html">http://resteasy.jboss.org/downloads.html</a> 下载) ，您将得到一个类似 resteasy-jaxrs-&lt;version&gt;-all.zip 的文件。如果将其解压缩，您将看到一个 lib/ 目录，其中包含 RESTEasy 所需的库。根据需要将这些文件复制到 /WEB-INF/lib 目录中。将您的 JAX-RS 注解类资源和提供程序放在/WEB-INF/lib 中的一个或多个 jar 中，或放在 /WEB-INF/classes 中的原始类文件中。
        </p>

        <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d4e155"/>3.3.1. Servlet 3.0 容器</h3></div></div></div>
        
        <p>
            RESTEasy 提供了 Servlet 3.0 <code class="literal">ServletContainerInitializer</code> 集成接口的实现，以便容器在初始化应用程序时使用。容器在应用程序的启动阶段调用这个接口。RESTEasy 实现执行对资源和提供者的自动扫描，以及 servlet 编程方式的注册。
            
            RESTEasy 的实现是在 maven 依赖 <code class="literal">resteasy-servlet-initializer</code> 中提供的。将这个依赖项添加到项目的 pom.xml 文件中，这样 JAR 文件就会包含在 WAR 文件中。
        </p>
        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;dependency&gt;
    &lt;groupId&gt;org.jboss.resteasy&lt;/groupId&gt;
    &lt;artifactId&gt;resteasy-servlet-initializer&lt;/artifactId&gt;
    &lt;version&gt;4.7.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;
</pre>
        </div>

        <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d4e161"/>3.3.2. 老的 servlet 容器</h3></div></div></div>
        
        <p>
            <code class="literal">resteasy-servlet-initializer</code> 组件不会在3.0以下的 Servlet 版本中工作。然后，您必须在 WAR 项目的 WEB-INF/web.xml 文件中手动声明 RESTEasy servlet，并且必须使用 <code class="classname">Application</code> 类(参见 <a class="xref" href="Installation_Configuration.html#javax.ws.rs.core.Application" title="3.6. javax.ws.rs.core.Application">第 3.6 节 “javax.ws.rs.core.Application”</a>) 显式列出资源和提供程序。例如:
        </p>
        <p>
            </p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;web-app&gt;
    &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;

    &lt;servlet&gt;
        &lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;
        &lt;servlet-class&gt;
            org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher
        &lt;/servlet-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;javax.ws.rs.Application&lt;/param-name&gt;
            &lt;param-value&gt;com.restfully.shop.services.ShoppingApplication&lt;/param-value&gt;
        &lt;/init-param&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;

&lt;/web-app&gt;</pre><p>
        </p>
        <p>
            RESTEasy servlet 负责初始化 RESTEasy 的一些基本组件。
        </p>
        <p>
            <span class="bold"><strong>Note.</strong></span> 
            对3.0之前的 Servlet 规范的支持可能会被弃用，并最终被淘汰。
        </p>
        </div>
    </div>
   <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="microprofile_config"/>3.4. 配置</h2></div></div></div>
        
        
        <p>
        RESTEasy 有两种相互排斥的检索配置参数的机制(参见<a class="xref" href="Installation_Configuration.html#configuration_switches" title="3.5. 配置开关">第 3.5 节 “配置开关”</a>)。传统的机制依赖于 web.xml 文件中的 context-params 和 init-params 配置。或者，Eclipse MicroProfile Config 项目(<a class="ulink" href="https://github.com/eclipse/microprofile-config">https://github.com/eclipse/microprofile-config</a>)提供了一种灵活的参数检索机制，如果必要的依赖项可用，RESTEasy 将使用这种机制。请参见<a class="xref" href="Installation_Configuration.html#configuring_mp_config" title="3.4.4. 配置 MicroProfile Config">第 3.4.4 节 “配置 MicroProfile Config”</a> 以获得更多信息。如果它们不可用，就会退回到传统机制的扩展形式。
        </p>
        
        <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="resteasy_microprofile_config"/>3.4.1. RESTEasy with MicroProfile Config</h3></div></div></div>
        
        <p>
            在有 Eclipse MicroProfile Config API 的 jar 包和 API (见 <a class="xref" href="Installation_Configuration.html#configuring_mp_config" title="3.4.4. 配置 MicroProfile Config">第 3.4.4 节 “配置 MicroProfile Config”</a>)相关实现的情况下 ，RESTEasy 将使用 MicroProfile Config 的工具访问配置属性(见 <a class="xref" href="Installation_Configuration.html#configuration_switches" title="3.5. 配置开关">第 3.5 节 “配置开关”</a>)。MicroProfile Config 为 RESTEasy 用户和 RESTEasy 开发人员提供了很大的灵活性来控制运行时配置。
        </p>
        
        <p>
            在 MicroProfile Config 中，<code class="classname">ConfigSource</code> 是一个<code class="classname">Map&lt;String, String&gt;</code> 表示属性名称到值的映射，<code class="classname">Config</code> 表示按优先级排序的 <code class="classname">ConfigSource</code> 序列。<code class="classname">ConfigSource</code> 的优先级由ordinal变量(用 <code class="classname">int</code> 表示)给出，较高的数值表示较高的优先级。对于给定的属性名，将按顺序搜索 <code class="classname">ConfigSource</code>，直到找到值为止。
        </p>
        <p>
            MicroProfile Config 指定了以下的 <code class="classname">ConfigSource</code>:
        </p>
        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="orderedlist"><ol><li>一个 <code class="classname">ConfigSource</code> 来自于 System.getProperties() (ordinal = 400)</li><li>一个 <code class="classname">ConfigSource</code> 来自于 System.getenv() (ordinal = 300)</li><li>一个 <code class="classname">ConfigSource</code> 来自ClassPath中的每个 META-INF/microprofile-config.properties 文件,可以通过每个文件中的 config_ordinal 属性单独配置优先级。(默认的 ordinal = 100)
            </li></ol></div>
        <p>
            注意，由于 <code class="classname">ConfigSource</code> 的相对优先级，在 System properties 中找到的属性以及在 System environment 中找到的属性将被赋予 System properties 值。
        </p>
        <p>
            <code class="classname">ConfigSources</code> 的set集合是可扩展的。例如，目前 RESTEasy 使用的 MicroProfile Config 规范的实现 smallrye-Config (<a class="ulink" href="https://github.com/smallrye/smallrye-config">https://github.com/smallrye/smallrye-config</a>) ，添加了以下几种 <code class="classname">ConfigSource</code>:
        </p>
        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="orderedlist"><ol><li>
            <code class="classname">PropertiesConfigSource</code> 创建一个 <code class="classname">ConfigSource</code> 来自
            Java <code class="classname">Properties</code> 对象或者一个 Map&lt;String, String&gt; 对象或者一个 properties 文件
            (由其 URL 引用) (默认 ordinal = 100)。
            
            </li><li>
            <code class="classname">DirConfigSource</code> 创建一个<code class="classname">ConfigSource</code>，它将查看一个目录，每个文件对应一个属性（文件名是属性键，其文本内容是属性值）。 该<code class="classname">ConfigSource</code> 可用于从Kubernetes ConfigMap读取配置（默认 ordinal = 100 ）。
            </li><li><code class="classname">ZkMicroProfileConfig</code> 创建一个 <code class="classname">ConfigSource</code>，该<code class="classname">ConfigSource</code>通过 Apache Zookeeper 备份
            (ordinal = 150).</li></ol></div>
        <p>
            这些可以通过使用 <code class="classname">ConfigProviderResolver</code> 实例以编程方式注册:
        </p>
        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
Config config = new PropertiesConfigSource("file:/// ...");
ConfigProviderResolver.instance().registerConfig(config, getClass().getClassLoader());
        </pre>
        <p> 其中 <code class="classname">ConfigProviderResolver</code> 是 Eclipse API 的一部分。 
        </p>
        <p>
            如果应用程序在 WildFly 运行，那么 WildFly 提供了另一组 <code class="classname">ConfigSource</code> ，正如 WildFly 管理指南(<a class="ulink" href="https://docs.wildfly.org/21/Admin_Guide.html#MicroProfile_Config_SmallRye">https://docs.wildfly.org/21/Admin_Guide.html#MicroProfile_Config_SmallRye</a> )的"MicroProfile Config Subsystem Configuration" 部分所描述的那样。
        </p>
        <p>
            最后，RESTEasy 自动提供了三个<code class="classname">ConfigSource</code>:
        </p>
        <div class="itemizedlist"><ul><li><code class="classname">org.jboss.resteasy.microprofile.config.ServletConfigSource</code> 表示 servlet 在 web.xml 中的 &lt;init-param&gt;s 配置  (ordinal = 60)。</li><li><code class="classname">org.jboss.resteasy.microprofile.config.FilterConfigSource</code> 表示 servlet 在 web.xml 中的 &lt;init-param&gt;s 配置 (ordinal = 50)。 (见 <a class="xref" href="Installation_Configuration.html#filter" title="3.8. RESTEasy 作为 Servlet Filter">第 3.8 节 “RESTEasy 作为 Servlet Filter”</a> for more information.)
            </li><li><code class="classname">org.jboss.resteasy.microprofile.config.ServletContextConfigSource</code> 表示 web.xml 中的 
            &lt;context-param&gt;s 配置 (ordinal = 40)。 </li></ul></div>
        <p>
            <span class="bold"><strong>Note. </strong></span>
            正如 MicroProfile Config 规范所述，可以在任何 RESTEasy 内置 <code class="classname">ConfigSource</code> 中设置一个特殊属性 <code class="classname">config_ordinal</code> 。getOrdinal() 的默认实现将尝试读取此值。如果找到并且是一个有效的整数，则将使用该值。否则将使用相应的默认值。
        </p>
        </div>

        <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d4e241"/>3.4.2. 完全使用 MicroProfile Config</h3></div></div></div>
            
            
            <p>
                MicroProfile Config API 非常简单，可以通过编程方式获得<code class="classname">Config</code>:
            </p>
            
            <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
Config config = ConfigProvider.getConfig();
            </pre>
            
            <p>
                或在有CDI 的情况下，以注入方式:
            </p>
            
            <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
@Inject Config config;
            </pre>
            
            <p>
                一旦获取了 <code class="classname">Config</code>，就可以查询属性，举个例子：
            </p>
            
            <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
String s = config.getValue("prop_name", String.class);
            </pre>
            
            <p>
                或者
            </p>
            
            <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
String s = config.getOptionalValue("prop_name", String.class).orElse("d'oh");
            </pre>
            
            <p>
                现在，考虑一下这样一种情况: 通过 <code class="code">System.setProperty("prop_name", "system")</code> 设置了"prop_name"，同时有以下配置：
            </p>
            
            <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
   &lt;context-param&gt;
      &lt;param-name&gt;prop_name&lt;/param-name&gt;
      &lt;param-value&gt;context&lt;/param-value&gt;
   &lt;/context-param&gt;
            </pre>
               
            <p>
                然后，由于系统参数 <code class="classname">ConfigSource</code> 的优先级高于(有一个更高的ordinal)  <code class="classname">ServletContextConfigSource</code> ，<code class="code">config.getValue("prop_name", String.class)</code> 将返回"system"而不是"context"。
            </p>

        </div>
        <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d4e260"/>3.4.3. 使用 RESTEasy 的 MicroProfile Config扩展</h3></div></div></div>
            
            
            <p>
            RESTEasy 提供了一个通用的参数检索机制，如果有必要的依赖关系可用，它就会包含 MicroProfile Config，否则就会回到经典 RESTEasy 机制的扩展版本(见 <a class="xref" href="Installation_Configuration.html#classic_config" title="3.4.5. RESTEasy 的经典配置机制">第 3.4.5 节 “RESTEasy 的经典配置机制 ”</a>)。
            </p>
            
            <p>调用</p>
            
            <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
ConfigurationFactory.getInstance().getConfiguration()
            </pre>
            
            <p>
            将返回一个 org.jboss.resteasy.spi.config.Configuration 的实例:
            </p>
            
            <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
public interface Configuration {

    /**
     * Returns the resolved value for the specified type of the named property.
     *
     * @param name the name of the parameter
     * @param type the type to convert the value to
     * @param &lt;T&gt;  the property type
     *
     * @return the resolved optional value
     *
     * @throws IllegalArgumentException if the type is not supported
     */
    &lt;T&gt; Optional&lt;T&gt; getOptionalValue(String name, Class&lt;T&gt; type);

    /**
     * Returns the resolved value for the specified type of the named property.
     *
     * @param name the name of the parameter
     * @param type the type to convert the value to
     * @param &lt;T&gt;  the property type
     *
     * @return the resolved value
     *
     * @throws IllegalArgumentException         if the type is not supported
     * @throws java.util.NoSuchElementException if there is no property associated with the name
     */
    &lt;T&gt; T getValue(String name, Class&lt;T&gt; type);
}
            </pre>
            
        <p>
        举个例子：
        </p>
        
        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
String value = ConfigurationFactory.getInstance().getConfiguration().getOptionalValue("prop_name", String.class).orElse("d'oh");
        </pre>
        
        <p>
        如果 MicroProfile Config 是可用的，那么它等价于
        </p>
        
        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
String value = ConfigProvider.getConfig().getOptionalValue("prop_name", String.class).orElse("d'oh");
        </pre>
        
        <p>
        如果 MicroProfile Config 不可用，则尝试从以下源检索该参数:
        </p>
        
        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="orderedlist"><ol><li>系统变量，然后是</li><li>环境变量，然后是</li><li>通过 web.xml 文件配置, 如 <a class="xref" href="Installation_Configuration.html#classic_config" title="3.4.5. RESTEasy 的经典配置机制">第 3.4.5 节 “RESTEasy 的经典配置机制 ”</a> 中所述</li></ol></div>
        </div>
                
        <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="configuring_mp_config"/>3.4.4. 配置 MicroProfile Config</h3></div></div></div>
            
            
            <p>
                如果一个应用程序在 Wildfly 内部运行，那么所有的依赖关系都是自动可用的。在 Wildfly 之外，应用程序在编译时需要 Eclipse MicroProfile API。例如，在 maven 中，使用
            </p>
            
            <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
        &lt;dependency&gt;
            &lt;groupId&gt;org.eclipse.microprofile.config&lt;/groupId&gt;
            &lt;artifactId&gt;microprofile-config-api&lt;/artifactId&gt;
            &lt;scope&gt;compile&lt;/scope&gt;
        &lt;/dependency&gt;
            </pre>
            
            <p>
                它还在运行时需要MicroProfile API的实现、smallrye-config：
            </p>
            
            <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
        &lt;dependency&gt;
            &lt;groupId&gt;io.smallrye&lt;/groupId&gt;
            &lt;artifactId&gt;smallrye-config&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;
            </pre>
        </div>
       
    <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="classic_config"/>3.4.5. RESTEasy 的经典配置机制 </h3></div></div></div>
    
    
    <p>
    在加入 MicroProfile Config 之前，几乎所有 RESTEasy 的参数都是从 servlet init-params 和 context-params 中检索到的。哪些是可用的取决于 web 应用程序如何调用 RESTEasy。
    </p>
    
    <p>
    如果 RESTEasy 被作为 servlet 调用，如
    </p>
    
<pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"&gt;

   &lt;context-param&gt;
      &lt;param-name&gt;system&lt;/param-name&gt;
      &lt;param-value&gt;system-context&lt;/param-value&gt;
   &lt;/context-param&gt;
   
   &lt;servlet&gt;
      &lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;
      &lt;servlet-class&gt;org.jboss.resteasy.plugins.server.servlet.HttpServlet30Dispatcher&lt;/servlet-class&gt;

      &lt;init-param&gt;
         &lt;param-name&gt;system&lt;/param-name&gt;
         &lt;param-value&gt;system-init&lt;/param-value&gt;
      &lt;/init-param&gt;
      
   &lt;/servlet&gt;

   &lt;servlet-mapping&gt;
      &lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;
      &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
   &lt;/servlet-mapping&gt;
&lt;/web-app&gt;
</pre>

   <p>
   然后可以使用 servlet 特定的 init-params 和一般的 context-params，前者优先于后者。例如，属性"system"的值为"system-init"。
   </p>

   <p>
   如果通过过滤器调用 RESTEasy (参见 <a class="xref" href="Installation_Configuration.html#filter" title="3.8. RESTEasy 作为 Servlet Filter">第 3.8 节 “RESTEasy 作为 Servlet Filter”</a>) ，如下所示
   </p>
   
   <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"&gt;

   &lt;context-param&gt;
      &lt;param-name&gt;system&lt;/param-name&gt;
      &lt;param-value&gt;system-context&lt;/param-value&gt;
   &lt;/context-param&gt;

   &lt;filter&gt;
      &lt;filter-name&gt;Resteasy&lt;/filter-name&gt;
      &lt;filter-class&gt;org.jboss.resteasy.plugins.server.servlet.FilterDispatcher&lt;/filter-class&gt;

      &lt;init-param&gt;
         &lt;param-name&gt;system&lt;/param-name&gt;
         &lt;param-value&gt;system-filter&lt;/param-value&gt;
      &lt;/init-param&gt;

    &lt;/filter&gt;

    &lt;filter-mapping&gt;
        &lt;filter-name&gt;Resteasy&lt;/filter-name&gt;
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/filter-mapping&gt;

&lt;/web-app&gt;
   </pre>

   <p>
   然后可以使用筛选器特定的 init-params 和一般的 context-params，前者优先于后者。例如，属性"system"的值为"system-filter"。
   </p>

   <p>
   最后，如果 RESTEasy 是通过 ServletContextListener 调用的(参见 <a class="xref" href="Installation_Configuration.html#listener" title="3.7. RESTEasy 作为 ServletContextListener">第 3.7 节 “RESTEasy 作为 ServletContextListener”</a>) ，如下所示
   </p>

<pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"&gt;

   &lt;listener&gt;
      &lt;listener-class&gt;
         org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap
      &lt;/listener-class&gt;
   &lt;/listener&gt;

   &lt;context-param&gt;
      &lt;param-name&gt;system&lt;/param-name&gt;
      &lt;param-value&gt;system-context&lt;/param-value&gt;
   &lt;/context-param&gt;
&lt;/web-app&gt;
</pre>
 
    <p>
    其中 <code class="classname">ResteasyBootstrap</code> 是一个 <code class="classname">ServletContextListener</code>，那么 context-params 是可用的。
    </p>
    </div>
   
    <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="overriding_config"/>3.4.6. 覆盖 RESTEasy 的配置机制</h3></div></div></div>
    
    
    <p>
    在采用默认行为之前，无论是否使用 MicroProfile Config (如前面几节所述) ，RESTEasy 将使用服务加载来查找接口 <code class="classname">org.jboss.resteasy.spi.config.ConfigurationFactory</code> 的一个或多个实现。选择由 <code class="methodname">ConfigurationFactory.priority()</code> 返回的值确定的优先级最高的一个。较小的数字意味着更高的优先级。默认的 <code class="classname">ConfigurationFactory</code> 是 <code class="classname">org.jboss.resteasy.core.config.DefaultConfigurationFactory</code> 其优先级为500。
    </p>
    </div>
    </div>
     
    <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="configuration_switches"/>3.5. 配置开关</h2></div></div></div>
        
        <p>
        运行时可以从可用的任何 <code class="classname">ConfigSource</code> 接收以下配置选项:
        </p>
        <p>
            </p><div class="table"><a id="d4e312"/><p class="title"><b>表 3.2. </b></p><div class="table-contents">
                <table border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th>
                                配置选项
                            </th><th>
                                默认值
                            </th><th>
                                描述
                            </th></tr></thead><tbody><tr><td>
                                resteasy.servlet.mapping.prefix
                            </td><td>
                                no default
                            </td><td>
                                If the url-pattern for the RESTEasy servlet-mapping is not /*
                            </td></tr><tr><td>
                                resteasy.providers
                            </td><td>
                                no default
                            </td><td>
                                A comma delimited list of fully qualified @Provider class names you want to register
                            </td></tr><tr><td>
                                resteasy.use.builtin.providers
                            </td><td>
                                true
                            </td><td>
                                Whether or not to register default, built-in @Provider classes
                            </td></tr><tr><td>
                                resteasy.resources
                            </td><td>
                                no default
                            </td><td>
                                A comma delimited list of fully qualified JAX-RS resource class names you want to
                                register
                            </td></tr><tr><td>
                                resteasy.jndi.resources
                            </td><td>
                                no default
                            </td><td>
                                A comma delimited list of JNDI names which reference objects you want to register as
                                JAX-RS resources
                            </td></tr><tr><td>
                                javax.ws.rs.Application
                            </td><td>
                                no default
                            </td><td>
                                Fully qualified name of Application class to bootstrap in a spec portable way
                            </td></tr><tr><td>
                                resteasy.media.type.mappings
                            </td><td>
                                no default
                            </td><td>
                                Replaces the need for an Accept header by mapping file name extensions (like .xml or
                                .txt) to a media type. Used when the client
                                is unable to use an Accept header to choose a representation (i.e. a browser). See
                                <a class="xref" href="JAX-RS_Content_Negotiation.html" title="第 20 章 JAX-RS Content Negotiation">第 20 章 <i>JAX-RS Content Negotiation</i></a> for more details.
                            </td></tr><tr><td>
                                resteasy.language.mappings
                            </td><td>
                                no default
                            </td><td>
                                Replaces the need for an Accept-Language header by mapping file name extensions (like
                                .en or .fr) to a language. Used when the client
                                is unable to use an Accept-Language header to choose a language (i.e. a browser). See
                                <a class="xref" href="JAX-RS_Content_Negotiation.html" title="第 20 章 JAX-RS Content Negotiation">第 20 章 <i>JAX-RS Content Negotiation</i></a> for more details.
                            </td></tr><tr><td>
                                resteasy.media.type.param.mapping
                            </td><td>
                                no default
                            </td><td>
                                Names a query parameter that can be set to an acceptable media type,
                                enabling content negotiation without an Accept header. See
                                <a class="xref" href="JAX-RS_Content_Negotiation.html" title="第 20 章 JAX-RS Content Negotiation">第 20 章 <i>JAX-RS Content Negotiation</i></a> for more details.
                            </td></tr><tr><td>
                                resteasy.role.based.security
                            </td><td>
                                false
                            </td><td>
                                Enables role based security. See <a class="xref" href="Securing_JAX-RS_and_RESTeasy.html" title="第 43 章 Securing JAX-RS and RESTEasy">第 43 章 <i>Securing JAX-RS and RESTEasy</i></a>
                                for more details.
                            </td></tr><tr><td>
                                resteasy.document.expand.entity.references
                            </td><td>
                                false
                            </td><td>
                                Expand external entities in org.w3c.dom.Document documents
                                and JAXB object representations
                            </td></tr><tr><td>
                                resteasy.document.secure.processing.feature
                            </td><td>
                                true
                            </td><td>
                                Impose security constraints in processing org.w3c.dom.Document documents
                                and JAXB object representations
                            </td></tr><tr><td>
                                resteasy.document.secure.disableDTDs
                            </td><td>
                                true
                            </td><td>
                                Prohibit DTDs in org.w3c.dom.Document documents
                                and JAXB object representations
                            </td></tr><tr><td>
                                resteasy.wider.request.matching
                            </td><td>
                                false
                            </td><td>
                                Turns off the JAX-RS spec defined class-level expression filtering and instead
                                tries to match version every method's full path.
                            </td></tr><tr><td>
                                resteasy.use.container.form.params
                            </td><td>
                                false
                            </td><td>
                                Obtain form parameters by using HttpServletRequest.getParameterMap().
                                Use this switch if you are calling this method within a servlet filter or eating
                                the input stream within the filter.
                            </td></tr><tr><td>
                                resteasy.rfc7232preconditions
                            </td><td>
                                false
                            </td><td>
                                Enables <a class="link" href="Cache_NoCache_CacheControl.html#Http_Precondition" title="35.4. HTTP preconditions">RFC7232 compliant HTTP preconditions handling</a>.
                            </td></tr><tr><td>
                                resteasy.gzip.max.input
                            </td><td>
                                10000000
                            </td><td>
                                Imposes maximum size on decompressed gzipped .
                            </td></tr><tr><td>
                                resteasy.secure.random.max.use
                            </td><td>
                                100
                            </td><td>
                                The number of times a SecureRandom can be used before reseeding.
                            </td></tr><tr><td>
                                resteasy.buffer.exception.entity
                            </td><td>
                                true
                            </td><td>
                                Upon receiving an exception, the client side buffers any response
                                entity before closing the connection.
                            </td></tr><tr><td>
                                resteasy.add.charset
                            </td><td>
                                true
                            </td><td>
                                If a resource method returns a text/* or application/xml* media type without
                                an explicit charset, RESTEasy will add "charset=UTF-8" to the returned
                                Content-Type header. Note that the charset defaults to UTF-8 in this case,
                                independent of the setting of this parameter.
                            </td></tr><tr><td>
                                resteasy.disable.html.sanitizer
                            </td><td>
                                false
                            </td><td>
                                Normally, a response with media type "text/html" and a status of 400 will be processed
                                so that the characters "/", "&lt;", "&gt;", "&amp;", """ (double quote), and "'" (single quote)
                                are escaped to prevent an XSS attack. If this parameter is set to "true", escaping
                                will not occur.
                            </td></tr><tr><td>
                                resteasy.patchfilter.disabled
                            </td><td>
                                false
                            </td><td>
                                Turns off the default patch filter to handle JSON patch and JSON Merge Patch request. 
                                A customerized patch method filter can be provided to serve the JSON patch and JSON merge
                                patch request instead.
                            </td></tr><tr><td>
                                resteasy.original.webapplicationexception.behavior
                            </td><td>
                                false
                            </td><td>
                                When set to "true", this parameter will restore the original behavior in which
                                a Client running in a resource method will throw a JAX-RS WebApplicationException
                                instead of a Resteasy version with a sanitized <code class="classname">Response</code>. For more information,
                                see section <a class="link" href="ExceptionHandling.html#ResteasyWebApplicationException" title="30.3. Resteasy WebApplicationExceptions">Resteasy WebApplicationExceptions</a>
                            </td></tr></tbody></table>
            </div></div><p><br class="table-break"/>
        </p>
        <p>
            <span class="bold"><strong>Note. </strong></span>
            如果你的 RESTEasy servlet 设置的 servlet-mapping 有一个除 /* 外的 url-pattern，你必须设置 resteasy.servlet.mapping.prefix &lt;context param&gt; 变量。如下：
        </p>
        <p>
            </p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;servlet-mapping&gt;
&lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;
&lt;url-pattern&gt;/restful-services/*&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;</pre><p>
        </p>
        <p>
            那么 resteasy.servlet.mapping.prefix 的值必须是:
        </p>
        <p>
            </p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;context-param&gt;
&lt;param-name&gt;resteasy.servlet.mapping.prefix&lt;/param-name&gt;
&lt;param-value&gt;/restful-services&lt;/param-value&gt;
&lt;/context-param&gt;</pre><p>
        </p>
    </div>
    <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="javax.ws.rs.core.Application"/>3.6. javax.ws.rs.core.Application</h2></div></div></div>
        

        <p>
            <code class="classname">javax.ws.rs.core.Application</code> 类是一个标准的 JAX-RS 类，您可以用它来提供有关部署的信息。它只是一个列出所有 JAX-RS 根资源和提供程序的类。
        </p>
        <p>

            </p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
/**
* Defines the components of a JAX-RS application and supplies additional
* metadata. A JAX-RS application or implementation supplies a concrete
* subclass of this abstract class.
*/
public abstract class Application
{
    private static final Set&lt;Object&gt; emptySet = Collections.emptySet();

    /**
    * Get a set of root resource and provider classes. The default lifecycle
    * for resource class instances is per-request. The default lifecycle for
    * providers is singleton.
    * &lt;p/&gt;
    * &lt;p&gt;Implementations should warn about and ignore classes that do not
    * conform to the requirements of root resource or provider classes.
    * Implementations should warn about and ignore classes for which
    * {@link #getSingletons()} returns an instance. Implementations MUST
    * NOT modify the returned set.&lt;/p&gt;
    *
    * @return a set of root resource and provider classes. Returning null
    * is equivalent to returning an empty set.
    */
    public abstract Set&lt;Class&lt;?&gt;&gt; getClasses();

    /**
    * Get a set of root resource and provider instances. Fields and properties
    * of returned instances are injected with their declared dependencies
    * (see {@link Context}) by the runtime prior to use.
    * &lt;p/&gt;
    * &lt;p&gt;Implementations should warn about and ignore classes that do not
    * conform to the requirements of root resource or provider classes.
    * Implementations should flag an error if the returned set includes
    * more than one instance of the same class. Implementations MUST
    * NOT modify the returned set.&lt;/p&gt;
    * &lt;p/&gt;
    * &lt;p&gt;The default implementation returns an empty set.&lt;/p&gt;
    *
    * @return a set of root resource and provider instances. Returning null
    * is equivalent to returning an empty set.
    */
    public Set&lt;Object&gt; getSingletons()
    {
        return emptySet;
    }

}            </pre><p>
        </p>
        <p>


        </p>

        <p>

        </p>
        <p>
            <span class="bold"><strong>Note. </strong></span>
            如果 web.xml 文件没有 &lt;servlet-mapping&gt; 元素，则必须使用带有<code class="classname">@ApplicationPath</code> 注解的 <code class="classname">Application</code> 类。
        </p>
    </div>

    <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="listener"/>3.7. RESTEasy 作为 ServletContextListener</h2></div></div></div>
        

        <p>
            如果您使用的是 Servlet 3.0 或更高版本的容器，那么这一部分几乎是不推荐的。如果是，并且阅读了上面关于在 Servlet 3.0 中安装的配置部分，那请跳过这一小节。RESTEasy 的初始化可以在 ServletContextListener 中执行，而不是在 Servlet 中执行。如果您正在编写需要在启动时与 RESTEasy 进行交互的自定义 Listeners，那么您可能需要这个。这方面的一个例子是 RESTEasy 与 Spring 框架的集成，org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap 类是一个 ServletContextListener，它配置 ResteasyProviderFactory 和 Registry 的实例。可以从 ServletContext 属性 org.jboss.resteasy.spi.ResteasyProviderFactory 和 org.jboss.resteasy.spi.Registry 获取 ResteasyProviderFactory 和 Registry 的实例。从这些实例中，您可以通过编程方式与 RESTEasy 注册接口交互。
        </p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;web-app&gt;
   &lt;listener&gt;
      &lt;listener-class&gt;
         org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap
      &lt;/listener-class&gt;
   &lt;/listener&gt;

  &lt;!-- ** INSERT YOUR LISTENERS HERE!!!! --&gt;

   &lt;servlet&gt;
      &lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;
      &lt;servlet-class&gt;
         org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher
      &lt;/servlet-class&gt;
   &lt;/servlet&gt;

   &lt;servlet-mapping&gt;
      &lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;
      &lt;url-pattern&gt;/Resteasy/*&lt;/url-pattern&gt;
   &lt;/servlet-mapping&gt;

&lt;/web-app&gt;</pre>
    </div>
    <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="filter"/>3.8. RESTEasy 作为 Servlet Filter</h2></div></div></div>
        

        <p>
            如果您使用的是 Servlet 3.0 或更高版本的容器，那么这一部分几乎是不推荐的。如果是，并且阅读了上面关于在 Servlet 3.0 中安装的配置部分，那请跳过这一小节。作为一个 Servlet 运行 RESTEasy 的缺点是，您不能在JAX-RS 服务相同路径下放置静态资源如 .html 和 .jpeg 文件。RESTEasy 允许您以 Filter 的形式运行。如果在请求的 URL 下面没有找到 JAX-RS 资源，RESTEasy 将委托回 servlet 容器以解析 URL。
        </p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;web-app&gt;
    &lt;filter&gt;
        &lt;filter-name&gt;Resteasy&lt;/filter-name&gt;
        &lt;filter-class&gt;
            org.jboss.resteasy.plugins.server.servlet.FilterDispatcher
        &lt;/filter-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;javax.ws.rs.Application&lt;/param-name&gt;
            &lt;param-value&gt;com.restfully.shop.services.ShoppingApplication&lt;/param-value&gt;
        &lt;/init-param&gt;
    &lt;/filter&gt;

    &lt;filter-mapping&gt;
        &lt;filter-name&gt;Resteasy&lt;/filter-name&gt;
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/filter-mapping&gt;

&lt;/web-app&gt;</pre>
    </div>

    <div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d4e446"/>3.9. 客户端</h2></div></div></div>
    

    <p>
        基于 JAX-RS 2.0 的 RESTEasy 等实现支持客户端框架，简化了与 restful 应用程序的通信。在 RESTEasy 中，客户机框架所需的最小模块集由 resteasy-core 和 resteasy-client 组成。你可以通过 maven 访问它们:
    </p>

<pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;dependency&gt;
    &lt;groupId&gt;org.jboss.resteasy&lt;/groupId&gt;
    &lt;artifactId&gt;resteasy-core&lt;/artifactId&gt;
    &lt;version&gt;4.7.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.jboss.resteasy&lt;/groupId&gt;
    &lt;artifactId&gt;resteasy-client&lt;/artifactId&gt;
    &lt;version&gt;4.7.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;
</pre>

    <p>
        其他模块，如 resteasy-jaxb-provider ，可以根据需要引入。
    </p>

    </div>
</div><ul xmlns:d="http://docbook.org/ns/docbook" class="docnav"><li class="previous"><a accesskey="p" href="license.html"><strong>上一页</strong>第 2 章 开源许可</a></li><li class="up"><a accesskey="u" href="#"><strong>上一级</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>起始页</strong></a></li><li class="next"><a accesskey="n" href="Using_Path.html"><strong>下一页</strong>第 4 章 使用 @Path 和 @GET, @POST 等注解</a></li></ul></body></html>